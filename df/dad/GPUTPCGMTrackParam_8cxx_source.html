<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/runner/work/AliceO2/AliceO2/GPU/GPUTracking/Merger/GPUTPCGMTrackParam.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('df/dad/GPUTPCGMTrackParam_8cxx_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">GPUTPCGMTrackParam.cxx</div></div>
</div><!--header-->
<div class="contents">
<a href="../../df/dad/GPUTPCGMTrackParam_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright 2019-2020 CERN and copyright holders of ALICE O2.</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// See https://alice-o2.web.cern.ch/copyright for details of the copyright holders.</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// All rights not expressly granted are reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// This software is distributed under the terms of the GNU General Public</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// License v3 (GPL Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">//</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// or submit itself to any jurisdiction.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span> </div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno"><a class="line" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a460261c39338b2def34f29feff2e7ede">   15</a></span><span class="preprocessor">#define GPUCA_CADEBUG 0</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno"><a class="line" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#aaecaa774d0bdc22367f43a2476f5bd9c">   16</a></span><span class="preprocessor">#define DEBUG_SINGLE_TRACK -1</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#include &quot;<a class="code" href="../../da/dab/GPUTPCDef_8h.html">GPUTPCDef.h</a>&quot;</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &quot;<a class="code" href="../../d8/d33/GPUTPCGMTrackParam_8h.html">GPUTPCGMTrackParam.h</a>&quot;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d37/GPUTPCGMPhysicalTrackModel_8h.html">GPUTPCGMPhysicalTrackModel.h</a>&quot;</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span><span class="preprocessor">#include &quot;<a class="code" href="../../d0/dd8/GPUTPCGMPropagator_8h.html">GPUTPCGMPropagator.h</a>&quot;</span></div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;<a class="code" href="../../d8/dd4/GPUTPCGMBorderTrack_8h.html">GPUTPCGMBorderTrack.h</a>&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span><span class="preprocessor">#include &quot;<a class="code" href="../../d8/dfd/GPUTPCGMMergedTrack_8h.html">GPUTPCGMMergedTrack.h</a>&quot;</span></div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="../../d9/d9c/GPUTPCGMPolynomialField_8h.html">GPUTPCGMPolynomialField.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="../../d4/dcf/GPUTPCGMMerger_8h.html">GPUTPCGMMerger.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="../../d6/d25/GPUTPCTracker_8h.html">GPUTPCTracker.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="../../dc/d55/GPUdEdx_8h.html">GPUdEdx.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="../../df/d13/GPUParam_8h.html">GPUParam.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;<a class="code" href="../../d5/d5c/GPUO2DataTypes_8h.html">GPUO2DataTypes.h</a>&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="../../db/df8/GPUConstantMem_8h.html">GPUConstantMem.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span><span class="preprocessor">#include &quot;<a class="code" href="../../d4/db1/TPCFastTransform_8h.html">TPCFastTransform.h</a>&quot;</span></div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="../../de/ddd/CorrectionMapsHelper_8h.html">CorrectionMapsHelper.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/d2e/GPUTPCConvertImpl_8h.html">GPUTPCConvertImpl.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="../../de/d4c/GPUTPCGMMergerTypes_8h.html">GPUTPCGMMergerTypes.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;GPUParam.inc&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="../../de/da7/GPUGetConstexpr_8h.html">GPUGetConstexpr.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span> </div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span><span class="preprocessor">#ifdef GPUCA_CADEBUG_ENABLED</span></div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="preprocessor">#include &quot;<a class="code" href="../../dd/dc6/GPUSettings_8h.html">GPUSettings.h</a>&quot;</span></div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span><span class="preprocessor">#include &quot;<a class="code" href="../../d8/dbb/AliHLTTPCClusterMCData_8h.html">AliHLTTPCClusterMCData.h</a>&quot;</span></div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span> </div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="preprocessor">#ifndef GPUCA_GPUCODE_DEVICE</span></div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span><span class="preprocessor">#include &lt;cmath&gt;</span></div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span><span class="preprocessor">#include &lt;cstdlib&gt;</span></div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d0/db4/namespaceo2_1_1gpu.html">o2::gpu</a>;</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../d0/d0a/namespaceo2_1_1tpc.html">o2::tpc</a>;</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span> </div>
<div class="foldopen" id="foldopen00051" data-start="{" data-end="}">
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno"><a class="line" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a39c987747cadfedb76ca659e4006038f">   51</a></span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() bool <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::Fit(<a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() merger, int32_t iTrk, <a class="code hl_struct" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html">GPUTPCGMMergedTrackHit</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, int32_t&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() N, int32_t&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() NTolerated, <span class="keywordtype">float</span>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() Alpha, int32_t attempt, <span class="keywordtype">float</span> maxSinPhi, <a class="code hl_class" href="../../d2/d6d/classo2_1_1gpu_1_1GPUTPCGMMergedTrack.html">GPUTPCGMMergedTrack</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() track)</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span>{</div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> kDeg2Rad = M_PI / 180.f;</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(<span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> kSectAngle = 2 * M_PI / 18.f);</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span> </div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span>  <span class="keyword">const</span> <a class="code hl_struct" href="../../d3/d65/structo2_1_1gpu_1_1GPUParam.html">GPUParam</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a> = merger-&gt;Param();</div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span> </div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>  <a class="code hl_class" href="../../d1/d72/classo2_1_1gpu_1_1GPUdEdx.html">GPUdEdx</a> dEdx, dEdxAlt;</div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>  <a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a> prop;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>  <a class="code hl_struct" href="../../df/dcd/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors.html">gputpcgmmergertypes::InterpolationErrors</a> interpolation;</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>  prop.SetMaterialTPC();</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  prop.SetPolynomialField(&amp;<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.polynomialField);</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>  prop.SetMaxSinPhi(maxSinPhi);</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span>  <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.mergerInterpolateErrors) {</div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span>    <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; N; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>      interpolation.<a class="code hl_variable" href="../../df/dcd/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors.html#aaf4fca9df601e06dbb0d69c92e85a3da">hit</a>[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>].<a class="code hl_variable" href="../../dc/d37/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrorHit.html#aa8b5d1e383d25788a5822b660b820a68">errorY</a> = -1;</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>    }</div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>  }</div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span> </div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>  <span class="keyword">const</span> int32_t nWays = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.nWays;</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>  <span class="keyword">const</span> int32_t maxN = N;</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>  int32_t ihitStart = 0;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>  <span class="keywordtype">float</span> covYYUpd = 0.f;</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>  <span class="keywordtype">float</span> lastUpdateX = -1.f;</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>  uint8_t lastRow = 255;</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>  uint8_t lastSector = 255;</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>  <span class="keywordtype">float</span> deltaZ = 0.f;</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span> </div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>  <span class="keywordflow">for</span> (int32_t iWay = 0; iWay &lt; nWays; iWay++) {</div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    int32_t nMissed = 0, nMissed2 = 0;</div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="keywordtype">float</span> sumInvSqrtCharge = 0.f;</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>    int32_t nAvgCharge = 0;</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span> </div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>    <span class="keywordflow">if</span> (iWay &amp;&amp; (iWay &amp; 1) == 0) {</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>      StoreOuter(&amp;track.OuterParam(), prop.GetAlpha());</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    }</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    int32_t resetT0 = initResetT0();</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> refit = (nWays == 1 || iWay &gt;= 1);</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> finalOutInFit = iWay + 2 &gt;= nWays;</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> finalFit = iWay == nWays - 1;</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> maxSinForUpdate = CAMath::Sin(70.f * kDeg2Rad);</div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span> </div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>    ResetCovariance();</div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>    prop.SetSeedingErrors(!(refit &amp;&amp; attempt == 0));</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>    prop.SetFitInProjections(<span class="keyword">true</span>); <span class="comment">// param.rec.fitInProjections == -1 ? (iWay == 0) : param.rec.fitInProjections); // TODO: Reenable once fixed</span></div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>    prop.SetPropagateBzOnly(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.fitPropagateBzOnly == -1 ? !finalFit : <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.fitPropagateBzOnly);</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>    prop.SetMatLUT((<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.useMatLUT &amp;&amp; finalFit) ? merger-&gt;GetConstantMem()-&gt;calibObjects.matLUT : <span class="keyword">nullptr</span>);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>    prop.SetTrack(<span class="keyword">this</span>, iWay ? prop.GetAlpha() : Alpha);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>    ConstrainSinPhi(iWay == 0 ? 0.95f : <a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aaae686e3a351f7d112899fe6cc41d5aa">GPUCA_MAX_SIN_PHI_LOW</a>);</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>    <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;Fitting track %d way %d (sector %d, alpha %f) !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!\n&quot;</span>, iTrk, iWay, CAMath::Float2IntRn(prop.GetAlpha() / kSectAngle) + (mP[1] &lt; 0 ? 18 : 0), prop.GetAlpha()));</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span> </div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    N = 0;</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>    lastUpdateX = -1;</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> inFlyDirection = iWay &amp; 1;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>    <span class="keyword">const</span> int32_t wayDirection = (iWay &amp; 1) ? -1 : 1;</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span> </div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span>    int32_t goodRows = 0;</div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span>    <span class="keywordflow">for</span> (int32_t ihit = ihitStart; ihit &gt;= 0 &amp;&amp; ihit &lt; maxN; ihit += wayDirection) {</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> crossCE = lastSector != 255 &amp;&amp; ((lastSector &lt; 18) ^ (<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector &lt; 18));</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>      <span class="keywordflow">if</span> (crossCE) {</div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>        lastSector = <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector;</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>      }</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span> </div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>      <span class="keywordflow">if</span> ((<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackFitRejectMode &gt; 0 &amp;&amp; nMissed &gt;= <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackFitRejectMode) || nMissed2 &gt;= <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackFitMaxRowMissedHard || <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].state &amp; <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067ac615c3e236bd7318730a5311e1b6c7ad">GPUTPCGMMergedTrackHit::flagReject</a>) {</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>        <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\tSkipping hit %d, %d hits rejected, flag %X\n&quot;</span>, ihit, nMissed, (int32_t)<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../d8/df7/BenchCathodeSegmentation_8cxx.html#a7ff4fc3bbf305206c6f2b97d4e6681a0">state</a>));</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>        <span class="keywordflow">if</span> (finalOutInFit &amp;&amp; !(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../d8/df7/BenchCathodeSegmentation_8cxx.html#a7ff4fc3bbf305206c6f2b97d4e6681a0">state</a> &amp; <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067ac615c3e236bd7318730a5311e1b6c7ad">GPUTPCGMMergedTrackHit::flagReject</a>)) {</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>          <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].state |= <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067aac525df6bf55a382f6227ac3ddb0a51e">GPUTPCGMMergedTrackHit::flagRejectErr</a>;</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>        }</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>      }</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span> </div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> allowChangeClusters = finalOutInFit &amp;&amp; (nWays == 1 || ((iWay &amp; 1) ? (ihit &lt;= CAMath::Max(maxN / 2, maxN - 30)) : (ihit &gt;= CAMath::Min(maxN / 2, 30))));</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span> </div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>      int32_t ihitMergeFirst = ihit;</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>      uint8_t clusterState = <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].state;</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> clAlpha = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.Alpha(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector);</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>      <span class="keywordtype">float</span> xx, yy, zz;</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>      {</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>        <span class="keyword">const</span> <a class="code hl_struct" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html">ClusterNative</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() cl = merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative-&gt;clustersLinear[<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].num];</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span>        merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;Transform(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector, <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>, cl.getPad(), cl.getTime(), xx, yy, zz, mTOffset);</div>
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno">  132</span>      }</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>      <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\tHit %3d/%3d Row %3d: Cluster Alpha %8.3f %3d, X %8.3f - Y %8.3f, Z %8.3f (Missed %d)\n&quot;</span>, ihit, maxN, (int32_t)<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>, clAlpha, (int32_t)<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector, xx, yy, zz, nMissed));</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>      <span class="comment">// CADEBUG(if ((uint32_t)merger-&gt;GetTrackingChain()-&gt;mIOPtrs.nMCLabelsTPC &gt; clusters[ihit].num))</span></div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>      <span class="comment">// CADEBUG({printf(&quot; MC:&quot;); for (int32_t i = 0; i &lt; 3; i++) {int32_t mcId = merger-&gt;GetTrackingChain()-&gt;mIOPtrs.mcLabelsTPC[clusters[ihit].num].fClusterID[i].fMCID; if (mcId &gt;= 0) printf(&quot; %d&quot;, mcId); } } printf(&quot;\n&quot;));</span></div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>      <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>      <span class="keywordflow">if</span> (MergeDoubleRowClusters(ihit, wayDirection, <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, merger, prop, xx, yy, zz, maxN, clAlpha, clusterState, allowChangeClusters) == -1) {</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>        nMissed++;</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>        nMissed2++;</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>      }</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span> </div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>      <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.rejectIFCLowRadiusCluster) {</div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> r2 = xx * xx + yy * yy;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> rmax = (83.5f + <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.sysClusErrorMinDist);</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>        <span class="keywordflow">if</span> (r2 &lt; rmax * rmax) {</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>          MarkClusters(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, ihitMergeFirst, ihit, wayDirection, <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067aac525df6bf55a382f6227ac3ddb0a51e">GPUTPCGMMergedTrackHit::flagRejectErr</a>);</div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>        }</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>      }</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span> </div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; cluster = <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit];</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span> </div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\tSector %2d %11sTrack   Alpha %8.3f %s, X %8.3f - Y %8.3f, Z %8.3f   -   QPt %7.2f (%7.2f), SP %5.2f (%5.2f) %28s    ---   Cov sY %8.3f sZ %8.3f sSP %8.3f sPt %8.3f   -   YPt %8.3f\n&quot;</span>, (int32_t)cluster.sector, <span class="stringliteral">&quot;&quot;</span>, prop.GetAlpha(), (CAMath::Abs(prop.GetAlpha() - clAlpha) &lt; 0.01 ? <span class="stringliteral">&quot;   &quot;</span> : <span class="stringliteral">&quot; R!&quot;</span>), mX, mP[0], mP[1], mP[4], prop.GetQPt0(), mP[2], prop.GetSinPhi0(), <span class="stringliteral">&quot;&quot;</span>, sqrtf(mC[0]), sqrtf(mC[2]), sqrtf(mC[5]), sqrtf(mC[14]), mC[10]));</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>      <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>      <span class="keywordflow">if</span> (allowChangeClusters &amp;&amp; lastRow != 255 &amp;&amp; CAMath::Abs(cluster.row - lastRow) &gt; 1) {</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>        <span class="keywordflow">if</span> <a class="code hl_define" href="../../df/d21/GPUCommonDef_8h.html#a0a7cfdbdb72983acb92fcae8a795f6ae">GPUCA_RTC_CONSTEXPR</a> (<a class="code hl_define" href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a>(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.par, dodEdx)) {</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span>          <span class="keywordtype">bool</span> dodEdx = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.dodEdxEnabled &amp;&amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.adddEdxSubThresholdClusters &amp;&amp; finalFit &amp;&amp; CAMath::Abs(cluster.row - lastRow) == 2;</div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span>          dodEdx = AttachClustersPropagate(merger, cluster.sector, lastRow, cluster.row, iTrk, track.Leg() == 0, prop, inFlyDirection, <a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a>, dodEdx);</div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>          <span class="keywordflow">if</span> (dodEdx) {</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>            dEdx.fillSubThreshold(lastRow - wayDirection);</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>            <span class="keywordflow">if</span> <a class="code hl_define" href="../../df/d21/GPUCommonDef_8h.html#a0a7cfdbdb72983acb92fcae8a795f6ae">GPUCA_RTC_CONSTEXPR</a> (<a class="code hl_define" href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a>(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc, dEdxClusterRejectionFlagMask) != <a class="code hl_define" href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a>(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc, dEdxClusterRejectionFlagMaskAlt)) {</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>              dEdxAlt.fillSubThreshold(lastRow - wayDirection);</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>            }</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>          }</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>        }</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>      }</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span> </div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>      int32_t retValProp = prop.PropagateToXAlpha(xx, clAlpha, inFlyDirection);</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span>      <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno">  173</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(<span class="keywordflow">if</span> (!CheckCov()){printf(<span class="stringliteral">&quot;INVALID COV AFTER PROPAGATE!!!\n&quot;</span>);});</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>      <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>      <span class="keywordflow">if</span> (retValProp == -2) <span class="comment">// Rotation failed, try to bring to new x with old alpha first, rotate, and then propagate to x, alpha</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>      {</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span>        <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;REROTATE\n&quot;</span>));</div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>        <span class="keywordflow">if</span> (prop.PropagateToXAlpha(xx, prop.GetAlpha(), inFlyDirection) == 0) {</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>          retValProp = prop.PropagateToXAlpha(xx, clAlpha, inFlyDirection);</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>        }</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>      }</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>      <span class="keywordflow">if</span> (lastRow == 255 || CAMath::Abs((int32_t)lastRow - (int32_t)cluster.row) &gt; 5 || lastSector != cluster.sector || (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackFitRejectMode &lt; 0 &amp;&amp; -nMissed &lt;= <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackFitRejectMode)) {</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>        goodRows = 0;</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>        goodRows++;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>      }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span>      <span class="keywordflow">if</span> (retValProp == 0) {</div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>        lastRow = cluster.row;</div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>        lastSector = cluster.<a class="code hl_variable" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#a7351d3f8aed3b58a7ca5f5fd01311cc4">sector</a>;</div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>      }</div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>      <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t%21sPropaga Alpha %8.3f    , X %8.3f - Y %8.3f, Z %8.3f   -   QPt %7.2f (%7.2f), SP %5.2f (%5.2f)   ---   Res %8.3f %8.3f   ---   Cov sY %8.3f sZ %8.3f sSP %8.3f sPt %8.3f   -   YPt %8.3f   -   PErr %d&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, prop.GetAlpha(), mX, mP[0], mP[1], mP[4], prop.GetQPt0(), mP[2], prop.GetSinPhi0(), mP[0] - yy, mP[1] - zz, sqrtf(mC[0]), sqrtf(mC[2]), sqrtf(mC[5]), sqrtf(mC[14]), mC[10], retValProp));</div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>      <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span> </div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>      <span class="keywordflow">if</span> (crossCE) {</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>        <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.addErrorsCECrossing) {</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>          <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.addErrorsCECrossing &gt;= 2) {</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>            AddCovDiagErrorsWithCorrelations(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.errorsCECrossing);</div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>            AddCovDiagErrors(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.errorsCECrossing);</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>          }</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mC[2] &lt; 0.5f) {</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>          mC[2] = 0.5f;</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>        }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span>      }</div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span> </div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>      <span class="keywordtype">float</span> uncorrectedY = -1e6f;</div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>      <span class="keywordflow">if</span> (allowChangeClusters) {</div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>        uncorrectedY = AttachClusters(merger, cluster.sector, cluster.row, iTrk, track.Leg() == 0, prop);</div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span>      }</div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span> </div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span>      <span class="keyword">const</span> <span class="keywordtype">bool</span> sinPhiErr = mNDF &gt; 0 &amp;&amp; CAMath::Abs(prop.GetSinPhi0()) &gt;= maxSinForUpdate;</div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>      <span class="keywordflow">if</span> (mNDF &gt;= 0 &amp;&amp; (mC[0] &gt; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackFitCovLimit || mC[2] &gt; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackFitCovLimit)) {</div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>      }</div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>      <span class="keywordflow">if</span> (retValProp || sinPhiErr) {</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>        MarkClusters(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, ihitMergeFirst, ihit, wayDirection, <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067a4e5f9a4a3a3f042ff45acaa3b2d1a9ab">GPUTPCGMMergedTrackHit::flagHighIncl</a>);</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>        nMissed2++;</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>        NTolerated++;</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>        <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;, %d --- break\n&quot;</span>, (int32_t)sinPhiErr));</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>        <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span>      }</div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\n&quot;</span>));</div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span> </div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>      int32_t retValUpd = 0, retValInt = 0;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>      <span class="keywordtype">float</span> threshold = 3.f + (lastUpdateX &gt;= 0 ? (CAMath::Abs(mX - lastUpdateX) / 2) : 0.f);</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>      <span class="keywordflow">if</span> (mNDF &gt; (int32_t)<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.mergerNonInterpolateRejectMinNDF &amp;&amp; (CAMath::Abs(yy - mP[0]) &gt; threshold || CAMath::Abs(zz - mP[1]) &gt; threshold)) {</div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>        retValUpd = <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#acdac77be8bdedc72a7321029b180087da023ccc3eb61e892fe57d37b054049560">GPUTPCGMPropagator::updateErrorClusterRejectedDistance</a>;</div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>        int8_t rejectChi2 = 0;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>        <span class="keywordflow">if</span> (attempt == 0) {</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>          <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.mergerInterpolateErrors &amp;&amp; CAMath::Abs(ihit - ihitMergeFirst) &lt;= 1) {</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span>            <span class="keywordflow">if</span> (iWay == nWays - 3) {</div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>              rejectChi2 = <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2a0dd7f90044770838842736fcef83e800">GPUTPCGMPropagator::rejectInterFill</a>;</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iWay == nWays - 2) {</div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span>              rejectChi2 = <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2a886e724fe45d004e513c1fd26aa3fe90">GPUTPCGMPropagator::rejectInterReject</a>;</div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span>            } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iWay == nWays - 1) {</div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span>              rejectChi2 = (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.mergerInterpolateRejectAlsoOnCurrentPosition &amp;&amp; GetNDF() &gt; (int32_t)<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.mergerNonInterpolateRejectMinNDF) ? <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2ae7e27cae06e98fa043dedd0cc4ab64f3">GPUTPCGMPropagator::rejectDirect</a> : 0;</div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>            }</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>            rejectChi2 = allowChangeClusters &amp;&amp; goodRows &gt; 5;</div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>          }</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>        }</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span> </div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        <span class="keywordtype">float</span> err2Y, err2Z;</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="../../d6/d77/FIT_2common_2include_2DataFormatsFIT_2RawEventData_8h.html#ada647bc214b6ea2c35e94324a030afea">time</a> = merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative ? merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative-&gt;clustersLinear[cluster.num].getTime() : -1.f;</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> invSqrtCharge = merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative ? CAMath::InvSqrt(merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative-&gt;clustersLinear[cluster.num].qMax) : 0.f;</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> invCharge = merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative ? (1.f / merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative-&gt;clustersLinear[cluster.num].qMax) : 0.f;</div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        <span class="keywordtype">float</span> invAvgCharge = (sumInvSqrtCharge += invSqrtCharge) / ++nAvgCharge;</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        invAvgCharge *= invAvgCharge;</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>        prop.GetErr2(err2Y, err2Z, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, zz, cluster.row, clusterState, cluster.sector, <a class="code hl_variable" href="../../d6/d77/FIT_2common_2include_2DataFormatsFIT_2RawEventData_8h.html#ada647bc214b6ea2c35e94324a030afea">time</a>, invAvgCharge, invCharge);</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span> </div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>        <span class="keywordflow">if</span> (rejectChi2 &gt;= <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2a0dd7f90044770838842736fcef83e800">GPUTPCGMPropagator::rejectInterFill</a>) {</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>          <span class="keywordflow">if</span> (rejectChi2 == <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2a886e724fe45d004e513c1fd26aa3fe90">GPUTPCGMPropagator::rejectInterReject</a> &amp;&amp; interpolation.<a class="code hl_variable" href="../../df/dcd/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors.html#aaf4fca9df601e06dbb0d69c92e85a3da">hit</a>[ihit].<a class="code hl_variable" href="../../dc/d37/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrorHit.html#aa8b5d1e383d25788a5822b660b820a68">errorY</a> &lt; (<a class="code hl_define" href="../../d6/d27/GPUDefParametersWrapper_8h.html#aa65b3e2dc2fd9426a5f3f4d57622e31c">GPUCA_PAR_MERGER_INTERPOLATION_ERROR_TYPE_A</a>)0) {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>            rejectChi2 = <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2ae7e27cae06e98fa043dedd0cc4ab64f3">GPUTPCGMPropagator::rejectDirect</a>;</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>            retValInt = prop.InterpolateReject(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, yy, zz, clusterState, rejectChi2, &amp;interpolation.<a class="code hl_variable" href="../../df/dcd/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors.html#aaf4fca9df601e06dbb0d69c92e85a3da">hit</a>[ihit], err2Y, err2Z, deltaZ);</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>          }</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>        }</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span> </div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>        <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.rejectEdgeClustersInTrackFit &amp;&amp; uncorrectedY &gt; -1e6f &amp;&amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rejectEdgeClusterByY(uncorrectedY, cluster.row, CAMath::Sqrt(mC[0]))) { <span class="comment">// uncorrectedY &gt; -1e6f implies allowChangeClusters</span></div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>          retValUpd = <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#acdac77be8bdedc72a7321029b180087daa23360650d1192de6af603b467ccbb3a">GPUTPCGMPropagator::updateErrorClusterRejectedEdge</a>;</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>          retValUpd = prop.Update(yy, zz, cluster.row, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, clusterState, rejectChi2, refit, err2Y, err2Z);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>        }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>        <a class="code hl_define" href="../../df/d21/GPUCommonDef_8h.html#a0117e1486062f932ded994de0d587344">GPUCA_DEBUG_STREAMER_CHECK</a>(<span class="keywordflow">if</span> (o2::utils::DebugStreamer::checkStream(<a class="code hl_enumvalue" href="../../d0/d28/namespaceo2_1_1utils.html#ab00bdc0f94fa861734930fc91cf67e14aef681b849c96debe373d047a9b4ed455">o2::utils::StreamFlags::streamUpdateTrack</a>, iTrk)) {</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>          merger-&gt;DebugStreamerUpdate(iTrk, ihit, xx, yy, zz, cluster, merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative-&gt;clustersLinear[cluster.num], *<span class="keyword">this</span>, prop, interpolation.<a class="code hl_variable" href="../../df/dcd/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors.html#aaf4fca9df601e06dbb0d69c92e85a3da">hit</a>[ihit], rejectChi2, refit, retValUpd, sumInvSqrtCharge / nAvgCharge * sumInvSqrtCharge / nAvgCharge, yy, zz, clusterState, retValInt, err2Y, err2Z);</div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>        });</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>      }</div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>      <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(<span class="keywordflow">if</span> (!CheckCov()) GPUError(<span class="stringliteral">&quot;INVALID COV AFTER UPDATE!!!&quot;</span>));</div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t%21sFit     Alpha %8.3f    , X %8.3f - Y %8.3f, Z %8.3f   -   QPt %7.2f (%7.2f), SP %5.2f (%5.2f), DzDs %5.2f %16s    ---   Cov sY %8.3f sZ %8.3f sSP %8.3f sPt %8.3f   -   YPt %8.3f   -   FErr %d %d\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, prop.GetAlpha(), mX, mP[0], mP[1], mP[4], prop.GetQPt0(), mP[2], prop.GetSinPhi0(), mP[3], <span class="stringliteral">&quot;&quot;</span>, sqrtf(mC[0]), sqrtf(mC[2]), sqrtf(mC[5]), sqrtf(mC[14]), mC[10], retValUpd, retValInt));</div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>      <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span> </div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>      ConstrainSinPhi();            <span class="comment">// TODO: Limit using ConstrainSinPhi everywhere!</span></div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      <span class="keywordflow">if</span> (!retValUpd &amp;&amp; !retValInt) <span class="comment">// track is updated</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>      {</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>        lastUpdateX = mX;</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        covYYUpd = mC[0];</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        nMissed = nMissed2 = 0;</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>        UnmarkClusters(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, ihitMergeFirst, ihit, wayDirection, <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067a4e5f9a4a3a3f042ff45acaa3b2d1a9ab">GPUTPCGMMergedTrackHit::flagHighIncl</a>);</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>        N++;</div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>        ihitStart = ihit;</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>        <span class="keywordtype">float</span> dy = mP[0] - prop.Model().<a class="code hl_variable" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#a010f4eb6e4487f78257be8b2cb8d588b">Y</a>();</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>        <span class="keywordtype">float</span> dz = mP[1] - prop.Model().<a class="code hl_variable" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#abc6775fc22e3d39c5ce6fc1015ca8f41">Z</a>();</div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>        <span class="keywordflow">if</span> (CAMath::Abs(mP[4]) * <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.qptB5Scaler &gt; 10 &amp;&amp; --resetT0 &lt;= 0 &amp;&amp; CAMath::Abs(mP[2]) &lt; 0.15f &amp;&amp; dy * dy + dz * dz &gt; 1) {</div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>          <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;Reinit linearization\n&quot;</span>));</div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>          prop.SetTrack(<span class="keyword">this</span>, prop.GetAlpha());</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>        }</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>        <span class="keywordflow">if</span> <a class="code hl_define" href="../../df/d21/GPUCommonDef_8h.html#a0a7cfdbdb72983acb92fcae8a795f6ae">GPUCA_RTC_CONSTEXPR</a> (<a class="code hl_define" href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a>(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.par, dodEdx)) {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>          <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.dodEdxEnabled &amp;&amp; finalFit) { <span class="comment">// TODO: Costimize flag to remove, and option to remove double-clusters</span></div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>            <span class="keywordtype">bool</span> acc = (clusterState &amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.dEdxClusterRejectionFlagMask) == 0, accAlt = (clusterState &amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.dEdxClusterRejectionFlagMaskAlt) == 0;</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>            <span class="keywordflow">if</span> (acc || accAlt) {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>              <span class="keywordtype">float</span> qtot = 0, qmax = 0, pad = 0, relTime = 0;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>              <span class="keyword">const</span> int32_t clusterCount = (ihit - ihitMergeFirst) * wayDirection + 1;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>              <span class="keywordflow">for</span> (int32_t iTmp = ihitMergeFirst; iTmp != ihit + wayDirection; iTmp += wayDirection) {</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>                <span class="keyword">const</span> <a class="code hl_struct" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html">ClusterNative</a>&amp; cl = merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative-&gt;clustersLinear[cluster.num];</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>                qtot += cl.<a class="code hl_variable" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html#a869b47009cff6108aa57d25c6916e623">qTot</a>;</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>                qmax = CAMath::Max&lt;float&gt;(qmax, cl.<a class="code hl_variable" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html#a3bf15f414113a6e8754942e8f58d20fa">qMax</a>);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>                pad += cl.getPad();</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>                relTime += cl.getTime();</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>              }</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>              qtot /= clusterCount; <span class="comment">// TODO: Weighted Average</span></div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>              pad /= clusterCount;</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>              relTime /= clusterCount;</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>              relTime = relTime - CAMath::Round(relTime);</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>              <span class="keywordflow">if</span> (acc) {</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>                dEdx.fillCluster(qtot, qmax, cluster.row, cluster.sector, mP[2], mP[3], merger-&gt;GetConstantMem()-&gt;calibObjects, zz, pad, relTime);</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>              }</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>              <span class="keywordflow">if</span> <a class="code hl_define" href="../../df/d21/GPUCommonDef_8h.html#a0a7cfdbdb72983acb92fcae8a795f6ae">GPUCA_RTC_CONSTEXPR</a> (<a class="code hl_define" href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a>(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc, dEdxClusterRejectionFlagMask) != <a class="code hl_define" href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a>(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc, dEdxClusterRejectionFlagMaskAlt)) {</div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>                <span class="keywordflow">if</span> (accAlt) {</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>                  dEdxAlt.fillCluster(qtot, qmax, cluster.row, cluster.sector, mP[2], mP[3], merger-&gt;GetConstantMem()-&gt;calibObjects, zz, pad, relTime);</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>                }</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>              }</div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>            }</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>          }</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>        }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (retValInt || retValUpd &gt;= <a class="code hl_enumvalue" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#acdac77be8bdedc72a7321029b180087da6da4ecd1404da6ed96ca9e91d5def1d1">GPUTPCGMPropagator::updateErrorClusterRejected</a>) { <span class="comment">// cluster far away form the track</span></div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span>        <span class="keywordflow">if</span> (retValInt || allowChangeClusters) {</div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>          MarkClusters(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, ihitMergeFirst, ihit, wayDirection, <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067a6f78dd6ee2fa5a97155fc5e0e7cadf8d">GPUTPCGMMergedTrackHit::flagRejectDistance</a>);</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (finalFit) {</div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>          MarkClusters(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, ihitMergeFirst, ihit, wayDirection, <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067aac525df6bf55a382f6227ac3ddb0a51e">GPUTPCGMMergedTrackHit::flagRejectErr</a>);</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>        }</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>        <span class="keywordflow">if</span> (!retValInt) {</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>          nMissed++;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>          nMissed2++;</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>        }</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>        <span class="keywordflow">break</span>; <span class="comment">// bad chi2 for the whole track, stop the fit</span></div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span>      }</div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>    }</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>    <span class="keywordflow">if</span> (finalOutInFit &amp;&amp; !(merger-&gt;Param().rec.tpc.disableRefitAttachment &amp; 4) &amp;&amp; lastRow != 255 &amp;&amp; lastSector != 255) {</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>      StoreLoopPropagation(merger, lastSector, lastRow, iTrk, lastRow &gt; <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[(iWay &amp; 1) ? (maxN - 1) : 0].row, prop.GetAlpha());</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t\tSTORING %d lastRow %d row %d out %d\n&quot;</span>, iTrk, (<span class="keywordtype">int</span>)lastRow, (<span class="keywordtype">int</span>)<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[(iWay &amp; 1) ? (maxN - 1) : 0].row, lastRow &gt; <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[(iWay &amp; 1) ? (maxN - 1) : 0].row));</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    }</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>    <span class="keywordflow">if</span> (!(iWay &amp; 1) &amp;&amp; !finalFit &amp;&amp; !track.CCE() &amp;&amp; !track.Looper()) {</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span>      deltaZ = ShiftZ(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, merger, maxN);</div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>      deltaZ = 0.f;</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span>    }</div>
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno">  341</span>  }</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>  ConstrainSinPhi();</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span> </div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>  <a class="code hl_define" href="../../df/d21/GPUCommonDef_8h.html#a0117e1486062f932ded994de0d587344">GPUCA_DEBUG_STREAMER_CHECK</a>(<span class="keywordflow">if</span> (o2::utils::DebugStreamer::checkStream(<a class="code hl_enumvalue" href="../../d0/d28/namespaceo2_1_1utils.html#ab00bdc0f94fa861734930fc91cf67e14aef681b849c96debe373d047a9b4ed455">o2::utils::StreamFlags::streamUpdateTrack</a>, iTrk)) {</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span>    o2::utils::DebugStreamer::instance()-&gt;getStreamer(<span class="stringliteral">&quot;debug_accept_track&quot;</span>, <span class="stringliteral">&quot;UPDATE&quot;</span>) &lt;&lt; o2::utils::DebugStreamer::instance()-&gt;getUniqueTreeName(<span class="stringliteral">&quot;debug_accept_track&quot;</span>).data() &lt;&lt; <span class="stringliteral">&quot;iTrk=&quot;</span> &lt;&lt; iTrk &lt;&lt; <span class="stringliteral">&quot;outerParam=&quot;</span> &lt;&lt; track.OuterParam() &lt;&lt; <span class="stringliteral">&quot;track=&quot;</span> &lt;&lt; <span class="keyword">this</span> &lt;&lt; <span class="stringliteral">&quot;ihitStart=&quot;</span> &lt;&lt; ihitStart &lt;&lt; <span class="stringliteral">&quot;\n&quot;</span>;</div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>  })</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span> </div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span>  <span class="keywordflow">if</span> (!(N + NTolerated &gt;= <a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#ac90e54cf02271e7853b27433a7bfc483">GPUCA_TRACKLET_SELECTOR_MIN_HITS_B5</a>(mP[4] * <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.qptB5Scaler) &amp;&amp; 2 * NTolerated &lt;= CAMath::Max(10, N) &amp;&amp; CheckNumericalQuality(covYYUpd))) {</div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>; <span class="comment">// TODO: NTolerated should never become that large, check what is going wrong!</span></div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>  }</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>  <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.minNClustersFinalTrack != -1 &amp;&amp; N + NTolerated &lt; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.minNClustersFinalTrack) {</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span>    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>  }</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span> </div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>  <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.par.dodEdx &amp;&amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.dodEdxEnabled) {</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>    dEdx.computedEdx(merger-&gt;MergedTracksdEdx()[iTrk], <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>);</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span>    <span class="keywordflow">if</span> <a class="code hl_define" href="../../df/d21/GPUCommonDef_8h.html#a0a7cfdbdb72983acb92fcae8a795f6ae">GPUCA_RTC_CONSTEXPR</a> (<a class="code hl_define" href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a>(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc, dEdxClusterRejectionFlagMask) != <a class="code hl_define" href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a>(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc, dEdxClusterRejectionFlagMaskAlt)) {</div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>      dEdxAlt.computedEdx(merger-&gt;MergedTracksdEdxAlt()[iTrk], <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>);</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>    }</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>  }</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>  Alpha = prop.GetAlpha();</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>  MoveToReference(prop, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, Alpha);</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>  NormalizeAlpha(Alpha);</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span> </div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>  <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>}</div>
</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span> </div>
<div class="foldopen" id="foldopen00368" data-start="{" data-end="}">
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno"><a class="line" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a91bfebfe3c8ecfae6391f27534ee3fa8">  368</a></span><a class="code hl_function" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a91bfebfe3c8ecfae6391f27534ee3fa8">GPUdni</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::MoveToReference(<a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a>&amp; prop, const <a class="code hl_struct" href="../../d3/d65/structo2_1_1gpu_1_1GPUParam.html">GPUParam</a>&amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, <span class="keywordtype">float</span>&amp; Alpha)</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>{</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> kDeg2Rad = M_PI / 180.f;</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> kSectAngle = 2 * M_PI / 18.f;</div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span> </div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>  <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackReferenceX &lt;= 500) {</div>
<div class="line"><a id="l00374" name="l00374"></a><span class="lineno">  374</span>    <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a> save = *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00375" name="l00375"></a><span class="lineno">  375</span>    <span class="keywordtype">float</span> saveAlpha = Alpha;</div>
<div class="line"><a id="l00376" name="l00376"></a><span class="lineno">  376</span>    <span class="keywordflow">for</span> (int32_t attempt = 0; attempt &lt; 3; attempt++) {</div>
<div class="line"><a id="l00377" name="l00377"></a><span class="lineno">  377</span>      <span class="keywordtype">float</span> dAngle = CAMath::Round(CAMath::ATan2(mP[0], mX) / kDeg2Rad / 20.f) * kSectAngle;</div>
<div class="line"><a id="l00378" name="l00378"></a><span class="lineno">  378</span>      Alpha += dAngle;</div>
<div class="line"><a id="l00379" name="l00379"></a><span class="lineno">  379</span>      <span class="keywordflow">if</span> (prop.PropagateToXAlpha(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.trackReferenceX, Alpha, 0)) {</div>
<div class="line"><a id="l00380" name="l00380"></a><span class="lineno">  380</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00381" name="l00381"></a><span class="lineno">  381</span>      }</div>
<div class="line"><a id="l00382" name="l00382"></a><span class="lineno">  382</span>      ConstrainSinPhi();</div>
<div class="line"><a id="l00383" name="l00383"></a><span class="lineno">  383</span>      <span class="keywordflow">if</span> (CAMath::Abs(mP[0]) &lt;= mX * CAMath::Tan(kSectAngle / 2.f)) {</div>
<div class="line"><a id="l00384" name="l00384"></a><span class="lineno">  384</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00385" name="l00385"></a><span class="lineno">  385</span>      }</div>
<div class="line"><a id="l00386" name="l00386"></a><span class="lineno">  386</span>    }</div>
<div class="line"><a id="l00387" name="l00387"></a><span class="lineno">  387</span>    *<span class="keyword">this</span> = save;</div>
<div class="line"><a id="l00388" name="l00388"></a><span class="lineno">  388</span>    Alpha = saveAlpha;</div>
<div class="line"><a id="l00389" name="l00389"></a><span class="lineno">  389</span>  }</div>
<div class="line"><a id="l00390" name="l00390"></a><span class="lineno">  390</span>  <span class="keywordflow">if</span> (CAMath::Abs(mP[0]) &gt; mX * CAMath::Tan(kSectAngle / 2.f)) {</div>
<div class="line"><a id="l00391" name="l00391"></a><span class="lineno">  391</span>    <span class="keywordtype">float</span> dAngle = CAMath::Round(CAMath::ATan2(mP[0], mX) / kDeg2Rad / 20.f) * kSectAngle;</div>
<div class="line"><a id="l00392" name="l00392"></a><span class="lineno">  392</span>    Rotate(dAngle);</div>
<div class="line"><a id="l00393" name="l00393"></a><span class="lineno">  393</span>    ConstrainSinPhi();</div>
<div class="line"><a id="l00394" name="l00394"></a><span class="lineno">  394</span>    Alpha += dAngle;</div>
<div class="line"><a id="l00395" name="l00395"></a><span class="lineno">  395</span>  }</div>
<div class="line"><a id="l00396" name="l00396"></a><span class="lineno">  396</span>}</div>
</div>
<div class="line"><a id="l00397" name="l00397"></a><span class="lineno">  397</span> </div>
<div class="line"><a id="l00398" name="l00398"></a><span class="lineno">  398</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::MirrorTo(<a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() prop, <span class="keywordtype">float</span> toY, <span class="keywordtype">float</span> toZ, <span class="keywordtype">bool</span> inFlyDirection, const <a class="code hl_struct" href="../../d3/d65/structo2_1_1gpu_1_1GPUParam.html">GPUParam</a>&amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, uint8_t <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>, uint8_t clusterState, <span class="keywordtype">bool</span> mirrorParameters, int8_t sector)</div>
<div class="line"><a id="l00399" name="l00399"></a><span class="lineno">  399</span>{</div>
<div class="line"><a id="l00400" name="l00400"></a><span class="lineno">  400</span>  <span class="keywordflow">if</span> (mirrorParameters) {</div>
<div class="line"><a id="l00401" name="l00401"></a><span class="lineno">  401</span>    prop.Mirror(inFlyDirection);</div>
<div class="line"><a id="l00402" name="l00402"></a><span class="lineno">  402</span>  }</div>
<div class="line"><a id="l00403" name="l00403"></a><span class="lineno">  403</span>  <span class="keywordtype">float</span> err2Y, err2Z;</div>
<div class="line"><a id="l00404" name="l00404"></a><span class="lineno">  404</span>  prop.GetErr2(err2Y, err2Z, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>, toZ, <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>, clusterState, sector, -1.f, 0.f, 0.f); <span class="comment">// Use correct time / avgCharge</span></div>
<div class="line"><a id="l00405" name="l00405"></a><span class="lineno">  405</span>  prop.Model().<a class="code hl_variable" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html#aaedd0286215a9951501d0cbe2c34ecd1">Y</a>() = mP[0] = toY;</div>
<div class="line"><a id="l00406" name="l00406"></a><span class="lineno">  406</span>  prop.Model().Z() = mP[1] = toZ;</div>
<div class="line"><a id="l00407" name="l00407"></a><span class="lineno">  407</span>  <span class="keywordflow">if</span> (mC[0] &lt; err2Y) {</div>
<div class="line"><a id="l00408" name="l00408"></a><span class="lineno">  408</span>    mC[0] = err2Y;</div>
<div class="line"><a id="l00409" name="l00409"></a><span class="lineno">  409</span>  }</div>
<div class="line"><a id="l00410" name="l00410"></a><span class="lineno">  410</span>  <span class="keywordflow">if</span> (mC[2] &lt; err2Z) {</div>
<div class="line"><a id="l00411" name="l00411"></a><span class="lineno">  411</span>    mC[2] = err2Z;</div>
<div class="line"><a id="l00412" name="l00412"></a><span class="lineno">  412</span>  }</div>
<div class="line"><a id="l00413" name="l00413"></a><span class="lineno">  413</span>  <span class="keywordflow">if</span> (CAMath::Abs(mC[5]) &lt; 0.1f) {</div>
<div class="line"><a id="l00414" name="l00414"></a><span class="lineno">  414</span>    mC[5] = mC[5] &gt; 0 ? 0.1f : -0.1f;</div>
<div class="line"><a id="l00415" name="l00415"></a><span class="lineno">  415</span>  }</div>
<div class="line"><a id="l00416" name="l00416"></a><span class="lineno">  416</span>  <span class="keywordflow">if</span> (mC[9] &lt; 1.f) {</div>
<div class="line"><a id="l00417" name="l00417"></a><span class="lineno">  417</span>    mC[9] = 1.f;</div>
<div class="line"><a id="l00418" name="l00418"></a><span class="lineno">  418</span>  }</div>
<div class="line"><a id="l00419" name="l00419"></a><span class="lineno">  419</span>  mC[1] = mC[4] = mC[6] = mC[8] = mC[11] = mC[13] = 0;</div>
<div class="line"><a id="l00420" name="l00420"></a><span class="lineno">  420</span>  prop.SetTrack(<span class="keyword">this</span>, prop.GetAlpha());</div>
<div class="line"><a id="l00421" name="l00421"></a><span class="lineno">  421</span>  mNDF = -3;</div>
<div class="line"><a id="l00422" name="l00422"></a><span class="lineno">  422</span>  mChi2 = 0;</div>
<div class="line"><a id="l00423" name="l00423"></a><span class="lineno">  423</span>}</div>
<div class="line"><a id="l00424" name="l00424"></a><span class="lineno">  424</span> </div>
<div class="line"><a id="l00425" name="l00425"></a><span class="lineno">  425</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() int32_t <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::MergeDoubleRowClusters(int32_t&amp; ihit, int32_t wayDirection, <a class="code hl_struct" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html">GPUTPCGMMergedTrackHit</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() merger, <a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() prop, <span class="keywordtype">float</span>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() xx, <span class="keywordtype">float</span>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() yy, <span class="keywordtype">float</span>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() zz, int32_t maxN, <span class="keywordtype">float</span> clAlpha, uint8_t&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() clusterState, <span class="keywordtype">bool</span> rejectChi2)</div>
<div class="line"><a id="l00426" name="l00426"></a><span class="lineno">  426</span>{</div>
<div class="line"><a id="l00427" name="l00427"></a><span class="lineno">  427</span>  <span class="keywordflow">if</span> (ihit + wayDirection &gt;= 0 &amp;&amp; ihit + wayDirection &lt; maxN &amp;&amp; <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a> == <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit + wayDirection].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a> &amp;&amp; <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector == <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit + wayDirection].sector) {</div>
<div class="line"><a id="l00428" name="l00428"></a><span class="lineno">  428</span>    <span class="keywordtype">float</span> maxDistY, maxDistZ;</div>
<div class="line"><a id="l00429" name="l00429"></a><span class="lineno">  429</span>    prop.GetErr2(maxDistY, maxDistZ, merger-&gt;Param(), zz, <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].row, 0, <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector, -1.f, 0.f, 0.f); <span class="comment">// TODO: Use correct time, avgCharge</span></div>
<div class="line"><a id="l00430" name="l00430"></a><span class="lineno">  430</span>    maxDistY = (maxDistY + mC[0]) * 20.f;</div>
<div class="line"><a id="l00431" name="l00431"></a><span class="lineno">  431</span>    maxDistZ = (maxDistZ + mC[2]) * 20.f;</div>
<div class="line"><a id="l00432" name="l00432"></a><span class="lineno">  432</span>    int32_t noReject = 0; <span class="comment">// Cannot reject if simple estimation of y/z fails (extremely unlike case)</span></div>
<div class="line"><a id="l00433" name="l00433"></a><span class="lineno">  433</span>    <span class="keywordflow">if</span> (CAMath::Abs(clAlpha - prop.GetAlpha()) &gt; 1.e-4f) {</div>
<div class="line"><a id="l00434" name="l00434"></a><span class="lineno">  434</span>      noReject = prop.RotateToAlpha(clAlpha);</div>
<div class="line"><a id="l00435" name="l00435"></a><span class="lineno">  435</span>    }</div>
<div class="line"><a id="l00436" name="l00436"></a><span class="lineno">  436</span>    <span class="keywordtype">float</span> projY = 0, projZ = 0;</div>
<div class="line"><a id="l00437" name="l00437"></a><span class="lineno">  437</span>    <span class="keywordflow">if</span> (noReject == 0) {</div>
<div class="line"><a id="l00438" name="l00438"></a><span class="lineno">  438</span>      noReject |= prop.GetPropagatedYZ(xx, projY, projZ);</div>
<div class="line"><a id="l00439" name="l00439"></a><span class="lineno">  439</span>    }</div>
<div class="line"><a id="l00440" name="l00440"></a><span class="lineno">  440</span>    <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a31eafbeac9256b106b6acfd78f305200">count</a> = 0.f;</div>
<div class="line"><a id="l00441" name="l00441"></a><span class="lineno">  441</span>    xx = yy = zz = 0.f;</div>
<div class="line"><a id="l00442" name="l00442"></a><span class="lineno">  442</span>    clusterState = 0;</div>
<div class="line"><a id="l00443" name="l00443"></a><span class="lineno">  443</span>    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a id="l00444" name="l00444"></a><span class="lineno">  444</span>      <span class="keyword">const</span> <a class="code hl_struct" href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html">ClusterNative</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() cl = merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative-&gt;clustersLinear[<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../d2/d12/bench__Clusterizer_8cxx.html#af656038045ce6448240b3767491787da">num</a>];</div>
<div class="line"><a id="l00445" name="l00445"></a><span class="lineno">  445</span>      <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#abd92661d757c8e8c0e50c1b9c3ce496e">clamp</a> = cl.qTot;</div>
<div class="line"><a id="l00446" name="l00446"></a><span class="lineno">  446</span>      <span class="keywordtype">float</span> clx, cly, clz;</div>
<div class="line"><a id="l00447" name="l00447"></a><span class="lineno">  447</span>      merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;Transform(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector, <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>, cl.getPad(), cl.<a class="code hl_function" href="../../d8/d5a/scan-hvlv-ccdb_8cxx.html#a0cab151bc8ea974b059e7604901a7285">getTime</a>(), clx, cly, clz, mTOffset);</div>
<div class="line"><a id="l00448" name="l00448"></a><span class="lineno">  448</span>      <span class="keywordtype">float</span> dy = cly - projY;</div>
<div class="line"><a id="l00449" name="l00449"></a><span class="lineno">  449</span>      <span class="keywordtype">float</span> dz = clz - projZ;</div>
<div class="line"><a id="l00450" name="l00450"></a><span class="lineno">  450</span>      if (noReject == 0 &amp;&amp; (dy * dy &gt; maxDistY || dz * dz &gt; maxDistZ)) {</div>
<div class="line"><a id="l00451" name="l00451"></a><span class="lineno">  451</span>        <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t\tRejecting double-row cluster: dy %f, dz %f, chiY %f, chiZ %f (Y: trk %f prj %f cl %f - Z: trk %f prj %f cl %f)\n&quot;</span>, dy, dz, sqrtf(maxDistY), sqrtf(maxDistZ), mP[0], projY, cly, mP[1], projZ, clz));</div>
<div class="line"><a id="l00452" name="l00452"></a><span class="lineno">  452</span>        <span class="keywordflow">if</span> (rejectChi2) {</div>
<div class="line"><a id="l00453" name="l00453"></a><span class="lineno">  453</span>          <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].state |= <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067a6f78dd6ee2fa5a97155fc5e0e7cadf8d">GPUTPCGMMergedTrackHit::flagRejectDistance</a>;</div>
<div class="line"><a id="l00454" name="l00454"></a><span class="lineno">  454</span>        }</div>
<div class="line"><a id="l00455" name="l00455"></a><span class="lineno">  455</span>      } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00456" name="l00456"></a><span class="lineno">  456</span>        <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t\tMerging hit row %d X %f Y %f Z %f (dy %f, dz %f, chiY %f, chiZ %f)\n&quot;</span>, <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>, clx, cly, clz, dy, dz, sqrtf(maxDistY), sqrtf(maxDistZ)));</div>
<div class="line"><a id="l00457" name="l00457"></a><span class="lineno">  457</span>        xx += clx * <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#abd92661d757c8e8c0e50c1b9c3ce496e">clamp</a>; <span class="comment">// TODO: Weight in pad/time instead of XYZ</span></div>
<div class="line"><a id="l00458" name="l00458"></a><span class="lineno">  458</span>        yy += cly * <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#abd92661d757c8e8c0e50c1b9c3ce496e">clamp</a>;</div>
<div class="line"><a id="l00459" name="l00459"></a><span class="lineno">  459</span>        zz += clz * <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#abd92661d757c8e8c0e50c1b9c3ce496e">clamp</a>;</div>
<div class="line"><a id="l00460" name="l00460"></a><span class="lineno">  460</span>        clusterState |= <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].state;</div>
<div class="line"><a id="l00461" name="l00461"></a><span class="lineno">  461</span>        <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a31eafbeac9256b106b6acfd78f305200">count</a> += <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#abd92661d757c8e8c0e50c1b9c3ce496e">clamp</a>;</div>
<div class="line"><a id="l00462" name="l00462"></a><span class="lineno">  462</span>      }</div>
<div class="line"><a id="l00463" name="l00463"></a><span class="lineno">  463</span>      <span class="keywordflow">if</span> (!(ihit + wayDirection &gt;= 0 &amp;&amp; ihit + wayDirection &lt; maxN &amp;&amp; <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a> == <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit + wayDirection].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a> &amp;&amp; <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit].sector == <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[ihit + wayDirection].sector)) {</div>
<div class="line"><a id="l00464" name="l00464"></a><span class="lineno">  464</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00465" name="l00465"></a><span class="lineno">  465</span>      }</div>
<div class="line"><a id="l00466" name="l00466"></a><span class="lineno">  466</span>      ihit += wayDirection;</div>
<div class="line"><a id="l00467" name="l00467"></a><span class="lineno">  467</span>    }</div>
<div class="line"><a id="l00468" name="l00468"></a><span class="lineno">  468</span>    <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a31eafbeac9256b106b6acfd78f305200">count</a> &lt; 0.1f) {</div>
<div class="line"><a id="l00469" name="l00469"></a><span class="lineno">  469</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t\tNo matching cluster in double-row, skipping\n&quot;</span>));</div>
<div class="line"><a id="l00470" name="l00470"></a><span class="lineno">  470</span>      <span class="keywordflow">return</span> -1;</div>
<div class="line"><a id="l00471" name="l00471"></a><span class="lineno">  471</span>    }</div>
<div class="line"><a id="l00472" name="l00472"></a><span class="lineno">  472</span>    xx /= <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a31eafbeac9256b106b6acfd78f305200">count</a>;</div>
<div class="line"><a id="l00473" name="l00473"></a><span class="lineno">  473</span>    yy /= <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a31eafbeac9256b106b6acfd78f305200">count</a>;</div>
<div class="line"><a id="l00474" name="l00474"></a><span class="lineno">  474</span>    zz /= <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a31eafbeac9256b106b6acfd78f305200">count</a>;</div>
<div class="line"><a id="l00475" name="l00475"></a><span class="lineno">  475</span>  }</div>
<div class="line"><a id="l00476" name="l00476"></a><span class="lineno">  476</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a id="l00477" name="l00477"></a><span class="lineno">  477</span>}</div>
<div class="line"><a id="l00478" name="l00478"></a><span class="lineno">  478</span> </div>
<div class="line"><a id="l00479" name="l00479"></a><span class="lineno">  479</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() float <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::AttachClusters(const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() Merger, int32_t sector, int32_t iRow, int32_t iTrack, <span class="keywordtype">bool</span> goodLeg, <a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a>&amp; prop)</div>
<div class="line"><a id="l00480" name="l00480"></a><span class="lineno">  480</span>{</div>
<div class="line"><a id="l00481" name="l00481"></a><span class="lineno">  481</span>  <span class="keywordtype">float</span> Y, Z;</div>
<div class="line"><a id="l00482" name="l00482"></a><span class="lineno">  482</span>  <span class="keywordtype">float</span> X = 0;</div>
<div class="line"><a id="l00483" name="l00483"></a><span class="lineno">  483</span>  Merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;InverseTransformYZtoX(sector, iRow, mP[0], mP[1], X);</div>
<div class="line"><a id="l00484" name="l00484"></a><span class="lineno">  484</span>  <span class="keywordflow">if</span> (prop.GetPropagatedYZ(X, Y, Z)) {</div>
<div class="line"><a id="l00485" name="l00485"></a><span class="lineno">  485</span>    Y = mP[0];</div>
<div class="line"><a id="l00486" name="l00486"></a><span class="lineno">  486</span>    Z = mP[1];</div>
<div class="line"><a id="l00487" name="l00487"></a><span class="lineno">  487</span>  }</div>
<div class="line"><a id="l00488" name="l00488"></a><span class="lineno">  488</span>  <span class="keywordflow">return</span> AttachClusters(Merger, sector, iRow, iTrack, goodLeg, Y, Z);</div>
<div class="line"><a id="l00489" name="l00489"></a><span class="lineno">  489</span>}</div>
<div class="line"><a id="l00490" name="l00490"></a><span class="lineno">  490</span> </div>
<div class="line"><a id="l00491" name="l00491"></a><span class="lineno">  491</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() float <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::AttachClusters(const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() Merger, int32_t sector, int32_t iRow, int32_t iTrack, <span class="keywordtype">bool</span> goodLeg, <span class="keywordtype">float</span> Y, <span class="keywordtype">float</span> Z)</div>
<div class="line"><a id="l00492" name="l00492"></a><span class="lineno">  492</span>{</div>
<div class="line"><a id="l00493" name="l00493"></a><span class="lineno">  493</span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a> = Merger-&gt;Param();</div>
<div class="line"><a id="l00494" name="l00494"></a><span class="lineno">  494</span>  <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.disableRefitAttachment &amp; 1) {</div>
<div class="line"><a id="l00495" name="l00495"></a><span class="lineno">  495</span>    <span class="keywordflow">return</span> -1e6f;</div>
<div class="line"><a id="l00496" name="l00496"></a><span class="lineno">  496</span>  }</div>
<div class="line"><a id="l00497" name="l00497"></a><span class="lineno">  497</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d4/da9/classo2_1_1gpu_1_1GPUTPCTracker.html">GPUTPCTracker</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() tracker = *(Merger-&gt;GetConstantMem()-&gt;tpcTrackers + sector);</div>
<div class="line"><a id="l00498" name="l00498"></a><span class="lineno">  498</span>  const <a class="code hl_class" href="../../da/d92/classo2_1_1gpu_1_1GPUTPCRow.html">GPUTPCRow</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a> = tracker.Row(iRow);</div>
<div class="line"><a id="l00499" name="l00499"></a><span class="lineno">  499</span>  <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ae132b4bad18d9e67004fbebb0a60dc3a">GPUglobalref</a>() const <a class="code hl_struct" href="../../de/da6/structo2_1_1gpu_1_1cahit2.html">cahit2</a>* hits = tracker.HitData(<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>);</div>
<div class="line"><a id="l00500" name="l00500"></a><span class="lineno">  500</span>  <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ae132b4bad18d9e67004fbebb0a60dc3a">GPUglobalref</a>() const <a class="code hl_typedef" href="../../d0/db4/namespaceo2_1_1gpu.html#afce867617e1a6b4db514bab5e441e992">calink</a>* firsthit = tracker.FirstHitInBin(<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>);</div>
<div class="line"><a id="l00501" name="l00501"></a><span class="lineno">  501</span>  if (<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.NHits() == 0) {</div>
<div class="line"><a id="l00502" name="l00502"></a><span class="lineno">  502</span>    <span class="keywordflow">return</span> -1e6f;</div>
<div class="line"><a id="l00503" name="l00503"></a><span class="lineno">  503</span>  }</div>
<div class="line"><a id="l00504" name="l00504"></a><span class="lineno">  504</span> </div>
<div class="line"><a id="l00505" name="l00505"></a><span class="lineno">  505</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> zOffset = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.par.continuousTracking ? Merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;getCorrMap()-&gt;convVertexTimeToZOffset(sector, mTOffset, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.continuousMaxTimeBin) : 0; <span class="comment">// TODO: do some validatiomns for the transform conv functions...</span></div>
<div class="line"><a id="l00506" name="l00506"></a><span class="lineno">  506</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a> = <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.Grid().YMin();</div>
<div class="line"><a id="l00507" name="l00507"></a><span class="lineno">  507</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> stepY = <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.HstepY();</div>
<div class="line"><a id="l00508" name="l00508"></a><span class="lineno">  508</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> z0 = <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.Grid().ZMin() - zOffset; <span class="comment">// We can use our own ZOffset, since this is only used temporarily anyway</span></div>
<div class="line"><a id="l00509" name="l00509"></a><span class="lineno">  509</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> stepZ = <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.HstepZ();</div>
<div class="line"><a id="l00510" name="l00510"></a><span class="lineno">  510</span>  int32_t bin, ny, nz;</div>
<div class="line"><a id="l00511" name="l00511"></a><span class="lineno">  511</span> </div>
<div class="line"><a id="l00512" name="l00512"></a><span class="lineno">  512</span>  <span class="keywordtype">float</span> uncorrectedY, uncorrectedZ;</div>
<div class="line"><a id="l00513" name="l00513"></a><span class="lineno">  513</span>  Merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;InverseTransformYZtoNominalYZ(sector, iRow, Y, Z, uncorrectedY, uncorrectedZ);</div>
<div class="line"><a id="l00514" name="l00514"></a><span class="lineno">  514</span>  <span class="keywordflow">if</span> (CAMath::Abs(uncorrectedY) &gt; <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.getTPCMaxY()) {</div>
<div class="line"><a id="l00515" name="l00515"></a><span class="lineno">  515</span>    <span class="keywordflow">return</span> uncorrectedY;</div>
<div class="line"><a id="l00516" name="l00516"></a><span class="lineno">  516</span>  }</div>
<div class="line"><a id="l00517" name="l00517"></a><span class="lineno">  517</span> </div>
<div class="line"><a id="l00518" name="l00518"></a><span class="lineno">  518</span>  <span class="keywordtype">bool</span> protect = CAMath::Abs(GetQPt() * <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.qptB5Scaler) &lt;= <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.rejectQPtB5 &amp;&amp; goodLeg;</div>
<div class="line"><a id="l00519" name="l00519"></a><span class="lineno">  519</span>  <span class="keywordtype">float</span> err2Y, err2Z;</div>
<div class="line"><a id="l00520" name="l00520"></a><span class="lineno">  520</span>  <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.GetClusterErrors2(sector, iRow, Z, mP[2], mP[3], -1.f, 0.f, 0.f, err2Y, err2Z); <span class="comment">// TODO: Use correct time/avgCharge</span></div>
<div class="line"><a id="l00521" name="l00521"></a><span class="lineno">  521</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> tubeMaxSize2 = protect ? <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.tubeProtectMaxSize2 : <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.tubeRemoveMaxSize2;</div>
<div class="line"><a id="l00522" name="l00522"></a><span class="lineno">  522</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> tubeMinSize2 = protect ? <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.tubeProtectMinSize2 : 0.f;</div>
<div class="line"><a id="l00523" name="l00523"></a><span class="lineno">  523</span>  <span class="keywordtype">float</span> tubeSigma2 = protect ? <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.tubeProtectSigma2 : <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.tubeRemoveSigma2;</div>
<div class="line"><a id="l00524" name="l00524"></a><span class="lineno">  524</span>  uint32_t pad = CAMath::Float2UIntRn(GPUTPCGeometry::LinearY2Pad(sector, iRow, uncorrectedY));</div>
<div class="line"><a id="l00525" name="l00525"></a><span class="lineno">  525</span>  <span class="keywordtype">float</span> <a class="code hl_variable" href="../../d6/d77/FIT_2common_2include_2DataFormatsFIT_2RawEventData_8h.html#ada647bc214b6ea2c35e94324a030afea">time</a> = Merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;getCorrMap()-&gt;InverseTransformInTimeFrame(sector, uncorrectedZ + (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.par.continuousTracking ? Merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;getCorrMap()-&gt;convVertexTimeToZOffset(sector, mTOffset, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.continuousMaxTimeBin) : 0), <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.continuousMaxTimeBin); <span class="comment">// TODO: Simplify this call in TPCFastTransform</span></div>
<div class="line"><a id="l00526" name="l00526"></a><span class="lineno">  526</span>  <span class="keywordflow">if</span> (iRow &lt; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.tubeExtraProtectMinRow ||</div>
<div class="line"><a id="l00527" name="l00527"></a><span class="lineno">  527</span>      pad &lt; param.rec.tpc.tubeExtraProtectEdgePads || pad &gt;= (uint32_t)(GPUTPCGeometry::NPads(iRow) - <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.tubeExtraProtectEdgePads) ||</div>
<div class="line"><a id="l00528" name="l00528"></a><span class="lineno">  528</span>      <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.GetUnscaledMult(<a class="code hl_variable" href="../../d6/d77/FIT_2common_2include_2DataFormatsFIT_2RawEventData_8h.html#ada647bc214b6ea2c35e94324a030afea">time</a>) / GPUTPCGeometry::Row2X(iRow) &gt; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.rec.tpc.tubeExtraProtectMinOccupancy) {</div>
<div class="line"><a id="l00529" name="l00529"></a><span class="lineno">  529</span>    tubeSigma2 *= protect ? 2 : 0.5;</div>
<div class="line"><a id="l00530" name="l00530"></a><span class="lineno">  530</span>  }</div>
<div class="line"><a id="l00531" name="l00531"></a><span class="lineno">  531</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> sy2 = CAMath::Max(tubeMinSize2, CAMath::Min(tubeMaxSize2, tubeSigma2 * (err2Y + CAMath::Abs(mC[0])))); <span class="comment">// Cov can be bogus when following circle</span></div>
<div class="line"><a id="l00532" name="l00532"></a><span class="lineno">  532</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> sz2 = CAMath::Max(tubeMinSize2, CAMath::Min(tubeMaxSize2, tubeSigma2 * (err2Z + CAMath::Abs(mC[2])))); <span class="comment">// In that case we should provide the track error externally</span></div>
<div class="line"><a id="l00533" name="l00533"></a><span class="lineno">  533</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> tubeY = CAMath::Sqrt(sy2);</div>
<div class="line"><a id="l00534" name="l00534"></a><span class="lineno">  534</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> tubeZ = CAMath::Sqrt(sz2);</div>
<div class="line"><a id="l00535" name="l00535"></a><span class="lineno">  535</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> sy21 = 1.f / sy2;</div>
<div class="line"><a id="l00536" name="l00536"></a><span class="lineno">  536</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> sz21 = 1.f / sz2;</div>
<div class="line"><a id="l00537" name="l00537"></a><span class="lineno">  537</span> </div>
<div class="line"><a id="l00538" name="l00538"></a><span class="lineno">  538</span>  <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.Grid().GetBinArea(uncorrectedY, uncorrectedZ + zOffset, tubeY, tubeZ, bin, ny, nz);</div>
<div class="line"><a id="l00539" name="l00539"></a><span class="lineno">  539</span>  <span class="keyword">const</span> int32_t nBinsY = <a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.Grid().Ny();</div>
<div class="line"><a id="l00540" name="l00540"></a><span class="lineno">  540</span>  <span class="keyword">const</span> int32_t idOffset = tracker.Data().ClusterIdOffset();</div>
<div class="line"><a id="l00541" name="l00541"></a><span class="lineno">  541</span>  <span class="keyword">const</span> int32_t* <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a43d7824acc27a497365ad4b5bc9e67fd">ids</a> = &amp;(tracker.Data().ClusterDataIndex()[<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>.HitNumberOffset()]);</div>
<div class="line"><a id="l00542" name="l00542"></a><span class="lineno">  542</span>  uint32_t myWeight = Merger-&gt;TrackOrderAttach()[iTrack] | <a class="code hl_enumvalue" href="../../dc/d1d/namespaceo2_1_1gpu_1_1gputpcgmmergertypes.html#a62d5634777307223b51231ff617dc51ba0fee1aa2917316f366a36e826f998cbc">gputpcgmmergertypes::attachAttached</a> | <a class="code hl_enumvalue" href="../../dc/d1d/namespaceo2_1_1gpu_1_1gputpcgmmergertypes.html#a62d5634777307223b51231ff617dc51ba198cdf2f4efc076b99a1e64e02bcb960">gputpcgmmergertypes::attachTube</a>;</div>
<div class="line"><a id="l00543" name="l00543"></a><span class="lineno">  543</span>  <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#a8dba65216e16495290e788a7006ddedf">GPUAtomic</a>(uint32_t)* <span class="keyword">const</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a2378b8283cbc1699028da8a3eea4711c">weights</a> = Merger-&gt;ClusterAttachment();</div>
<div class="line"><a id="l00544" name="l00544"></a><span class="lineno">  544</span>  <span class="keywordflow">if</span> (goodLeg) {</div>
<div class="line"><a id="l00545" name="l00545"></a><span class="lineno">  545</span>    myWeight |= <a class="code hl_enumvalue" href="../../dc/d1d/namespaceo2_1_1gpu_1_1gputpcgmmergertypes.html#a62d5634777307223b51231ff617dc51ba27f24f5ebdda1c9242359f70b74a818b">gputpcgmmergertypes::attachGoodLeg</a>;</div>
<div class="line"><a id="l00546" name="l00546"></a><span class="lineno">  546</span>  }</div>
<div class="line"><a id="l00547" name="l00547"></a><span class="lineno">  547</span>  <span class="keywordflow">if</span> (protect) {</div>
<div class="line"><a id="l00548" name="l00548"></a><span class="lineno">  548</span>    myWeight |= <a class="code hl_enumvalue" href="../../dc/d1d/namespaceo2_1_1gpu_1_1gputpcgmmergertypes.html#a62d5634777307223b51231ff617dc51bafcb8fe1f51be1c12759b32c352b64170">gputpcgmmergertypes::attachProtect</a>;</div>
<div class="line"><a id="l00549" name="l00549"></a><span class="lineno">  549</span>  }</div>
<div class="line"><a id="l00550" name="l00550"></a><span class="lineno">  550</span> </div>
<div class="line"><a id="l00551" name="l00551"></a><span class="lineno">  551</span>  <span class="keywordflow">for</span> (int32_t k = 0; k &lt;= nz; k++) {</div>
<div class="line"><a id="l00552" name="l00552"></a><span class="lineno">  552</span>    <span class="keyword">const</span> int32_t mybin = bin + k * nBinsY;</div>
<div class="line"><a id="l00553" name="l00553"></a><span class="lineno">  553</span>    <span class="keyword">const</span> uint32_t hitFst = firsthit[mybin];</div>
<div class="line"><a id="l00554" name="l00554"></a><span class="lineno">  554</span>    <span class="keyword">const</span> uint32_t hitLst = firsthit[mybin + ny + 1];</div>
<div class="line"><a id="l00555" name="l00555"></a><span class="lineno">  555</span>    <span class="keywordflow">for</span> (uint32_t ih = hitFst; ih &lt; hitLst; ih++) {</div>
<div class="line"><a id="l00556" name="l00556"></a><span class="lineno">  556</span>      int32_t <span class="keywordtype">id</span> = idOffset + <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a43d7824acc27a497365ad4b5bc9e67fd">ids</a>[ih];</div>
<div class="line"><a id="l00557" name="l00557"></a><span class="lineno">  557</span>      <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#a8dba65216e16495290e788a7006ddedf">GPUAtomic</a>(uint32_t)* <span class="keyword">const</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a6b425be07cfa8ac09043ef8391e7e514">weight</a> = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a2378b8283cbc1699028da8a3eea4711c">weights</a> + <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ae52362b10d585638f5b96140e90f1b7a">id</a>;</div>
<div class="line"><a id="l00558" name="l00558"></a><span class="lineno">  558</span>      <span class="keywordflow">if</span> <span class="keyword">constexpr</span> (GPUCA_PAR_NO_ATOMIC_PRECHECK == 0) {</div>
<div class="line"><a id="l00559" name="l00559"></a><span class="lineno">  559</span>        <span class="keywordflow">if</span> (myWeight &lt;= *<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a6b425be07cfa8ac09043ef8391e7e514">weight</a>) {</div>
<div class="line"><a id="l00560" name="l00560"></a><span class="lineno">  560</span>          <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00561" name="l00561"></a><span class="lineno">  561</span>        }</div>
<div class="line"><a id="l00562" name="l00562"></a><span class="lineno">  562</span>      }</div>
<div class="line"><a id="l00563" name="l00563"></a><span class="lineno">  563</span>      <span class="keyword">const</span> <a class="code hl_struct" href="../../de/da6/structo2_1_1gpu_1_1cahit2.html">cahit2</a> hh = hits[ih];</div>
<div class="line"><a id="l00564" name="l00564"></a><span class="lineno">  564</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_class" href="../../d1/da0/classint.html">y</a> = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a> + hh.<a class="code hl_variable" href="../../de/da6/structo2_1_1gpu_1_1cahit2.html#a7662c97be0c010b54e71ca264671dee3">x</a> * stepY;</div>
<div class="line"><a id="l00565" name="l00565"></a><span class="lineno">  565</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a> = z0 + hh.<a class="code hl_variable" href="../../de/da6/structo2_1_1gpu_1_1cahit2.html#ae4e60a765589202e3bd342b7e94b7005">y</a> * stepZ;</div>
<div class="line"><a id="l00566" name="l00566"></a><span class="lineno">  566</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> dy = <a class="code hl_class" href="../../d1/da0/classint.html">y</a> - uncorrectedY;</div>
<div class="line"><a id="l00567" name="l00567"></a><span class="lineno">  567</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> dz = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a> - uncorrectedZ;</div>
<div class="line"><a id="l00568" name="l00568"></a><span class="lineno">  568</span>      <span class="keywordflow">if</span> (dy * dy * sy21 + dz * dz * sz21 &lt;= CAMath::Sqrt(2.f)) {</div>
<div class="line"><a id="l00569" name="l00569"></a><span class="lineno">  569</span>        <span class="comment">// CADEBUG(printf(&quot;Found Y %f Z %f\n&quot;, y, z));</span></div>
<div class="line"><a id="l00570" name="l00570"></a><span class="lineno">  570</span>        CAMath::AtomicMax(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a6b425be07cfa8ac09043ef8391e7e514">weight</a>, myWeight);</div>
<div class="line"><a id="l00571" name="l00571"></a><span class="lineno">  571</span>      }</div>
<div class="line"><a id="l00572" name="l00572"></a><span class="lineno">  572</span>    }</div>
<div class="line"><a id="l00573" name="l00573"></a><span class="lineno">  573</span>  }</div>
<div class="line"><a id="l00574" name="l00574"></a><span class="lineno">  574</span>  <span class="keywordflow">return</span> uncorrectedY;</div>
<div class="line"><a id="l00575" name="l00575"></a><span class="lineno">  575</span>}</div>
<div class="line"><a id="l00576" name="l00576"></a><span class="lineno">  576</span> </div>
<div class="line"><a id="l00577" name="l00577"></a><span class="lineno">  577</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() bool <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::AttachClustersPropagate(const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() Merger, int32_t sector, int32_t lastRow, int32_t toRow, int32_t iTrack, <span class="keywordtype">bool</span> goodLeg, <a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() prop, <span class="keywordtype">bool</span> inFlyDirection, <span class="keywordtype">float</span> maxSinPhi, <span class="keywordtype">bool</span> dodEdx)</div>
<div class="line"><a id="l00578" name="l00578"></a><span class="lineno">  578</span>{</div>
<div class="line"><a id="l00579" name="l00579"></a><span class="lineno">  579</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> kSectAngle = 2 * M_PI / 18.f;</div>
<div class="line"><a id="l00580" name="l00580"></a><span class="lineno">  580</span>  <span class="keywordflow">if</span> (Merger-&gt;Param().rec.tpc.disableRefitAttachment &amp; 2) {</div>
<div class="line"><a id="l00581" name="l00581"></a><span class="lineno">  581</span>    <span class="keywordflow">return</span> dodEdx;</div>
<div class="line"><a id="l00582" name="l00582"></a><span class="lineno">  582</span>  }</div>
<div class="line"><a id="l00583" name="l00583"></a><span class="lineno">  583</span>  <span class="keywordflow">if</span> (CAMath::Abs(lastRow - toRow) &lt; 2) {</div>
<div class="line"><a id="l00584" name="l00584"></a><span class="lineno">  584</span>    <span class="keywordflow">return</span> dodEdx;</div>
<div class="line"><a id="l00585" name="l00585"></a><span class="lineno">  585</span>  }</div>
<div class="line"><a id="l00586" name="l00586"></a><span class="lineno">  586</span>  int32_t <a class="code hl_variable" href="../../d1/dec/namespaceo2_1_1track.html#a69a68024dfc8f89815f7184ee1d2ac7c">step</a> = toRow &gt; lastRow ? 1 : -1;</div>
<div class="line"><a id="l00587" name="l00587"></a><span class="lineno">  587</span>  <span class="keywordtype">float</span> xx = mX - GPUTPCGeometry::Row2X(lastRow);</div>
<div class="line"><a id="l00588" name="l00588"></a><span class="lineno">  588</span>  <span class="keywordflow">for</span> (int32_t iRow = lastRow + step; iRow != toRow; iRow += <a class="code hl_variable" href="../../d1/dec/namespaceo2_1_1track.html#a69a68024dfc8f89815f7184ee1d2ac7c">step</a>) {</div>
<div class="line"><a id="l00589" name="l00589"></a><span class="lineno">  589</span>    <span class="keywordflow">if</span> (CAMath::Abs(mP[2]) &gt; maxSinPhi) {</div>
<div class="line"><a id="l00590" name="l00590"></a><span class="lineno">  590</span>      <span class="keywordflow">return</span> dodEdx;</div>
<div class="line"><a id="l00591" name="l00591"></a><span class="lineno">  591</span>    }</div>
<div class="line"><a id="l00592" name="l00592"></a><span class="lineno">  592</span>    <span class="keywordflow">if</span> (CAMath::Abs(mP[0]) &gt; CAMath::Abs(mX) * CAMath::Tan(kSectAngle / 2.f)) {</div>
<div class="line"><a id="l00593" name="l00593"></a><span class="lineno">  593</span>      <span class="keywordflow">return</span> dodEdx;</div>
<div class="line"><a id="l00594" name="l00594"></a><span class="lineno">  594</span>    }</div>
<div class="line"><a id="l00595" name="l00595"></a><span class="lineno">  595</span>    int32_t err = prop.PropagateToXAlpha(xx + GPUTPCGeometry::Row2X(iRow), prop.GetAlpha(), inFlyDirection);</div>
<div class="line"><a id="l00596" name="l00596"></a><span class="lineno">  596</span>    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a id="l00597" name="l00597"></a><span class="lineno">  597</span>      <span class="keywordflow">return</span> dodEdx;</div>
<div class="line"><a id="l00598" name="l00598"></a><span class="lineno">  598</span>    }</div>
<div class="line"><a id="l00599" name="l00599"></a><span class="lineno">  599</span>    <span class="keywordflow">if</span> (dodEdx &amp;&amp; iRow + step == toRow) {</div>
<div class="line"><a id="l00600" name="l00600"></a><span class="lineno">  600</span>      <span class="keywordtype">float</span> yUncorrected, zUncorrected;</div>
<div class="line"><a id="l00601" name="l00601"></a><span class="lineno">  601</span>      Merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;InverseTransformYZtoNominalYZ(sector, iRow, mP[0], mP[1], yUncorrected, zUncorrected);</div>
<div class="line"><a id="l00602" name="l00602"></a><span class="lineno">  602</span>      uint32_t pad = CAMath::Float2UIntRn(GPUTPCGeometry::LinearY2Pad(sector, iRow, yUncorrected));</div>
<div class="line"><a id="l00603" name="l00603"></a><span class="lineno">  603</span>      <span class="keywordflow">if</span> (pad &gt;= GPUTPCGeometry::NPads(iRow) || (Merger-&gt;GetConstantMem()-&gt;calibObjects.dEdxCalibContainer &amp;&amp; Merger-&gt;GetConstantMem()-&gt;calibObjects.dEdxCalibContainer-&gt;isDead(sector, iRow, pad))) {</div>
<div class="line"><a id="l00604" name="l00604"></a><span class="lineno">  604</span>        dodEdx = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00605" name="l00605"></a><span class="lineno">  605</span>      }</div>
<div class="line"><a id="l00606" name="l00606"></a><span class="lineno">  606</span>    }</div>
<div class="line"><a id="l00607" name="l00607"></a><span class="lineno">  607</span>    <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;Attaching in row %d\n&quot;</span>, iRow));</div>
<div class="line"><a id="l00608" name="l00608"></a><span class="lineno">  608</span>    AttachClusters(Merger, sector, iRow, iTrack, goodLeg, prop);</div>
<div class="line"><a id="l00609" name="l00609"></a><span class="lineno">  609</span>  }</div>
<div class="line"><a id="l00610" name="l00610"></a><span class="lineno">  610</span>  <span class="keywordflow">return</span> dodEdx;</div>
<div class="line"><a id="l00611" name="l00611"></a><span class="lineno">  611</span>}</div>
<div class="line"><a id="l00612" name="l00612"></a><span class="lineno">  612</span> </div>
<div class="foldopen" id="foldopen00613" data-start="{" data-end="}">
<div class="line"><a id="l00613" name="l00613"></a><span class="lineno"><a class="line" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a2a217a61b4959cd7a68a42295b464db3">  613</a></span><a class="code hl_function" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a2a217a61b4959cd7a68a42295b464db3">GPUdii</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::StoreOuter(gputpcgmmergertypes::GPUTPCOuterParam* outerParam, <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a>)</div>
<div class="line"><a id="l00614" name="l00614"></a><span class="lineno">  614</span>{</div>
<div class="line"><a id="l00615" name="l00615"></a><span class="lineno">  615</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t%21sStorO   Alpha %8.3f    , X %8.3f - Y %8.3f, Z %8.3f   -   QPt %7.2f, SP %5.2f   ---   Cov sY %8.3f sZ %8.3f sSP %8.3f sPt %8.3f\n&quot;</span>, <span class="stringliteral">&quot;&quot;</span>, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a>, mX, mP[0], mP[1], mP[4], mP[2], sqrtf(mC[0]), sqrtf(mC[2]), sqrtf(mC[5]), sqrtf(mC[14])));</div>
<div class="line"><a id="l00616" name="l00616"></a><span class="lineno">  616</span>  <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; 5; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div>
<div class="line"><a id="l00617" name="l00617"></a><span class="lineno">  617</span>    outerParam-&gt;P[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>] = mP[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>];</div>
<div class="line"><a id="l00618" name="l00618"></a><span class="lineno">  618</span>  }</div>
<div class="line"><a id="l00619" name="l00619"></a><span class="lineno">  619</span>  <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; 15; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div>
<div class="line"><a id="l00620" name="l00620"></a><span class="lineno">  620</span>    outerParam-&gt;C[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>] = mC[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>];</div>
<div class="line"><a id="l00621" name="l00621"></a><span class="lineno">  621</span>  }</div>
<div class="line"><a id="l00622" name="l00622"></a><span class="lineno">  622</span>  outerParam-&gt;X = mX;</div>
<div class="line"><a id="l00623" name="l00623"></a><span class="lineno">  623</span>  outerParam-&gt;alpha = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a>;</div>
<div class="line"><a id="l00624" name="l00624"></a><span class="lineno">  624</span>}</div>
</div>
<div class="line"><a id="l00625" name="l00625"></a><span class="lineno">  625</span> </div>
<div class="foldopen" id="foldopen00626" data-start="{" data-end="}">
<div class="line"><a id="l00626" name="l00626"></a><span class="lineno"><a class="line" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#ae0e386c350f6b4205ee6c1252caad8cd">  626</a></span><a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#a5396d17c87ab7dae31cc3eef5519756c">GPUdic</a>(0, 1) <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::StoreLoopPropagation(const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() Merger, int32_t sector, int32_t iRow, int32_t iTrack, <span class="keywordtype">bool</span> outwards, <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a>)</div>
<div class="line"><a id="l00627" name="l00627"></a><span class="lineno">  627</span>{</div>
<div class="line"><a id="l00628" name="l00628"></a><span class="lineno">  628</span>  <span class="keywordflow">if</span> (iRow == 0 || iRow == <a class="code hl_define" href="../../d6/d1b/GPUTPCGeometry_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a> - 1) {</div>
<div class="line"><a id="l00629" name="l00629"></a><span class="lineno">  629</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00630" name="l00630"></a><span class="lineno">  630</span>  }</div>
<div class="line"><a id="l00631" name="l00631"></a><span class="lineno">  631</span>  <span class="keywordflow">if</span> (CAMath::Abs(mP[2]) &gt;= <a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a>) { <span class="comment">// TODO: How can we avoid this?</span></div>
<div class="line"><a id="l00632" name="l00632"></a><span class="lineno">  632</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00633" name="l00633"></a><span class="lineno">  633</span>  }</div>
<div class="line"><a id="l00634" name="l00634"></a><span class="lineno">  634</span>  <span class="keywordflow">if</span> (CAMath::Abs(mP[2]) &lt; 0.75) {</div>
<div class="line"><a id="l00635" name="l00635"></a><span class="lineno">  635</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00636" name="l00636"></a><span class="lineno">  636</span>  }</div>
<div class="line"><a id="l00637" name="l00637"></a><span class="lineno">  637</span>  <span class="keywordflow">if</span> ((mP[2] * mP[4] &lt; 0) ^ outwards) {</div>
<div class="line"><a id="l00638" name="l00638"></a><span class="lineno">  638</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00639" name="l00639"></a><span class="lineno">  639</span>  }</div>
<div class="line"><a id="l00640" name="l00640"></a><span class="lineno">  640</span> </div>
<div class="line"><a id="l00641" name="l00641"></a><span class="lineno">  641</span>  uint32_t nLoopData = CAMath::AtomicAdd(&amp;Merger-&gt;Memory()-&gt;nLoopData, 1u);</div>
<div class="line"><a id="l00642" name="l00642"></a><span class="lineno">  642</span>  <span class="keywordflow">if</span> (nLoopData &gt;= Merger-&gt;NMaxTracks()) {</div>
<div class="line"><a id="l00643" name="l00643"></a><span class="lineno">  643</span>    Merger-&gt;raiseError(GPUErrors::ERROR_MERGER_LOOPER_OVERFLOW, nLoopData, Merger-&gt;NMaxTracks());</div>
<div class="line"><a id="l00644" name="l00644"></a><span class="lineno">  644</span>    CAMath::AtomicExch(&amp;Merger-&gt;Memory()-&gt;nLoopData, Merger-&gt;NMaxTracks());</div>
<div class="line"><a id="l00645" name="l00645"></a><span class="lineno">  645</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00646" name="l00646"></a><span class="lineno">  646</span>  }</div>
<div class="line"><a id="l00647" name="l00647"></a><span class="lineno">  647</span>  <a class="code hl_struct" href="../../d0/d80/structo2_1_1gpu_1_1GPUTPCGMLoopData.html">GPUTPCGMLoopData</a> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>;</div>
<div class="line"><a id="l00648" name="l00648"></a><span class="lineno">  648</span>  <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.<a class="code hl_variable" href="../../d0/d80/structo2_1_1gpu_1_1GPUTPCGMLoopData.html#ad8e84000f469e01ea957301534a6f6ee">param</a> = *<span class="keyword">this</span>;</div>
<div class="line"><a id="l00649" name="l00649"></a><span class="lineno">  649</span>  <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.<a class="code hl_variable" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html#a4ec8a9ba9edbafd5337c1a45bcc605d5">track</a> = iTrack;</div>
<div class="line"><a id="l00650" name="l00650"></a><span class="lineno">  650</span>  <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.alpha = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a>;</div>
<div class="line"><a id="l00651" name="l00651"></a><span class="lineno">  651</span>  <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.<a class="code hl_variable" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#a9bc1cbd64e04968101718859b8a09bf6">sector</a> = sector;</div>
<div class="line"><a id="l00652" name="l00652"></a><span class="lineno">  652</span>  <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.row = iRow;</div>
<div class="line"><a id="l00653" name="l00653"></a><span class="lineno">  653</span>  <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.outwards = outwards;</div>
<div class="line"><a id="l00654" name="l00654"></a><span class="lineno">  654</span>  Merger-&gt;LoopData()[nLoopData] = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>;</div>
<div class="line"><a id="l00655" name="l00655"></a><span class="lineno">  655</span>}</div>
</div>
<div class="line"><a id="l00656" name="l00656"></a><span class="lineno">  656</span> </div>
<div class="line"><a id="l00657" name="l00657"></a><span class="lineno">  657</span><a class="code hl_function" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a2a217a61b4959cd7a68a42295b464db3">GPUdii</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::PropagateLooper(const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() Merger, int32_t loopIdx)</div>
<div class="line"><a id="l00658" name="l00658"></a><span class="lineno">  658</span>{</div>
<div class="line"><a id="l00659" name="l00659"></a><span class="lineno">  659</span>  <a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a> prop;</div>
<div class="line"><a id="l00660" name="l00660"></a><span class="lineno">  660</span>  prop.SetMaterialTPC();</div>
<div class="line"><a id="l00661" name="l00661"></a><span class="lineno">  661</span>  prop.SetPolynomialField(&amp;Merger-&gt;Param().polynomialField);</div>
<div class="line"><a id="l00662" name="l00662"></a><span class="lineno">  662</span>  prop.SetMaxSinPhi(<a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a>);</div>
<div class="line"><a id="l00663" name="l00663"></a><span class="lineno">  663</span>  prop.SetMatLUT(Merger-&gt;Param().rec.useMatLUT ? Merger-&gt;GetConstantMem()-&gt;calibObjects.matLUT : nullptr);</div>
<div class="line"><a id="l00664" name="l00664"></a><span class="lineno">  664</span>  prop.SetSeedingErrors(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00665" name="l00665"></a><span class="lineno">  665</span>  prop.SetFitInProjections(<span class="keyword">true</span>);</div>
<div class="line"><a id="l00666" name="l00666"></a><span class="lineno">  666</span>  prop.SetPropagateBzOnly(<span class="keyword">false</span>);</div>
<div class="line"><a id="l00667" name="l00667"></a><span class="lineno">  667</span> </div>
<div class="line"><a id="l00668" name="l00668"></a><span class="lineno">  668</span>  <a class="code hl_struct" href="../../d0/d80/structo2_1_1gpu_1_1GPUTPCGMLoopData.html">GPUTPCGMLoopData</a>&amp; <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a> = Merger-&gt;LoopData()[loopIdx];</div>
<div class="line"><a id="l00669" name="l00669"></a><span class="lineno">  669</span>  prop.SetTrack(&amp;<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.param, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.alpha);</div>
<div class="line"><a id="l00670" name="l00670"></a><span class="lineno">  670</span>  <span class="keywordflow">if</span> (<span class="keyword">false</span>) {</div>
<div class="line"><a id="l00671" name="l00671"></a><span class="lineno">  671</span>    <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.<a class="code hl_variable" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#a924c00c81b5b0d04f2ac6900cb5ccbbd">param</a>.AttachClustersLooper(Merger, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.sector, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.row, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.track, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.outwards, prop);</div>
<div class="line"><a id="l00672" name="l00672"></a><span class="lineno">  672</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00673" name="l00673"></a><span class="lineno">  673</span>    <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.param.AttachClustersLooperFollow(Merger, prop, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.sector, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.row, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.track, <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a>.outwards);</div>
<div class="line"><a id="l00674" name="l00674"></a><span class="lineno">  674</span>  }</div>
<div class="line"><a id="l00675" name="l00675"></a><span class="lineno">  675</span>}</div>
<div class="line"><a id="l00676" name="l00676"></a><span class="lineno">  676</span> </div>
<div class="foldopen" id="foldopen00677" data-start="{" data-end="}">
<div class="line"><a id="l00677" name="l00677"></a><span class="lineno"><a class="line" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#afaf6640e1384762d4784d39d82fe878e">  677</a></span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a79d71058f2f11e75e5466381d2987c03">GPUdi</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::AttachClustersLooperFollow(const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() Merger, <a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() prop, int32_t sector, int32_t iRow, int32_t iTrack, <span class="keywordtype">bool</span> up)</div>
<div class="line"><a id="l00678" name="l00678"></a><span class="lineno">  678</span>{</div>
<div class="line"><a id="l00679" name="l00679"></a><span class="lineno">  679</span>  <span class="keywordtype">float</span> toX = mX;</div>
<div class="line"><a id="l00680" name="l00680"></a><span class="lineno">  680</span>  <span class="keywordtype">bool</span> inFlyDirection = (Merger-&gt;MergedTracks()[iTrack].Leg() &amp; 1) ^ up;</div>
<div class="line"><a id="l00681" name="l00681"></a><span class="lineno">  681</span> </div>
<div class="line"><a id="l00682" name="l00682"></a><span class="lineno">  682</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> kSectAngle = 2 * M_PI / 18.f;</div>
<div class="line"><a id="l00683" name="l00683"></a><span class="lineno">  683</span>  <span class="keyword">const</span> <a class="code hl_struct" href="../../d3/d65/structo2_1_1gpu_1_1GPUParam.html">GPUParam</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a> = Merger-&gt;Param();</div>
<div class="line"><a id="l00684" name="l00684"></a><span class="lineno">  684</span>  <span class="keywordtype">bool</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a> = (mP[2] &lt; 0) ^ up;</div>
<div class="line"><a id="l00685" name="l00685"></a><span class="lineno">  685</span>  <span class="keyword">const</span> int32_t sectorSide = sector &gt;= (<a class="code hl_define" href="../../d6/d1b/GPUTPCGeometry_8h.html#a7e56ba7234f2f1d3732f5b37d24bb6a0">GPUCA_NSECTORS</a> / 2) ? (<a class="code hl_define" href="../../d6/d1b/GPUTPCGeometry_8h.html#a7e56ba7234f2f1d3732f5b37d24bb6a0">GPUCA_NSECTORS</a> / 2) : 0;</div>
<div class="line"><a id="l00686" name="l00686"></a><span class="lineno">  686</span>  <span class="keywordtype">float</span> lrFactor = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a> ^ !up ? 1.f : -1.f;</div>
<div class="line"><a id="l00687" name="l00687"></a><span class="lineno">  687</span>  <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00688" name="l00688"></a><span class="lineno">  688</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\nCIRCLE Track %d: Sector %d Alpha %f X %f Y %f Z %f SinPhi %f DzDs %f QPt %f - Right %d Up %d lrFactor %f\n&quot;</span>, iTrack, sector, prop.GetAlpha(), mX, mP[0], mP[1], mP[2], mP[3], mP[4], (int32_t)<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a>, (int32_t)up, lrFactor));</div>
<div class="line"><a id="l00689" name="l00689"></a><span class="lineno">  689</span>  <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00690" name="l00690"></a><span class="lineno">  690</span> </div>
<div class="line"><a id="l00691" name="l00691"></a><span class="lineno">  691</span>  <span class="keywordflow">if</span> (prop.RotateToAlpha(prop.GetAlpha() + (CAMath::Pi() / 2.f) * lrFactor)) {</div>
<div class="line"><a id="l00692" name="l00692"></a><span class="lineno">  692</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00693" name="l00693"></a><span class="lineno">  693</span>  }</div>
<div class="line"><a id="l00694" name="l00694"></a><span class="lineno">  694</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\tRotated: X %f Y %f Z %f SinPhi %f (Alpha %f / %f)\n&quot;</span>, mP[0], mX, mP[1], mP[2], prop.GetAlpha(), prop.GetAlpha() + CAMath::Pi() / 2.f));</div>
<div class="line"><a id="l00695" name="l00695"></a><span class="lineno">  695</span>  uint32_t maxTries = 100;</div>
<div class="line"><a id="l00696" name="l00696"></a><span class="lineno">  696</span>  <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div>
<div class="line"><a id="l00697" name="l00697"></a><span class="lineno">  697</span>    <span class="keywordflow">while</span> (CAMath::Abs(mX) &lt;= CAMath::Abs(mP[0]) * CAMath::Tan(kSectAngle / 2.f) + 0.1f) {</div>
<div class="line"><a id="l00698" name="l00698"></a><span class="lineno">  698</span>      <span class="keywordflow">if</span> (maxTries-- == 0) {</div>
<div class="line"><a id="l00699" name="l00699"></a><span class="lineno">  699</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00700" name="l00700"></a><span class="lineno">  700</span>      }</div>
<div class="line"><a id="l00701" name="l00701"></a><span class="lineno">  701</span>      <span class="keywordflow">if</span> (CAMath::Abs(mP[2]) &gt; 0.7f) {</div>
<div class="line"><a id="l00702" name="l00702"></a><span class="lineno">  702</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00703" name="l00703"></a><span class="lineno">  703</span>      }</div>
<div class="line"><a id="l00704" name="l00704"></a><span class="lineno">  704</span>      <span class="keywordflow">if</span> (up ? (-mP[0] * lrFactor &gt; GPUTPCGeometry::Row2X(<a class="code hl_define" href="../../d6/d1b/GPUTPCGeometry_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a> - 1)) : (-mP[0] * lrFactor &lt; GPUTPCGeometry::Row2X(0))) {</div>
<div class="line"><a id="l00705" name="l00705"></a><span class="lineno">  705</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00706" name="l00706"></a><span class="lineno">  706</span>      }</div>
<div class="line"><a id="l00707" name="l00707"></a><span class="lineno">  707</span>      <span class="keywordflow">if</span> (!((up ? (-mP[0] * lrFactor &gt;= toX) : (-mP[0] * lrFactor &lt;= toX)) || (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a> ^ (mP[2] &gt; 0)))) {</div>
<div class="line"><a id="l00708" name="l00708"></a><span class="lineno">  708</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00709" name="l00709"></a><span class="lineno">  709</span>      }</div>
<div class="line"><a id="l00710" name="l00710"></a><span class="lineno">  710</span>      int32_t err = prop.PropagateToXAlpha(mX + (up ? 1.f : -1.f), prop.GetAlpha(), inFlyDirection);</div>
<div class="line"><a id="l00711" name="l00711"></a><span class="lineno">  711</span>      <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a id="l00712" name="l00712"></a><span class="lineno">  712</span>        <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t\tpropagation error (%d)\n&quot;</span>, err));</div>
<div class="line"><a id="l00713" name="l00713"></a><span class="lineno">  713</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00714" name="l00714"></a><span class="lineno">  714</span>      }</div>
<div class="line"><a id="l00715" name="l00715"></a><span class="lineno">  715</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\tPropagated to y = %f: X %f Z %f SinPhi %f\n&quot;</span>, mX, mP[0], mP[1], mP[2]));</div>
<div class="line"><a id="l00716" name="l00716"></a><span class="lineno">  716</span>      <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> = 0; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> &lt; <a class="code hl_define" href="../../d6/d1b/GPUTPCGeometry_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a>; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>++) { <span class="comment">// TODO: Avoid iterating over all rows</span></div>
<div class="line"><a id="l00717" name="l00717"></a><span class="lineno">  717</span>        <span class="keywordtype">float</span> rowX = GPUTPCGeometry::Row2X(<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>);</div>
<div class="line"><a id="l00718" name="l00718"></a><span class="lineno">  718</span>        <span class="keywordflow">if</span> (CAMath::Abs(rowX - (-mP[0] * lrFactor)) &lt; 1.5f) {</div>
<div class="line"><a id="l00719" name="l00719"></a><span class="lineno">  719</span>          <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\t\tAttempt row %d (X %f Y %f Z %f)\n&quot;</span>, <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>, rowX, mX * lrFactor, mP[1]));</div>
<div class="line"><a id="l00720" name="l00720"></a><span class="lineno">  720</span>          AttachClusters(Merger, sector, <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>, iTrack, <span class="keyword">false</span>, mX * lrFactor, mP[1]);</div>
<div class="line"><a id="l00721" name="l00721"></a><span class="lineno">  721</span>        }</div>
<div class="line"><a id="l00722" name="l00722"></a><span class="lineno">  722</span>      }</div>
<div class="line"><a id="l00723" name="l00723"></a><span class="lineno">  723</span>    }</div>
<div class="line"><a id="l00724" name="l00724"></a><span class="lineno">  724</span>    <span class="keywordflow">if</span> (maxTries-- == 0) {</div>
<div class="line"><a id="l00725" name="l00725"></a><span class="lineno">  725</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00726" name="l00726"></a><span class="lineno">  726</span>    }</div>
<div class="line"><a id="l00727" name="l00727"></a><span class="lineno">  727</span>    <span class="keywordflow">if</span> (<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a>) {</div>
<div class="line"><a id="l00728" name="l00728"></a><span class="lineno">  728</span>      <span class="keywordflow">if</span> (++sector &gt;= sectorSide + 18) {</div>
<div class="line"><a id="l00729" name="l00729"></a><span class="lineno">  729</span>        sector -= 18;</div>
<div class="line"><a id="l00730" name="l00730"></a><span class="lineno">  730</span>      }</div>
<div class="line"><a id="l00731" name="l00731"></a><span class="lineno">  731</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00732" name="l00732"></a><span class="lineno">  732</span>      <span class="keywordflow">if</span> (--sector &lt; sectorSide) {</div>
<div class="line"><a id="l00733" name="l00733"></a><span class="lineno">  733</span>        sector += 18;</div>
<div class="line"><a id="l00734" name="l00734"></a><span class="lineno">  734</span>      }</div>
<div class="line"><a id="l00735" name="l00735"></a><span class="lineno">  735</span>    }</div>
<div class="line"><a id="l00736" name="l00736"></a><span class="lineno">  736</span>    <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\tRotating to sector %d: %f --&gt; %f\n&quot;</span>, sector, prop.GetAlpha(), <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.Alpha(sector) + (CAMath::Pi() / 2.f) * lrFactor));</div>
<div class="line"><a id="l00737" name="l00737"></a><span class="lineno">  737</span>    int32_t err = prop.RotateToAlpha(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a>.Alpha(sector) + (CAMath::Pi() / 2.f) * lrFactor);</div>
<div class="line"><a id="l00738" name="l00738"></a><span class="lineno">  738</span>    <span class="keywordflow">if</span> (err) {</div>
<div class="line"><a id="l00739" name="l00739"></a><span class="lineno">  739</span>      <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;Rotation Error %d\n&quot;</span>, err));</div>
<div class="line"><a id="l00740" name="l00740"></a><span class="lineno">  740</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00741" name="l00741"></a><span class="lineno">  741</span>    }</div>
<div class="line"><a id="l00742" name="l00742"></a><span class="lineno">  742</span>    <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;\tAfter Rotating Alpha %f Position X %f Y %f Z %f SinPhi %f\n&quot;</span>, prop.GetAlpha(), mP[0], mX, mP[1], mP[2]));</div>
<div class="line"><a id="l00743" name="l00743"></a><span class="lineno">  743</span>  }</div>
<div class="line"><a id="l00744" name="l00744"></a><span class="lineno">  744</span>}</div>
</div>
<div class="line"><a id="l00745" name="l00745"></a><span class="lineno">  745</span> </div>
<div class="line"><a id="l00746" name="l00746"></a><span class="lineno">  746</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a79d71058f2f11e75e5466381d2987c03">GPUdi</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::AttachClustersLooper(const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() Merger, int32_t sector, int32_t iRow, int32_t iTrack, <span class="keywordtype">bool</span> outwards, <a class="code hl_class" href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">GPUTPCGMPropagator</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() prop)</div>
<div class="line"><a id="l00747" name="l00747"></a><span class="lineno">  747</span>{</div>
<div class="line"><a id="l00748" name="l00748"></a><span class="lineno">  748</span>  <span class="keyword">static</span> <span class="keyword">constexpr</span> <span class="keywordtype">float</span> kSectAngle = 2 * M_PI / 18.f;</div>
<div class="line"><a id="l00749" name="l00749"></a><span class="lineno">  749</span>  <span class="comment">// Note that the coordinate system is rotated by 90 degree swapping X and Y!</span></div>
<div class="line"><a id="l00750" name="l00750"></a><span class="lineno">  750</span>  <span class="keywordtype">float</span> X = mP[2] &gt; 0 ? mP[0] : -mP[0];</div>
<div class="line"><a id="l00751" name="l00751"></a><span class="lineno">  751</span>  <span class="keywordtype">float</span> Y = mP[2] &gt; 0 ? -mX : mX;</div>
<div class="line"><a id="l00752" name="l00752"></a><span class="lineno">  752</span>  <span class="keywordtype">float</span> Z = mP[1];</div>
<div class="line"><a id="l00753" name="l00753"></a><span class="lineno">  753</span>  <span class="keywordtype">float</span> SinPhi = CAMath::Sqrt(1 - mP[2] * mP[2]) * (mP[2] &gt; 0 ? -1 : 1);</div>
<div class="line"><a id="l00754" name="l00754"></a><span class="lineno">  754</span>  <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a> = prop.GetBz(prop.GetAlpha(), mX, mP[0], mP[1]);</div>
<div class="line"><a id="l00755" name="l00755"></a><span class="lineno">  755</span> </div>
<div class="line"><a id="l00756" name="l00756"></a><span class="lineno">  756</span>  <span class="keywordtype">float</span> dx = outwards ? 1.f : -1.f;</div>
<div class="line"><a id="l00757" name="l00757"></a><span class="lineno">  757</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> myRowX = GPUTPCGeometry::Row2X(iRow);</div>
<div class="line"><a id="l00758" name="l00758"></a><span class="lineno">  758</span>  <span class="comment">// printf(&quot;\nAttachMirror sector %d row %d outwards %d\n&quot;, (int)sector, (int)iRow, (int)outwards);</span></div>
<div class="line"><a id="l00759" name="l00759"></a><span class="lineno">  759</span>  <span class="comment">// printf(&quot;X %f Y %f Z %f SinPhi %f --&gt;\n&quot;, mX, mP[0], mP[1], mP[2]);</span></div>
<div class="line"><a id="l00760" name="l00760"></a><span class="lineno">  760</span>  <span class="comment">// printf(&quot;X %f Y %f Z %f SinPhi %f, dx %f\n&quot;, X, Y, Z, SinPhi, dx);</span></div>
<div class="line"><a id="l00761" name="l00761"></a><span class="lineno">  761</span>  uint32_t maxTries = 100;</div>
<div class="line"><a id="l00762" name="l00762"></a><span class="lineno">  762</span>  <span class="keywordflow">while</span> (maxTries--) {</div>
<div class="line"><a id="l00763" name="l00763"></a><span class="lineno">  763</span>    <span class="keywordtype">float</span> ex = CAMath::Sqrt(1 - SinPhi * SinPhi);</div>
<div class="line"><a id="l00764" name="l00764"></a><span class="lineno">  764</span>    <span class="keywordtype">float</span> exi = 1.f / ex;</div>
<div class="line"><a id="l00765" name="l00765"></a><span class="lineno">  765</span>    <span class="keywordtype">float</span> dxBzQ = dx * -<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a> * mP[4];</div>
<div class="line"><a id="l00766" name="l00766"></a><span class="lineno">  766</span>    <span class="keywordtype">float</span> newSinPhi = SinPhi + dxBzQ;</div>
<div class="line"><a id="l00767" name="l00767"></a><span class="lineno">  767</span>    <span class="keywordflow">if</span> (CAMath::Abs(newSinPhi) &gt; <a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aaae686e3a351f7d112899fe6cc41d5aa">GPUCA_MAX_SIN_PHI_LOW</a>) {</div>
<div class="line"><a id="l00768" name="l00768"></a><span class="lineno">  768</span>      <span class="comment">// printf(&quot;Abort, newSinPhi %f\n&quot;, newSinPhi);</span></div>
<div class="line"><a id="l00769" name="l00769"></a><span class="lineno">  769</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00770" name="l00770"></a><span class="lineno">  770</span>    }</div>
<div class="line"><a id="l00771" name="l00771"></a><span class="lineno">  771</span>    <span class="keywordflow">if</span> (mP[2] &gt; 0 ? (newSinPhi &gt; 0.5) : (newSinPhi &lt; -0.5)) {</div>
<div class="line"><a id="l00772" name="l00772"></a><span class="lineno">  772</span>      <span class="comment">// printf(&quot;Finished, newSinPhi %f\n&quot;, newSinPhi);</span></div>
<div class="line"><a id="l00773" name="l00773"></a><span class="lineno">  773</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00774" name="l00774"></a><span class="lineno">  774</span>    }</div>
<div class="line"><a id="l00775" name="l00775"></a><span class="lineno">  775</span>    <span class="keywordtype">float</span> dS = dx * exi;</div>
<div class="line"><a id="l00776" name="l00776"></a><span class="lineno">  776</span>    <span class="keywordtype">float</span> h2 = dS * exi * exi;</div>
<div class="line"><a id="l00777" name="l00777"></a><span class="lineno">  777</span>    <span class="keywordtype">float</span> h4 = .5f * h2 * dxBzQ;</div>
<div class="line"><a id="l00778" name="l00778"></a><span class="lineno">  778</span> </div>
<div class="line"><a id="l00779" name="l00779"></a><span class="lineno">  779</span>    X += dx;</div>
<div class="line"><a id="l00780" name="l00780"></a><span class="lineno">  780</span>    Y += dS * SinPhi + h4;</div>
<div class="line"><a id="l00781" name="l00781"></a><span class="lineno">  781</span>    Z += dS * mP[3];</div>
<div class="line"><a id="l00782" name="l00782"></a><span class="lineno">  782</span>    SinPhi = newSinPhi;</div>
<div class="line"><a id="l00783" name="l00783"></a><span class="lineno">  783</span>    <span class="keywordflow">if</span> (CAMath::Abs(X) &gt; CAMath::Abs(Y) * CAMath::Tan(kSectAngle / 2.f)) {</div>
<div class="line"><a id="l00784" name="l00784"></a><span class="lineno">  784</span>      <span class="comment">// printf(&quot;Abort, sector edge\n&quot;);</span></div>
<div class="line"><a id="l00785" name="l00785"></a><span class="lineno">  785</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00786" name="l00786"></a><span class="lineno">  786</span>    }</div>
<div class="line"><a id="l00787" name="l00787"></a><span class="lineno">  787</span> </div>
<div class="line"><a id="l00788" name="l00788"></a><span class="lineno">  788</span>    <span class="comment">// printf(&quot;count %d: At X %f Y %f Z %f SinPhi %f\n&quot;, maxTries, mP[2] &gt; 0 ? -Y : Y, mP[2] &gt; 0 ? X : -X, Z, SinPhi);</span></div>
<div class="line"><a id="l00789" name="l00789"></a><span class="lineno">  789</span>    <span class="keywordtype">float</span> paramX = mP[2] &gt; 0 ? -Y : Y;</div>
<div class="line"><a id="l00790" name="l00790"></a><span class="lineno">  790</span>    int32_t <a class="code hl_variable" href="../../d1/dec/namespaceo2_1_1track.html#a69a68024dfc8f89815f7184ee1d2ac7c">step</a> = outwards ? 1 : -1;</div>
<div class="line"><a id="l00791" name="l00791"></a><span class="lineno">  791</span>    int32_t found = 0;</div>
<div class="line"><a id="l00792" name="l00792"></a><span class="lineno">  792</span>    <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> = iRow; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> &gt;= 0 &amp;&amp; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> &lt; <a class="code hl_define" href="../../d6/d1b/GPUTPCGeometry_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a> &amp;&amp; found &lt; 3; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> += <a class="code hl_variable" href="../../d1/dec/namespaceo2_1_1track.html#a69a68024dfc8f89815f7184ee1d2ac7c">step</a>) {</div>
<div class="line"><a id="l00793" name="l00793"></a><span class="lineno">  793</span>      <span class="keywordtype">float</span> rowX = mX + GPUTPCGeometry::Row2X(<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>) - myRowX;</div>
<div class="line"><a id="l00794" name="l00794"></a><span class="lineno">  794</span>      <span class="keywordflow">if</span> (CAMath::Abs(rowX - paramX) &lt; 1.5f) {</div>
<div class="line"><a id="l00795" name="l00795"></a><span class="lineno">  795</span>        <span class="comment">// printf(&quot;Attempt row %d at y %f\n&quot;, j, X);</span></div>
<div class="line"><a id="l00796" name="l00796"></a><span class="lineno">  796</span>        AttachClusters(Merger, sector, <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>, iTrack, <span class="keyword">false</span>, mP[2] &gt; 0 ? X : -X, Z);</div>
<div class="line"><a id="l00797" name="l00797"></a><span class="lineno">  797</span>      }</div>
<div class="line"><a id="l00798" name="l00798"></a><span class="lineno">  798</span>    }</div>
<div class="line"><a id="l00799" name="l00799"></a><span class="lineno">  799</span>  }</div>
<div class="line"><a id="l00800" name="l00800"></a><span class="lineno">  800</span>}</div>
<div class="line"><a id="l00801" name="l00801"></a><span class="lineno">  801</span> </div>
<div class="line"><a id="l00802" name="l00802"></a><span class="lineno">  802</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() float <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::ShiftZ(const <a class="code hl_struct" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html">GPUTPCGMMergedTrackHit</a>* <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>, const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* merger, int32_t N)</div>
<div class="line"><a id="l00803" name="l00803"></a><span class="lineno">  803</span>{</div>
<div class="line"><a id="l00804" name="l00804"></a><span class="lineno">  804</span>  <span class="keywordflow">if</span> (N == 0) {</div>
<div class="line"><a id="l00805" name="l00805"></a><span class="lineno">  805</span>    N = 1;</div>
<div class="line"><a id="l00806" name="l00806"></a><span class="lineno">  806</span>  }</div>
<div class="line"><a id="l00807" name="l00807"></a><span class="lineno">  807</span>  <span class="keyword">const</span> <span class="keyword">auto</span>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() cls = merger-&gt;GetConstantMem()-&gt;ioPtrs.clustersNative-&gt;clustersLinear;</div>
<div class="line"><a id="l00808" name="l00808"></a><span class="lineno">  808</span>  <span class="keywordtype">float</span> z0 = cls[<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[0].<a class="code hl_variable" href="../../d2/d12/bench__Clusterizer_8cxx.html#af656038045ce6448240b3767491787da">num</a>].<a class="code hl_function" href="../../d8/d5a/scan-hvlv-ccdb_8cxx.html#a0cab151bc8ea974b059e7604901a7285">getTime</a>(), zn = cls[<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[N - 1].<a class="code hl_variable" href="../../d2/d12/bench__Clusterizer_8cxx.html#af656038045ce6448240b3767491787da">num</a>].<a class="code hl_function" href="../../d8/d5a/scan-hvlv-ccdb_8cxx.html#a0cab151bc8ea974b059e7604901a7285">getTime</a>();</div>
<div class="line"><a id="l00809" name="l00809"></a><span class="lineno">  809</span>  const auto tmp = zn &gt; z0 ? <a class="code hl_namespace" href="../../d8/dcc/namespacestd.html">std</a>::<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a52f38e7d822a46377fde7a02708eedb1">array</a>&lt;<span class="keywordtype">float</span>, 3&gt;{zn, z0, GPUTPCGeometry::Row2X(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[N - 1].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>)} : std::array&lt;float, 3&gt;{z0, zn, GPUTPCGeometry::Row2X(<a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[0].<a class="code hl_variable" href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a>)};</div>
<div class="line"><a id="l00810" name="l00810"></a><span class="lineno">  810</span>  <span class="keywordflow">return</span> ShiftZ(merger, <a class="code hl_variable" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a>[0].sector, tmp[0], tmp[1], tmp[2]);</div>
<div class="line"><a id="l00811" name="l00811"></a><span class="lineno">  811</span>}</div>
<div class="line"><a id="l00812" name="l00812"></a><span class="lineno">  812</span> </div>
<div class="line"><a id="l00813" name="l00813"></a><span class="lineno">  813</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() float <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::ShiftZ(const <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() merger, int32_t sector, <span class="keywordtype">float</span> cltmax, <span class="keywordtype">float</span> cltmin, <span class="keywordtype">float</span> clx)</div>
<div class="line"><a id="l00814" name="l00814"></a><span class="lineno">  814</span>{</div>
<div class="line"><a id="l00815" name="l00815"></a><span class="lineno">  815</span>  <span class="keywordflow">if</span> (!merger-&gt;Param().par.continuousTracking) {</div>
<div class="line"><a id="l00816" name="l00816"></a><span class="lineno">  816</span>    <span class="keywordflow">return</span> 0.f;</div>
<div class="line"><a id="l00817" name="l00817"></a><span class="lineno">  817</span>  }</div>
<div class="line"><a id="l00818" name="l00818"></a><span class="lineno">  818</span>  <span class="keywordtype">float</span> deltaZ = 0.f;</div>
<div class="line"><a id="l00819" name="l00819"></a><span class="lineno">  819</span>  <span class="keywordtype">bool</span> beamlineReached = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00820" name="l00820"></a><span class="lineno">  820</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> r1 = CAMath::Max(0.0001f, CAMath::Abs(mP[4] * merger-&gt;Param().polynomialField.GetNominalBz()));</div>
<div class="line"><a id="l00821" name="l00821"></a><span class="lineno">  821</span>  <span class="keywordflow">if</span> (r1 &lt; 0.01501) { <span class="comment">// 100 MeV @ 0.5T ~ 0.66m cutof</span></div>
<div class="line"><a id="l00822" name="l00822"></a><span class="lineno">  822</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> dist2 = mX * mX + mP[0] * mP[0];</div>
<div class="line"><a id="l00823" name="l00823"></a><span class="lineno">  823</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> dist1r2 = dist2 * r1 * r1;</div>
<div class="line"><a id="l00824" name="l00824"></a><span class="lineno">  824</span>    <span class="keywordflow">if</span> (dist1r2 &lt; 4) {</div>
<div class="line"><a id="l00825" name="l00825"></a><span class="lineno">  825</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a> = CAMath::ACos(1 - 0.5f * dist1r2); <span class="comment">// Angle of a circle, such that |(cosa, sina) - (1,0)| == dist</span></div>
<div class="line"><a id="l00826" name="l00826"></a><span class="lineno">  826</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> beta = CAMath::ATan2(mP[0], mX);</div>
<div class="line"><a id="l00827" name="l00827"></a><span class="lineno">  827</span>      <span class="keyword">const</span> int32_t comp = mP[2] &gt; CAMath::Sin(beta);</div>
<div class="line"><a id="l00828" name="l00828"></a><span class="lineno">  828</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> sinab = CAMath::Sin((comp ? 0.5f : -0.5f) * <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a> + beta); <span class="comment">// Angle of circle through origin and track position, to be compared to Snp</span></div>
<div class="line"><a id="l00829" name="l00829"></a><span class="lineno">  829</span>      <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a97e3bb97951482c8cf4d55a2d0bfcb62">res</a> = CAMath::Abs(sinab - mP[2]);</div>
<div class="line"><a id="l00830" name="l00830"></a><span class="lineno">  830</span> </div>
<div class="line"><a id="l00831" name="l00831"></a><span class="lineno">  831</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a97e3bb97951482c8cf4d55a2d0bfcb62">res</a> &lt; 0.2) {</div>
<div class="line"><a id="l00832" name="l00832"></a><span class="lineno">  832</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a> = 1.f / r1;</div>
<div class="line"><a id="l00833" name="l00833"></a><span class="lineno">  833</span>        <span class="keyword">const</span> <span class="keywordtype">float</span> dS = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a> * <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a>;</div>
<div class="line"><a id="l00834" name="l00834"></a><span class="lineno">  834</span>        <span class="keywordtype">float</span> z0 = dS * mP[3];</div>
<div class="line"><a id="l00835" name="l00835"></a><span class="lineno">  835</span>        <span class="keywordflow">if</span> (CAMath::Abs(z0) &gt; GPUTPCGeometry::TPCLength()) {</div>
<div class="line"><a id="l00836" name="l00836"></a><span class="lineno">  836</span>          z0 = z0 &gt; 0 ? GPUTPCGeometry::TPCLength() : -<a class="code hl_class" href="../../de/d65/classo2_1_1gpu_1_1GPUTPCGeometry.html">GPUTPCGeometry</a>::TPCLength();</div>
<div class="line"><a id="l00837" name="l00837"></a><span class="lineno">  837</span>        }</div>
<div class="line"><a id="l00838" name="l00838"></a><span class="lineno">  838</span>        deltaZ = mP[1] - z0;</div>
<div class="line"><a id="l00839" name="l00839"></a><span class="lineno">  839</span>        beamlineReached = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00840" name="l00840"></a><span class="lineno">  840</span> </div>
<div class="line"><a id="l00841" name="l00841"></a><span class="lineno">  841</span>        <span class="comment">// printf(&quot;X %9.3f Y %9.3f QPt %9.3f R %9.3f --&gt; Alpha %9.3f Snp %9.3f Snab %9.3f Res %9.3f dS %9.3f z0 %9.3f\n&quot;, mX, mP[0], mP[4], r, alpha / 3.1415 * 180, mP[2], sinab, res, dS, z0);</span></div>
<div class="line"><a id="l00842" name="l00842"></a><span class="lineno">  842</span>      }</div>
<div class="line"><a id="l00843" name="l00843"></a><span class="lineno">  843</span>    }</div>
<div class="line"><a id="l00844" name="l00844"></a><span class="lineno">  844</span>  }</div>
<div class="line"><a id="l00845" name="l00845"></a><span class="lineno">  845</span> </div>
<div class="line"><a id="l00846" name="l00846"></a><span class="lineno">  846</span>  <span class="keywordflow">if</span> (!beamlineReached) {</div>
<div class="line"><a id="l00847" name="l00847"></a><span class="lineno">  847</span>    <span class="keywordtype">float</span> refZ = ((sector &lt; <a class="code hl_define" href="../../d6/d1b/GPUTPCGeometry_8h.html#a7e56ba7234f2f1d3732f5b37d24bb6a0">GPUCA_NSECTORS</a> / 2) ? merger-&gt;Param().rec.tpc.defaultZOffsetOverR : -merger-&gt;Param().rec.tpc.defaultZOffsetOverR) * clx;</div>
<div class="line"><a id="l00848" name="l00848"></a><span class="lineno">  848</span>    <span class="keywordtype">float</span> basez;</div>
<div class="line"><a id="l00849" name="l00849"></a><span class="lineno">  849</span>    merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;getCorrMap()-&gt;TransformIdealZ(sector, cltmax, basez, mTOffset);</div>
<div class="line"><a id="l00850" name="l00850"></a><span class="lineno">  850</span>    deltaZ = basez - refZ;</div>
<div class="line"><a id="l00851" name="l00851"></a><span class="lineno">  851</span>  }</div>
<div class="line"><a id="l00852" name="l00852"></a><span class="lineno">  852</span>  {</div>
<div class="line"><a id="l00853" name="l00853"></a><span class="lineno">  853</span>    <span class="keywordtype">float</span> deltaT = merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;getCorrMap()-&gt;convDeltaZtoDeltaTimeInTimeFrame(sector, deltaZ);</div>
<div class="line"><a id="l00854" name="l00854"></a><span class="lineno">  854</span>    mTOffset += deltaT;</div>
<div class="line"><a id="l00855" name="l00855"></a><span class="lineno">  855</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> <a class="code hl_variable" href="../../d1/dec/namespaceo2_1_1track.html#abc036accb16c70a84e9be9b039571e1c">maxT</a> = cltmin - merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;getCorrMap()-&gt;getT0();</div>
<div class="line"><a id="l00856" name="l00856"></a><span class="lineno">  856</span>    <span class="keyword">const</span> <span class="keywordtype">float</span> minT = cltmax - merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;getCorrMap()-&gt;getMaxDriftTime(sector);</div>
<div class="line"><a id="l00857" name="l00857"></a><span class="lineno">  857</span>    <span class="comment">// printf(&quot;T Check: Clusters %f %f, min %f max %f vtx %f\n&quot;, tz1, tz2, minT, maxT, mTOffset);</span></div>
<div class="line"><a id="l00858" name="l00858"></a><span class="lineno">  858</span>    deltaT = 0.f;</div>
<div class="line"><a id="l00859" name="l00859"></a><span class="lineno">  859</span>    <span class="keywordflow">if</span> (mTOffset &lt; minT) {</div>
<div class="line"><a id="l00860" name="l00860"></a><span class="lineno">  860</span>      deltaT = minT - mTOffset;</div>
<div class="line"><a id="l00861" name="l00861"></a><span class="lineno">  861</span>    }</div>
<div class="line"><a id="l00862" name="l00862"></a><span class="lineno">  862</span>    <span class="keywordflow">if</span> (mTOffset + deltaT &gt; maxT) {</div>
<div class="line"><a id="l00863" name="l00863"></a><span class="lineno">  863</span>      deltaT = <a class="code hl_variable" href="../../d1/dec/namespaceo2_1_1track.html#abc036accb16c70a84e9be9b039571e1c">maxT</a> - mTOffset;</div>
<div class="line"><a id="l00864" name="l00864"></a><span class="lineno">  864</span>    }</div>
<div class="line"><a id="l00865" name="l00865"></a><span class="lineno">  865</span>    <span class="keywordflow">if</span> (deltaT != 0.f) {</div>
<div class="line"><a id="l00866" name="l00866"></a><span class="lineno">  866</span>      deltaZ += merger-&gt;GetConstantMem()-&gt;calibObjects.fastTransformHelper-&gt;getCorrMap()-&gt;convDeltaTimeToDeltaZinTimeFrame(sector, deltaT);</div>
<div class="line"><a id="l00867" name="l00867"></a><span class="lineno">  867</span>      <span class="comment">// printf(&quot;Moving clusters to TPC Range: QPt %f, New mTOffset %f, t1 %f, t2 %f, Shift %f in Z: %f to %f --&gt; %f to %f in T\n&quot;, mP[4], mTOffset + deltaT, tz1, tz2, deltaZ, tz2 - mTOffset, tz1 - mTOffset, tz2 - mTOffset - deltaT, tz1 - mTOffset - deltaT);</span></div>
<div class="line"><a id="l00868" name="l00868"></a><span class="lineno">  868</span>      mTOffset += deltaT;</div>
<div class="line"><a id="l00869" name="l00869"></a><span class="lineno">  869</span>    }</div>
<div class="line"><a id="l00870" name="l00870"></a><span class="lineno">  870</span>    mP[1] -= deltaZ;</div>
<div class="line"><a id="l00871" name="l00871"></a><span class="lineno">  871</span>  }</div>
<div class="line"><a id="l00872" name="l00872"></a><span class="lineno">  872</span>  <span class="comment">// printf(&quot;\n&quot;);</span></div>
<div class="line"><a id="l00873" name="l00873"></a><span class="lineno">  873</span>  <span class="keywordflow">return</span> -deltaZ;</div>
<div class="line"><a id="l00874" name="l00874"></a><span class="lineno">  874</span>}</div>
<div class="line"><a id="l00875" name="l00875"></a><span class="lineno">  875</span> </div>
<div class="line"><a id="l00876" name="l00876"></a><span class="lineno">  876</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() bool <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::CheckCov()<span class="keyword"> const</span></div>
<div class="line"><a id="l00877" name="l00877"></a><span class="lineno">  877</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00878" name="l00878"></a><span class="lineno">  878</span>  <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a> = mC;</div>
<div class="line"><a id="l00879" name="l00879"></a><span class="lineno">  879</span>  <span class="keywordtype">bool</span> ok = <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[0] &gt;= 0 &amp;&amp; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[2] &gt;= 0 &amp;&amp; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[5] &gt;= 0 &amp;&amp; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[9] &gt;= 0 &amp;&amp; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[14] &gt;= 0 &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[1] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[1] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[2] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[0]) &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[3] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[3] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[5] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[0]) &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[4] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[4] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[5] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[2]) &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[6] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[6] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[9] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[0]) &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[7] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[7] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[9] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[2]) &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[8] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[8] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[9] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[5]) &amp;&amp;</div>
<div class="line"><a id="l00880" name="l00880"></a><span class="lineno">  880</span>            (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[10] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[10] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[14] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[0]) &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[11] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[11] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[14] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[2]) &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[12] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[12] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[14] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[5]) &amp;&amp; (<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[13] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[13] &lt;= <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[14] * <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[9]);</div>
<div class="line"><a id="l00881" name="l00881"></a><span class="lineno">  881</span>  <span class="keywordflow">return</span> ok;</div>
<div class="line"><a id="l00882" name="l00882"></a><span class="lineno">  882</span>}</div>
<div class="line"><a id="l00883" name="l00883"></a><span class="lineno">  883</span> </div>
<div class="line"><a id="l00884" name="l00884"></a><span class="lineno">  884</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() bool <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::CheckNumericalQuality(<span class="keywordtype">float</span> overrideCovYY)<span class="keyword"> const</span></div>
<div class="line"><a id="l00885" name="l00885"></a><span class="lineno">  885</span><span class="keyword"></span>{</div>
<div class="line"><a id="l00886" name="l00886"></a><span class="lineno">  886</span>  <span class="comment">//* Check that the track parameters and covariance matrix are reasonable</span></div>
<div class="line"><a id="l00887" name="l00887"></a><span class="lineno">  887</span>  <span class="keywordtype">bool</span> ok = CAMath::Finite(mX) &amp;&amp; CAMath::Finite(mChi2);</div>
<div class="line"><a id="l00888" name="l00888"></a><span class="lineno">  888</span>  <span class="comment">// CADEBUG(printf(&quot;OK %d - %f - &quot;, (int32_t)ok, mX); for (int32_t i = 0; i &lt; 5; i++) { printf(&quot;%f &quot;, mP[i]); } printf(&quot; - &quot;); for (int32_t i = 0; i &lt; 15; i++) { printf(&quot;%f &quot;, mC[i]); } printf(&quot;\n&quot;));</span></div>
<div class="line"><a id="l00889" name="l00889"></a><span class="lineno">  889</span>  <span class="keyword">const</span> <span class="keywordtype">float</span>* <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a> = mC;</div>
<div class="line"><a id="l00890" name="l00890"></a><span class="lineno">  890</span>  <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; 15; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div>
<div class="line"><a id="l00891" name="l00891"></a><span class="lineno">  891</span>    ok = ok &amp;&amp; CAMath::Finite(<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>]);</div>
<div class="line"><a id="l00892" name="l00892"></a><span class="lineno">  892</span>  }</div>
<div class="line"><a id="l00893" name="l00893"></a><span class="lineno">  893</span>  <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; 5; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div>
<div class="line"><a id="l00894" name="l00894"></a><span class="lineno">  894</span>    ok = ok &amp;&amp; CAMath::Finite(mP[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>]);</div>
<div class="line"><a id="l00895" name="l00895"></a><span class="lineno">  895</span>  }</div>
<div class="line"><a id="l00896" name="l00896"></a><span class="lineno">  896</span>  <span class="keywordflow">if</span> ((overrideCovYY &gt; 0 ? overrideCovYY : <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[0]) &gt; 4.f * 4.f || <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[2] &gt; 4.f * 4.f || <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[5] &gt; 2.f * 2.f || <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a>[9] &gt; 2.f * 2.f) {</div>
<div class="line"><a id="l00897" name="l00897"></a><span class="lineno">  897</span>    ok = 0;</div>
<div class="line"><a id="l00898" name="l00898"></a><span class="lineno">  898</span>  }</div>
<div class="line"><a id="l00899" name="l00899"></a><span class="lineno">  899</span>  <span class="keywordflow">if</span> (CAMath::Abs(mP[2]) &gt; <a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a>) {</div>
<div class="line"><a id="l00900" name="l00900"></a><span class="lineno">  900</span>    ok = 0;</div>
<div class="line"><a id="l00901" name="l00901"></a><span class="lineno">  901</span>  }</div>
<div class="line"><a id="l00902" name="l00902"></a><span class="lineno">  902</span>  <span class="keywordflow">if</span> (!CheckCov()) {</div>
<div class="line"><a id="l00903" name="l00903"></a><span class="lineno">  903</span>    ok = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00904" name="l00904"></a><span class="lineno">  904</span>  }</div>
<div class="line"><a id="l00905" name="l00905"></a><span class="lineno">  905</span>  <span class="keywordflow">return</span> ok;</div>
<div class="line"><a id="l00906" name="l00906"></a><span class="lineno">  906</span>}</div>
<div class="line"><a id="l00907" name="l00907"></a><span class="lineno">  907</span> </div>
<div class="line"><a id="l00908" name="l00908"></a><span class="lineno">  908</span><a class="code hl_function" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a2a217a61b4959cd7a68a42295b464db3">GPUdii</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::RefitTrack(<a class="code hl_class" href="../../d2/d6d/classo2_1_1gpu_1_1GPUTPCGMMergedTrack.html">GPUTPCGMMergedTrack</a>&amp; <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() track, int32_t iTrk, <a class="code hl_class" href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">GPUTPCGMMerger</a>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() merger, int32_t attempt) <span class="comment">// VS: GPUd changed to GPUdii. No change in output and no performance penalty.</span></div>
<div class="line"><a id="l00909" name="l00909"></a><span class="lineno">  909</span>{</div>
<div class="line"><a id="l00910" name="l00910"></a><span class="lineno">  910</span>  <span class="keywordflow">if</span> (!track.OK()) {</div>
<div class="line"><a id="l00911" name="l00911"></a><span class="lineno">  911</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00912" name="l00912"></a><span class="lineno">  912</span>  }</div>
<div class="line"><a id="l00913" name="l00913"></a><span class="lineno">  913</span> </div>
<div class="line"><a id="l00914" name="l00914"></a><span class="lineno">  914</span>  <span class="comment">// clang-format off</span></div>
<div class="line"><a id="l00915" name="l00915"></a><span class="lineno">  915</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(<span class="keywordflow">if</span> (<a class="code hl_define" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#aaecaa774d0bdc22367f43a2476f5bd9c">DEBUG_SINGLE_TRACK</a> != -1 &amp;&amp; iTrk != ((<a class="code hl_define" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#aaecaa774d0bdc22367f43a2476f5bd9c">DEBUG_SINGLE_TRACK</a> == -2 &amp;&amp; getenv(<span class="stringliteral">&quot;DEBUG_TRACK&quot;</span>)) ? atoi(getenv(<span class="stringliteral">&quot;DEBUG_TRACK&quot;</span>)) :  <a class="code hl_define" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#aaecaa774d0bdc22367f43a2476f5bd9c">DEBUG_SINGLE_TRACK</a>)) { track.SetNClusters(0); track.SetOK(0); <span class="keywordflow">return</span>; } );</div>
<div class="line"><a id="l00916" name="l00916"></a><span class="lineno">  916</span>  <span class="comment">// clang-format on</span></div>
<div class="line"><a id="l00917" name="l00917"></a><span class="lineno">  917</span> </div>
<div class="line"><a id="l00918" name="l00918"></a><span class="lineno">  918</span>  int32_t nTrackHits = track.NClusters();</div>
<div class="line"><a id="l00919" name="l00919"></a><span class="lineno">  919</span>  int32_t NTolerated = 0; <span class="comment">// Clusters not fit but tollerated for track length cut</span></div>
<div class="line"><a id="l00920" name="l00920"></a><span class="lineno">  920</span>  <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a> t = track.Param();</div>
<div class="line"><a id="l00921" name="l00921"></a><span class="lineno">  921</span>  <span class="keywordtype">float</span> Alpha = track.<a class="code hl_variable" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html#a4858a189d643e34a8010cedc5b11ec0e">Alpha</a>();</div>
<div class="line"><a id="l00922" name="l00922"></a><span class="lineno">  922</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(int32_t nTrackHitsOld = nTrackHits; <span class="keywordtype">float</span> ptOld = t.QPt());</div>
<div class="line"><a id="l00923" name="l00923"></a><span class="lineno">  923</span>  <span class="keywordtype">bool</span> ok = t.Fit(merger, iTrk, merger-&gt;Clusters() + track.FirstClusterRef(), nTrackHits, NTolerated, Alpha, attempt, <a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a>, track);</div>
<div class="line"><a id="l00924" name="l00924"></a><span class="lineno">  924</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;Finished Fit Track %d\n&quot;</span>, iTrk));</div>
<div class="line"><a id="l00925" name="l00925"></a><span class="lineno">  925</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;OUTPUT hits %d -&gt; %d+%d = %d, QPt %f -&gt; %f, SP %f, OK %d chi2 %f chi2ndf %f\n&quot;</span>, nTrackHitsOld, nTrackHits, NTolerated, nTrackHits + NTolerated, ptOld, t.QPt(), t.SinPhi(), (int32_t)ok, t.Chi2(), t.Chi2() / CAMath::Max(1, nTrackHits)));</div>
<div class="line"><a id="l00926" name="l00926"></a><span class="lineno">  926</span> </div>
<div class="line"><a id="l00927" name="l00927"></a><span class="lineno">  927</span>  <span class="keywordflow">if</span> (!ok &amp;&amp; attempt == 0 &amp;&amp; merger-&gt;Param().rec.tpc.retryRefit) {</div>
<div class="line"><a id="l00928" name="l00928"></a><span class="lineno">  928</span>    <span class="keywordflow">for</span> (uint32_t <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; track.NClusters(); <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div>
<div class="line"><a id="l00929" name="l00929"></a><span class="lineno">  929</span>      merger-&gt;Clusters()[track.FirstClusterRef() + <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>].state &amp;= <a class="code hl_enumvalue" href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067a0ece7324ecc58c2cc671cd09a65e80c7">GPUTPCGMMergedTrackHit::clustererAndSharedFlags</a>;</div>
<div class="line"><a id="l00930" name="l00930"></a><span class="lineno">  930</span>    }</div>
<div class="line"><a id="l00931" name="l00931"></a><span class="lineno">  931</span>    <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(printf(<span class="stringliteral">&quot;Track rejected, marking for retry\n&quot;</span>));</div>
<div class="line"><a id="l00932" name="l00932"></a><span class="lineno">  932</span>    <span class="keywordflow">if</span> (merger-&gt;Param().rec.tpc.retryRefit == 2) {</div>
<div class="line"><a id="l00933" name="l00933"></a><span class="lineno">  933</span>      nTrackHits = track.NClusters();</div>
<div class="line"><a id="l00934" name="l00934"></a><span class="lineno">  934</span>      NTolerated = 0; <span class="comment">// Clusters not fit but tollerated for track length cut</span></div>
<div class="line"><a id="l00935" name="l00935"></a><span class="lineno">  935</span>      t = track.Param();</div>
<div class="line"><a id="l00936" name="l00936"></a><span class="lineno">  936</span>      Alpha = track.<a class="code hl_variable" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html#a4858a189d643e34a8010cedc5b11ec0e">Alpha</a>();</div>
<div class="line"><a id="l00937" name="l00937"></a><span class="lineno">  937</span>      ok = t.Fit(merger, iTrk, merger-&gt;Clusters() + track.FirstClusterRef(), nTrackHits, NTolerated, Alpha, 1, <a class="code hl_define" href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a>, track);</div>
<div class="line"><a id="l00938" name="l00938"></a><span class="lineno">  938</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00939" name="l00939"></a><span class="lineno">  939</span>      uint32_t nRefit = CAMath::AtomicAdd(&amp;merger-&gt;Memory()-&gt;nRetryRefit, 1u);</div>
<div class="line"><a id="l00940" name="l00940"></a><span class="lineno">  940</span>      merger-&gt;RetryRefitIds()[nRefit] = iTrk;</div>
<div class="line"><a id="l00941" name="l00941"></a><span class="lineno">  941</span>      <span class="keywordflow">return</span>;</div>
<div class="line"><a id="l00942" name="l00942"></a><span class="lineno">  942</span>    }</div>
<div class="line"><a id="l00943" name="l00943"></a><span class="lineno">  943</span>  }</div>
<div class="line"><a id="l00944" name="l00944"></a><span class="lineno">  944</span>  <span class="keywordflow">if</span> (CAMath::Abs(t.QPt()) &lt; 1.e-4f) {</div>
<div class="line"><a id="l00945" name="l00945"></a><span class="lineno">  945</span>    t.QPt() = 1.e-4f;</div>
<div class="line"><a id="l00946" name="l00946"></a><span class="lineno">  946</span>  }</div>
<div class="line"><a id="l00947" name="l00947"></a><span class="lineno">  947</span> </div>
<div class="line"><a id="l00948" name="l00948"></a><span class="lineno">  948</span>  <a class="code hl_define" href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a>(<span class="keywordflow">if</span> (t.GetX() &gt; 250) { printf(<span class="stringliteral">&quot;ERROR, Track %d at impossible X %f, Pt %f, Looper %d\n&quot;</span>, iTrk, t.GetX(), CAMath::Abs(1.f / t.QPt()), (int32_t)merger-&gt;MergedTracks()[iTrk].Looper()); });</div>
<div class="line"><a id="l00949" name="l00949"></a><span class="lineno">  949</span> </div>
<div class="line"><a id="l00950" name="l00950"></a><span class="lineno">  950</span>  track.SetOK(ok);</div>
<div class="line"><a id="l00951" name="l00951"></a><span class="lineno">  951</span>  track.SetNClustersFitted(nTrackHits);</div>
<div class="line"><a id="l00952" name="l00952"></a><span class="lineno">  952</span>  track.Param() = t;</div>
<div class="line"><a id="l00953" name="l00953"></a><span class="lineno">  953</span>  track.<a class="code hl_variable" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html#a4858a189d643e34a8010cedc5b11ec0e">Alpha</a>() = Alpha;</div>
<div class="line"><a id="l00954" name="l00954"></a><span class="lineno">  954</span> </div>
<div class="line"><a id="l00955" name="l00955"></a><span class="lineno">  955</span>  <span class="comment">// if (track.OK()) merger-&gt;DebugRefitMergedTrack(track);</span></div>
<div class="line"><a id="l00956" name="l00956"></a><span class="lineno">  956</span>}</div>
<div class="line"><a id="l00957" name="l00957"></a><span class="lineno">  957</span> </div>
<div class="line"><a id="l00958" name="l00958"></a><span class="lineno">  958</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::Rotate(<span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a>)</div>
<div class="line"><a id="l00959" name="l00959"></a><span class="lineno">  959</span>{</div>
<div class="line"><a id="l00960" name="l00960"></a><span class="lineno">  960</span>  <span class="keywordtype">float</span> cA, sA;</div>
<div class="line"><a id="l00961" name="l00961"></a><span class="lineno">  961</span>  CAMath::SinCos(<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a>, sA, cA);</div>
<div class="line"><a id="l00962" name="l00962"></a><span class="lineno">  962</span>  <span class="keywordtype">float</span> <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> = mX;</div>
<div class="line"><a id="l00963" name="l00963"></a><span class="lineno">  963</span>  <span class="keywordtype">float</span> sinPhi0 = mP[2], cosPhi0 = CAMath::Sqrt(1 - mP[2] * mP[2]);</div>
<div class="line"><a id="l00964" name="l00964"></a><span class="lineno">  964</span>  <span class="keywordtype">float</span> cosPhi = cosPhi0 * cA + sinPhi0 * sA;</div>
<div class="line"><a id="l00965" name="l00965"></a><span class="lineno">  965</span>  <span class="keywordtype">float</span> sinPhi = -cosPhi0 * sA + sinPhi0 * cA;</div>
<div class="line"><a id="l00966" name="l00966"></a><span class="lineno">  966</span>  <span class="keywordtype">float</span> j0 = cosPhi0 / cosPhi;</div>
<div class="line"><a id="l00967" name="l00967"></a><span class="lineno">  967</span>  <span class="keywordtype">float</span> j2 = cosPhi / cosPhi0;</div>
<div class="line"><a id="l00968" name="l00968"></a><span class="lineno">  968</span>  mX = <a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> * cA + mP[0] * sA;</div>
<div class="line"><a id="l00969" name="l00969"></a><span class="lineno">  969</span>  mP[0] = -<a class="code hl_typedef" href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a> * sA + mP[0] * cA;</div>
<div class="line"><a id="l00970" name="l00970"></a><span class="lineno">  970</span>  mP[2] = sinPhi;</div>
<div class="line"><a id="l00971" name="l00971"></a><span class="lineno">  971</span>  mC[0] *= j0 * j0;</div>
<div class="line"><a id="l00972" name="l00972"></a><span class="lineno">  972</span>  mC[1] *= j0;</div>
<div class="line"><a id="l00973" name="l00973"></a><span class="lineno">  973</span>  mC[3] *= j0;</div>
<div class="line"><a id="l00974" name="l00974"></a><span class="lineno">  974</span>  mC[6] *= j0;</div>
<div class="line"><a id="l00975" name="l00975"></a><span class="lineno">  975</span>  mC[10] *= j0;</div>
<div class="line"><a id="l00976" name="l00976"></a><span class="lineno">  976</span> </div>
<div class="line"><a id="l00977" name="l00977"></a><span class="lineno">  977</span>  mC[3] *= j2;</div>
<div class="line"><a id="l00978" name="l00978"></a><span class="lineno">  978</span>  mC[4] *= j2;</div>
<div class="line"><a id="l00979" name="l00979"></a><span class="lineno">  979</span>  mC[5] *= j2 * j2;</div>
<div class="line"><a id="l00980" name="l00980"></a><span class="lineno">  980</span>  mC[8] *= j2;</div>
<div class="line"><a id="l00981" name="l00981"></a><span class="lineno">  981</span>  mC[12] *= j2;</div>
<div class="line"><a id="l00982" name="l00982"></a><span class="lineno">  982</span>  <span class="keywordflow">if</span> (cosPhi &lt; 0) { <span class="comment">// change direction ( t0 direction is already changed in t0.UpdateValues(); )</span></div>
<div class="line"><a id="l00983" name="l00983"></a><span class="lineno">  983</span>    SinPhi() = -SinPhi();</div>
<div class="line"><a id="l00984" name="l00984"></a><span class="lineno">  984</span>    DzDs() = -DzDs();</div>
<div class="line"><a id="l00985" name="l00985"></a><span class="lineno">  985</span>    QPt() = -QPt();</div>
<div class="line"><a id="l00986" name="l00986"></a><span class="lineno">  986</span>    mC[3] = -mC[3];</div>
<div class="line"><a id="l00987" name="l00987"></a><span class="lineno">  987</span>    mC[4] = -mC[4];</div>
<div class="line"><a id="l00988" name="l00988"></a><span class="lineno">  988</span>    mC[6] = -mC[6];</div>
<div class="line"><a id="l00989" name="l00989"></a><span class="lineno">  989</span>    mC[7] = -mC[7];</div>
<div class="line"><a id="l00990" name="l00990"></a><span class="lineno">  990</span>    mC[10] = -mC[10];</div>
<div class="line"><a id="l00991" name="l00991"></a><span class="lineno">  991</span>    mC[11] = -mC[11];</div>
<div class="line"><a id="l00992" name="l00992"></a><span class="lineno">  992</span>  }</div>
<div class="line"><a id="l00993" name="l00993"></a><span class="lineno">  993</span>}</div>
<div class="line"><a id="l00994" name="l00994"></a><span class="lineno">  994</span> </div>
<div class="line"><a id="l00995" name="l00995"></a><span class="lineno">  995</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::AddCovDiagErrors(const <span class="keywordtype">float</span>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() errors2)</div>
<div class="line"><a id="l00996" name="l00996"></a><span class="lineno">  996</span>{</div>
<div class="line"><a id="l00997" name="l00997"></a><span class="lineno">  997</span>  mC[0] += errors2[0];</div>
<div class="line"><a id="l00998" name="l00998"></a><span class="lineno">  998</span>  mC[2] += errors2[1];</div>
<div class="line"><a id="l00999" name="l00999"></a><span class="lineno">  999</span>  mC[5] += errors2[2];</div>
<div class="line"><a id="l01000" name="l01000"></a><span class="lineno"> 1000</span>  mC[9] += errors2[3];</div>
<div class="line"><a id="l01001" name="l01001"></a><span class="lineno"> 1001</span>  mC[14] += errors2[4];</div>
<div class="line"><a id="l01002" name="l01002"></a><span class="lineno"> 1002</span>}</div>
<div class="line"><a id="l01003" name="l01003"></a><span class="lineno"> 1003</span> </div>
<div class="line"><a id="l01004" name="l01004"></a><span class="lineno"> 1004</span><a class="code hl_function" href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">GPUd</a>() <a class="code hl_function" href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a> <a class="code hl_class" href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">GPUTPCGMTrackParam</a>::AddCovDiagErrorsWithCorrelations(const <span class="keywordtype">float</span>* <a class="code hl_define" href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a>() errors2)</div>
<div class="line"><a id="l01005" name="l01005"></a><span class="lineno"> 1005</span>{</div>
<div class="line"><a id="l01006" name="l01006"></a><span class="lineno"> 1006</span>  <span class="keyword">const</span> int32_t diagMap[5] = {0, 2, 5, 9, 14};</div>
<div class="line"><a id="l01007" name="l01007"></a><span class="lineno"> 1007</span>  <span class="keyword">const</span> <span class="keywordtype">float</span> oldDiag[5] = {mC[0], mC[2], mC[5], mC[9], mC[14]};</div>
<div class="line"><a id="l01008" name="l01008"></a><span class="lineno"> 1008</span>  <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> = 0; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> &lt; 5; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>++) {</div>
<div class="line"><a id="l01009" name="l01009"></a><span class="lineno"> 1009</span>    mC[diagMap[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>]] += errors2[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>];</div>
<div class="line"><a id="l01010" name="l01010"></a><span class="lineno"> 1010</span>    <span class="keywordflow">for</span> (int32_t <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> = 0; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> &lt; <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>; <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>++) {</div>
<div class="line"><a id="l01011" name="l01011"></a><span class="lineno"> 1011</span>      mC[diagMap[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a> - 1] + <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a> + 1] *= gpu::CAMath::Sqrt(mC[diagMap[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>]] * mC[diagMap[<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>]] / (oldDiag[<a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>] * oldDiag[<a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>]));</div>
<div class="line"><a id="l01012" name="l01012"></a><span class="lineno"> 1012</span>    }</div>
<div class="line"><a id="l01013" name="l01013"></a><span class="lineno"> 1013</span>  }</div>
<div class="line"><a id="l01014" name="l01014"></a><span class="lineno"> 1014</span>}</div>
<div class="ttc" id="aAliHLTTPCClusterMCData_8h_html"><div class="ttname"><a href="../../d8/dbb/AliHLTTPCClusterMCData_8h.html">AliHLTTPCClusterMCData.h</a></div></div>
<div class="ttc" id="aBenchCathodeSegmentation_8cxx_html_a7ff4fc3bbf305206c6f2b97d4e6681a0"><div class="ttname"><a href="../../d8/df7/BenchCathodeSegmentation_8cxx.html#a7ff4fc3bbf305206c6f2b97d4e6681a0">state</a></div><div class="ttdeci">benchmark::State &amp; state</div><div class="ttdef"><b>Definition</b> <a href="../../d8/df7/BenchCathodeSegmentation_8cxx_source.html#l00057">BenchCathodeSegmentation.cxx:58</a></div></div>
<div class="ttc" id="aCorrectionMapsHelper_8h_html"><div class="ttname"><a href="../../de/ddd/CorrectionMapsHelper_8h.html">CorrectionMapsHelper.h</a></div><div class="ttdoc">Helper class to access correction maps.</div></div>
<div class="ttc" id="aFIT_2common_2include_2DataFormatsFIT_2RawEventData_8h_html_ada647bc214b6ea2c35e94324a030afea"><div class="ttname"><a href="../../d6/d77/FIT_2common_2include_2DataFormatsFIT_2RawEventData_8h.html#ada647bc214b6ea2c35e94324a030afea">time</a></div><div class="ttdeci">int16_t time</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d77/FIT_2common_2include_2DataFormatsFIT_2RawEventData_8h_source.html#l00004">RawEventData.h:4</a></div></div>
<div class="ttc" id="aGPUCommonAlgorithm_8h_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00435">GPUCommonAlgorithm.h:436</a></div></div>
<div class="ttc" id="aGPUCommonDefAPI_8h_html_a5396d17c87ab7dae31cc3eef5519756c"><div class="ttname"><a href="../../da/d5a/GPUCommonDefAPI_8h.html#a5396d17c87ab7dae31cc3eef5519756c">GPUdic</a></div><div class="ttdeci">#define GPUdic(...)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d5a/GPUCommonDefAPI_8h_source.html#l00188">GPUCommonDefAPI.h:188</a></div></div>
<div class="ttc" id="aGPUCommonDefAPI_8h_html_a8dba65216e16495290e788a7006ddedf"><div class="ttname"><a href="../../da/d5a/GPUCommonDefAPI_8h.html#a8dba65216e16495290e788a7006ddedf">GPUAtomic</a></div><div class="ttdeci">#define GPUAtomic(type)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d5a/GPUCommonDefAPI_8h_source.html#l00055">GPUCommonDefAPI.h:55</a></div></div>
<div class="ttc" id="aGPUCommonDefAPI_8h_html_ac23bf29d429046b4c46c45fca80b546e"><div class="ttname"><a href="../../da/d5a/GPUCommonDefAPI_8h.html#ac23bf29d429046b4c46c45fca80b546e">GPUrestrict</a></div><div class="ttdeci">#define GPUrestrict()</div><div class="ttdef"><b>Definition</b> <a href="../../da/d5a/GPUCommonDefAPI_8h_source.html#l00212">GPUCommonDefAPI.h:212</a></div></div>
<div class="ttc" id="aGPUCommonDefAPI_8h_html_ae132b4bad18d9e67004fbebb0a60dc3a"><div class="ttname"><a href="../../da/d5a/GPUCommonDefAPI_8h.html#ae132b4bad18d9e67004fbebb0a60dc3a">GPUglobalref</a></div><div class="ttdeci">#define GPUglobalref()</div><div class="ttdef"><b>Definition</b> <a href="../../da/d5a/GPUCommonDefAPI_8h_source.html#l00057">GPUCommonDefAPI.h:57</a></div></div>
<div class="ttc" id="aGPUCommonDef_8h_html_a0117e1486062f932ded994de0d587344"><div class="ttname"><a href="../../df/d21/GPUCommonDef_8h.html#a0117e1486062f932ded994de0d587344">GPUCA_DEBUG_STREAMER_CHECK</a></div><div class="ttdeci">#define GPUCA_DEBUG_STREAMER_CHECK(...)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d21/GPUCommonDef_8h_source.html#l00068">GPUCommonDef.h:68</a></div></div>
<div class="ttc" id="aGPUCommonDef_8h_html_a0a7cfdbdb72983acb92fcae8a795f6ae"><div class="ttname"><a href="../../df/d21/GPUCommonDef_8h.html#a0a7cfdbdb72983acb92fcae8a795f6ae">GPUCA_RTC_CONSTEXPR</a></div><div class="ttdeci">#define GPUCA_RTC_CONSTEXPR</div><div class="ttdef"><b>Definition</b> <a href="../../df/d21/GPUCommonDef_8h_source.html#l00076">GPUCommonDef.h:76</a></div></div>
<div class="ttc" id="aGPUConstantMem_8h_html"><div class="ttname"><a href="../../db/df8/GPUConstantMem_8h.html">GPUConstantMem.h</a></div></div>
<div class="ttc" id="aGPUDefConstantsAndSettings_8h_html_aaae686e3a351f7d112899fe6cc41d5aa"><div class="ttname"><a href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aaae686e3a351f7d112899fe6cc41d5aa">GPUCA_MAX_SIN_PHI_LOW</a></div><div class="ttdeci">#define GPUCA_MAX_SIN_PHI_LOW</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d37/GPUDefConstantsAndSettings_8h_source.html#l00039">GPUDefConstantsAndSettings.h:39</a></div></div>
<div class="ttc" id="aGPUDefConstantsAndSettings_8h_html_ac90e54cf02271e7853b27433a7bfc483"><div class="ttname"><a href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#ac90e54cf02271e7853b27433a7bfc483">GPUCA_TRACKLET_SELECTOR_MIN_HITS_B5</a></div><div class="ttdeci">#define GPUCA_TRACKLET_SELECTOR_MIN_HITS_B5(QPTB5)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d37/GPUDefConstantsAndSettings_8h_source.html#l00033">GPUDefConstantsAndSettings.h:33</a></div></div>
<div class="ttc" id="aGPUDefConstantsAndSettings_8h_html_aedc77e1cb7b30e9a388720ee3493c36c"><div class="ttname"><a href="../../d2/d37/GPUDefConstantsAndSettings_8h.html#aedc77e1cb7b30e9a388720ee3493c36c">GPUCA_MAX_SIN_PHI</a></div><div class="ttdeci">#define GPUCA_MAX_SIN_PHI</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d37/GPUDefConstantsAndSettings_8h_source.html#l00040">GPUDefConstantsAndSettings.h:40</a></div></div>
<div class="ttc" id="aGPUDefParametersWrapper_8h_html_aa65b3e2dc2fd9426a5f3f4d57622e31c"><div class="ttname"><a href="../../d6/d27/GPUDefParametersWrapper_8h.html#aa65b3e2dc2fd9426a5f3f4d57622e31c">GPUCA_PAR_MERGER_INTERPOLATION_ERROR_TYPE_A</a></div><div class="ttdeci">#define GPUCA_PAR_MERGER_INTERPOLATION_ERROR_TYPE_A</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d27/GPUDefParametersWrapper_8h_source.html#l00039">GPUDefParametersWrapper.h:39</a></div></div>
<div class="ttc" id="aGPUDef_8h_html_a4cb201a2d832d3a214bbf10757d042c0"><div class="ttname"><a href="../../d2/d6d/GPUDef_8h.html#a4cb201a2d832d3a214bbf10757d042c0">CADEBUG</a></div><div class="ttdeci">#define CADEBUG(...)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d6d/GPUDef_8h_source.html#l00072">GPUDef.h:72</a></div></div>
<div class="ttc" id="aGPUGetConstexpr_8h_html"><div class="ttname"><a href="../../de/da7/GPUGetConstexpr_8h.html">GPUGetConstexpr.h</a></div></div>
<div class="ttc" id="aGPUGetConstexpr_8h_html_a5c79b1b01c9a51e796cf3d4645f3738f"><div class="ttname"><a href="../../de/da7/GPUGetConstexpr_8h.html#a5c79b1b01c9a51e796cf3d4645f3738f">GPUCA_GET_CONSTEXPR</a></div><div class="ttdeci">#define GPUCA_GET_CONSTEXPR(obj, val)</div><div class="ttdef"><b>Definition</b> <a href="../../de/da7/GPUGetConstexpr_8h_source.html#l00065">GPUGetConstexpr.h:65</a></div></div>
<div class="ttc" id="aGPUO2DataTypes_8h_html"><div class="ttname"><a href="../../d5/d5c/GPUO2DataTypes_8h.html">GPUO2DataTypes.h</a></div></div>
<div class="ttc" id="aGPUParam_8h_html"><div class="ttname"><a href="../../df/d13/GPUParam_8h.html">GPUParam.h</a></div></div>
<div class="ttc" id="aGPUSettings_8h_html"><div class="ttname"><a href="../../dd/dc6/GPUSettings_8h.html">GPUSettings.h</a></div></div>
<div class="ttc" id="aGPUTPCConvertImpl_8h_html"><div class="ttname"><a href="../../d1/d2e/GPUTPCConvertImpl_8h.html">GPUTPCConvertImpl.h</a></div></div>
<div class="ttc" id="aGPUTPCDef_8h_html"><div class="ttname"><a href="../../da/dab/GPUTPCDef_8h.html">GPUTPCDef.h</a></div></div>
<div class="ttc" id="aGPUTPCGMBorderTrack_8h_html"><div class="ttname"><a href="../../d8/dd4/GPUTPCGMBorderTrack_8h.html">GPUTPCGMBorderTrack.h</a></div></div>
<div class="ttc" id="aGPUTPCGMMergedTrack_8h_html"><div class="ttname"><a href="../../d8/dfd/GPUTPCGMMergedTrack_8h.html">GPUTPCGMMergedTrack.h</a></div></div>
<div class="ttc" id="aGPUTPCGMMergerTypes_8h_html"><div class="ttname"><a href="../../de/d4c/GPUTPCGMMergerTypes_8h.html">GPUTPCGMMergerTypes.h</a></div></div>
<div class="ttc" id="aGPUTPCGMMerger_8h_html"><div class="ttname"><a href="../../d4/dcf/GPUTPCGMMerger_8h.html">GPUTPCGMMerger.h</a></div></div>
<div class="ttc" id="aGPUTPCGMPhysicalTrackModel_8h_html"><div class="ttname"><a href="../../d6/d37/GPUTPCGMPhysicalTrackModel_8h.html">GPUTPCGMPhysicalTrackModel.h</a></div></div>
<div class="ttc" id="aGPUTPCGMPolynomialField_8h_html"><div class="ttname"><a href="../../d9/d9c/GPUTPCGMPolynomialField_8h.html">GPUTPCGMPolynomialField.h</a></div></div>
<div class="ttc" id="aGPUTPCGMPropagator_8h_html"><div class="ttname"><a href="../../d0/dd8/GPUTPCGMPropagator_8h.html">GPUTPCGMPropagator.h</a></div></div>
<div class="ttc" id="aGPUTPCGMTrackParam_8cxx_html_a2a217a61b4959cd7a68a42295b464db3"><div class="ttname"><a href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a2a217a61b4959cd7a68a42295b464db3">GPUdii</a></div><div class="ttdeci">GPUdii() void GPUTPCGMTrackParam</div><div class="ttdef"><b>Definition</b> <a href="../../df/dad/GPUTPCGMTrackParam_8cxx_source.html#l00613">GPUTPCGMTrackParam.cxx:613</a></div></div>
<div class="ttc" id="aGPUTPCGMTrackParam_8cxx_html_a91bfebfe3c8ecfae6391f27534ee3fa8"><div class="ttname"><a href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#a91bfebfe3c8ecfae6391f27534ee3fa8">GPUdni</a></div><div class="ttdeci">GPUdni() void GPUTPCGMTrackParam</div><div class="ttdef"><b>Definition</b> <a href="../../df/dad/GPUTPCGMTrackParam_8cxx_source.html#l00368">GPUTPCGMTrackParam.cxx:368</a></div></div>
<div class="ttc" id="aGPUTPCGMTrackParam_8cxx_html_aaecaa774d0bdc22367f43a2476f5bd9c"><div class="ttname"><a href="../../df/dad/GPUTPCGMTrackParam_8cxx.html#aaecaa774d0bdc22367f43a2476f5bd9c">DEBUG_SINGLE_TRACK</a></div><div class="ttdeci">#define DEBUG_SINGLE_TRACK</div><div class="ttdef"><b>Definition</b> <a href="../../df/dad/GPUTPCGMTrackParam_8cxx_source.html#l00016">GPUTPCGMTrackParam.cxx:16</a></div></div>
<div class="ttc" id="aGPUTPCGMTrackParam_8h_html"><div class="ttname"><a href="../../d8/d33/GPUTPCGMTrackParam_8h.html">GPUTPCGMTrackParam.h</a></div></div>
<div class="ttc" id="aGPUTPCGeometry_8h_html_a7e56ba7234f2f1d3732f5b37d24bb6a0"><div class="ttname"><a href="../../d6/d1b/GPUTPCGeometry_8h.html#a7e56ba7234f2f1d3732f5b37d24bb6a0">GPUCA_NSECTORS</a></div><div class="ttdeci">#define GPUCA_NSECTORS</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d1b/GPUTPCGeometry_8h_source.html#l00022">GPUTPCGeometry.h:22</a></div></div>
<div class="ttc" id="aGPUTPCGeometry_8h_html_afd2e13a07f9d227b8949af90d39812cf"><div class="ttname"><a href="../../d6/d1b/GPUTPCGeometry_8h.html#afd2e13a07f9d227b8949af90d39812cf">GPUCA_ROW_COUNT</a></div><div class="ttdeci">#define GPUCA_ROW_COUNT</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d1b/GPUTPCGeometry_8h_source.html#l00023">GPUTPCGeometry.h:23</a></div></div>
<div class="ttc" id="aGPUTPCTracker_8h_html"><div class="ttname"><a href="../../d6/d25/GPUTPCTracker_8h.html">GPUTPCTracker.h</a></div></div>
<div class="ttc" id="aGPUdEdx_8h_html"><div class="ttname"><a href="../../dc/d55/GPUdEdx_8h.html">GPUdEdx.h</a></div></div>
<div class="ttc" id="aRawData_8h_html_a5ee9234d389c6be7f0a75b450da09722"><div class="ttname"><a href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a></div><div class="ttdeci">uint32_t j</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d62/RawData_8h_source.html#l00000">RawData.h:0</a></div></div>
<div class="ttc" id="aRawData_8h_html_a97e3bb97951482c8cf4d55a2d0bfcb62"><div class="ttname"><a href="../../dc/d62/RawData_8h.html#a97e3bb97951482c8cf4d55a2d0bfcb62">res</a></div><div class="ttdeci">uint32_t res</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d62/RawData_8h_source.html#l00000">RawData.h:0</a></div></div>
<div class="ttc" id="aRawData_8h_html_aaf5d342e977c5857e99310eea0e72e4b"><div class="ttname"><a href="../../dc/d62/RawData_8h.html#aaf5d342e977c5857e99310eea0e72e4b">c</a></div><div class="ttdeci">uint32_t c</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d62/RawData_8h_source.html#l00002">RawData.h:2</a></div></div>
<div class="ttc" id="aTPCFastTransform_8h_html"><div class="ttname"><a href="../../d4/db1/TPCFastTransform_8h.html">TPCFastTransform.h</a></div><div class="ttdoc">Definition of TPCFastTransform class.</div></div>
<div class="ttc" id="abench__Clusterizer_8cxx_html_af656038045ce6448240b3767491787da"><div class="ttname"><a href="../../d2/d12/bench__Clusterizer_8cxx.html#af656038045ce6448240b3767491787da">num</a></div><div class="ttdeci">double num</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d12/bench__Clusterizer_8cxx_source.html#l00122">bench_Clusterizer.cxx:122</a></div></div>
<div class="ttc" id="aclassint_html"><div class="ttname"><a href="../../d1/da0/classint.html">int</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMMergedTrack_html"><div class="ttname"><a href="../../d2/d6d/classo2_1_1gpu_1_1GPUTPCGMMergedTrack.html">o2::gpu::GPUTPCGMMergedTrack</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/dfd/GPUTPCGMMergedTrack_8h_source.html#l00028">GPUTPCGMMergedTrack.h:29</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMMerger_html"><div class="ttname"><a href="../../dc/d0a/classo2_1_1gpu_1_1GPUTPCGMMerger.html">o2::gpu::GPUTPCGMMerger</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/dcf/GPUTPCGMMerger_8h_source.html#l00059">GPUTPCGMMerger.h:60</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html">o2::gpu::GPUTPCGMPropagator</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00043">GPUTPCGMPropagator.h:44</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_a010f4eb6e4487f78257be8b2cb8d588b"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#a010f4eb6e4487f78257be8b2cb8d588b">o2::gpu::GPUTPCGMPropagator::Y</a></div><div class="ttdeci">float Y</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00128">GPUTPCGMPropagator.h:128</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_a7351d3f8aed3b58a7ca5f5fd01311cc4"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#a7351d3f8aed3b58a7ca5f5fd01311cc4">o2::gpu::GPUTPCGMPropagator::sector</a></div><div class="ttdeci">float int32_t const GPUParam int16_t int8_t bool int8_t sector</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00107">GPUTPCGMPropagator.h:107</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_a924c00c81b5b0d04f2ac6900cb5ccbbd"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#a924c00c81b5b0d04f2ac6900cb5ccbbd">o2::gpu::GPUTPCGMPropagator::param</a></div><div class="ttdeci">float int32_t const GPUParam &amp; param</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00107">GPUTPCGMPropagator.h:107</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_abc6775fc22e3d39c5ce6fc1015ca8f41"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#abc6775fc22e3d39c5ce6fc1015ca8f41">o2::gpu::GPUTPCGMPropagator::Z</a></div><div class="ttdeci">float float Z</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00130">GPUTPCGMPropagator.h:130</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_acdac77be8bdedc72a7321029b180087da023ccc3eb61e892fe57d37b054049560"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#acdac77be8bdedc72a7321029b180087da023ccc3eb61e892fe57d37b054049560">o2::gpu::GPUTPCGMPropagator::updateErrorClusterRejectedDistance</a></div><div class="ttdeci">@ updateErrorClusterRejectedDistance</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00055">GPUTPCGMPropagator.h:55</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_acdac77be8bdedc72a7321029b180087da6da4ecd1404da6ed96ca9e91d5def1d1"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#acdac77be8bdedc72a7321029b180087da6da4ecd1404da6ed96ca9e91d5def1d1">o2::gpu::GPUTPCGMPropagator::updateErrorClusterRejected</a></div><div class="ttdeci">@ updateErrorClusterRejected</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00054">GPUTPCGMPropagator.h:54</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_acdac77be8bdedc72a7321029b180087daa23360650d1192de6af603b467ccbb3a"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#acdac77be8bdedc72a7321029b180087daa23360650d1192de6af603b467ccbb3a">o2::gpu::GPUTPCGMPropagator::updateErrorClusterRejectedEdge</a></div><div class="ttdeci">@ updateErrorClusterRejectedEdge</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00059">GPUTPCGMPropagator.h:58</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_ad4bb9d8fedd30fec57948bbf7ab13ba2a0dd7f90044770838842736fcef83e800"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2a0dd7f90044770838842736fcef83e800">o2::gpu::GPUTPCGMPropagator::rejectInterFill</a></div><div class="ttdeci">@ rejectInterFill</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00062">GPUTPCGMPropagator.h:62</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_ad4bb9d8fedd30fec57948bbf7ab13ba2a886e724fe45d004e513c1fd26aa3fe90"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2a886e724fe45d004e513c1fd26aa3fe90">o2::gpu::GPUTPCGMPropagator::rejectInterReject</a></div><div class="ttdeci">@ rejectInterReject</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00064">GPUTPCGMPropagator.h:63</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMPropagator_html_ad4bb9d8fedd30fec57948bbf7ab13ba2ae7e27cae06e98fa043dedd0cc4ab64f3"><div class="ttname"><a href="../../df/dba/classo2_1_1gpu_1_1GPUTPCGMPropagator.html#ad4bb9d8fedd30fec57948bbf7ab13ba2ae7e27cae06e98fa043dedd0cc4ab64f3">o2::gpu::GPUTPCGMPropagator::rejectDirect</a></div><div class="ttdeci">@ rejectDirect</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dd8/GPUTPCGMPropagator_8h_source.html#l00061">GPUTPCGMPropagator.h:61</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMTrackParam_html"><div class="ttname"><a href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html">o2::gpu::GPUTPCGMTrackParam</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/d33/GPUTPCGMTrackParam_8h_source.html#l00047">GPUTPCGMTrackParam.h:48</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMTrackParam_html_a4858a189d643e34a8010cedc5b11ec0e"><div class="ttname"><a href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html#a4858a189d643e34a8010cedc5b11ec0e">o2::gpu::GPUTPCGMTrackParam::Alpha</a></div><div class="ttdeci">int32_t GPUTPCGMMergedTrackHit int32_t int32_t float &amp; Alpha</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d33/GPUTPCGMTrackParam_8h_source.html#l00144">GPUTPCGMTrackParam.h:144</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMTrackParam_html_a4ec8a9ba9edbafd5337c1a45bcc605d5"><div class="ttname"><a href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html#a4ec8a9ba9edbafd5337c1a45bcc605d5">o2::gpu::GPUTPCGMTrackParam::track</a></div><div class="ttdeci">int32_t GPUTPCGMMergedTrackHit int32_t int32_t float int32_t float GPUTPCGMMergedTrack &amp; track</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d33/GPUTPCGMTrackParam_8h_source.html#l00144">GPUTPCGMTrackParam.h:144</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGMTrackParam_html_aaedd0286215a9951501d0cbe2c34ecd1"><div class="ttname"><a href="../../d1/d07/classo2_1_1gpu_1_1GPUTPCGMTrackParam.html#aaedd0286215a9951501d0cbe2c34ecd1">o2::gpu::GPUTPCGMTrackParam::Y</a></div><div class="ttdeci">int32_t int32_t int32_t bool float Y</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d33/GPUTPCGMTrackParam_8h_source.html#l00151">GPUTPCGMTrackParam.h:151</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCGeometry_html"><div class="ttname"><a href="../../de/d65/classo2_1_1gpu_1_1GPUTPCGeometry.html">o2::gpu::GPUTPCGeometry</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d1b/GPUTPCGeometry_8h_source.html#l00083">GPUTPCGeometry.h:84</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCRow_html"><div class="ttname"><a href="../../da/d92/classo2_1_1gpu_1_1GPUTPCRow.html">o2::gpu::GPUTPCRow</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/dff/GPUTPCRow_8h_source.html#l00030">GPUTPCRow.h:31</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUTPCTracker_html"><div class="ttname"><a href="../../d4/da9/classo2_1_1gpu_1_1GPUTPCTracker.html">o2::gpu::GPUTPCTracker</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d25/GPUTPCTracker_8h_source.html#l00038">GPUTPCTracker.h:39</a></div></div>
<div class="ttc" id="aclasso2_1_1gpu_1_1GPUdEdx_html"><div class="ttname"><a href="../../d1/d72/classo2_1_1gpu_1_1GPUdEdx.html">o2::gpu::GPUdEdx</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/d55/GPUdEdx_8h_source.html#l00031">GPUdEdx.h:32</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a090ebe65994a3ee4bb60ae3472abffc5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a090ebe65994a3ee4bb60ae3472abffc5">alpha</a></div><div class="ttdeci">GLfloat GLfloat GLfloat alpha</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00279">glcorearb.h:279</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a2378b8283cbc1699028da8a3eea4711c"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a2378b8283cbc1699028da8a3eea4711c">weights</a></div><div class="ttdeci">GLsizei const GLuint const GLfloat * weights</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05475">glcorearb.h:5475</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a31eafbeac9256b106b6acfd78f305200"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a31eafbeac9256b106b6acfd78f305200">count</a></div><div class="ttdeci">GLint GLsizei count</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00399">glcorearb.h:399</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a43d7824acc27a497365ad4b5bc9e67fd"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a43d7824acc27a497365ad4b5bc9e67fd">ids</a></div><div class="ttdeci">GLuint * ids</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00647">glcorearb.h:647</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a52f38e7d822a46377fde7a02708eedb1"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a52f38e7d822a46377fde7a02708eedb1">array</a></div><div class="ttdeci">GLenum array</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l04274">glcorearb.h:4274</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a5ffadbbacc6b89cf6218bc43b384d3fe"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a5ffadbbacc6b89cf6218bc43b384d3fe">right</a></div><div class="ttdeci">GLdouble GLdouble right</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l04077">glcorearb.h:4077</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a6b425be07cfa8ac09043ef8391e7e514"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a6b425be07cfa8ac09043ef8391e7e514">weight</a></div><div class="ttdeci">GLuint GLuint GLfloat weight</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05477">glcorearb.h:5477</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a6eba317e3cf44d6d26c04a5a8f197dcb"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a6eba317e3cf44d6d26c04a5a8f197dcb">b</a></div><div class="ttdeci">GLboolean GLboolean GLboolean b</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a8922a680b00df660c57f47c1971d04c5"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a8922a680b00df660c57f47c1971d04c5">data</a></div><div class="ttdeci">GLboolean * data</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00298">glcorearb.h:298</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_a950fc91edb4504f62f1c577bf4727c29"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a950fc91edb4504f62f1c577bf4727c29">void</a></div><div class="ttdeci">typedef void(APIENTRYP PFNGLCULLFACEPROC)(GLenum mode)</div></div>
<div class="ttc" id="aglcorearb_8h_html_a98ac434677655cc8438bb72de2719f39"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#a98ac434677655cc8438bb72de2719f39">x0</a></div><div class="ttdeci">GLuint GLfloat x0</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05034">glcorearb.h:5034</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_abd92661d757c8e8c0e50c1b9c3ce496e"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#abd92661d757c8e8c0e50c1b9c3ce496e">clamp</a></div><div class="ttdeci">GLenum clamp</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01245">glcorearb.h:1245</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_abe08814c2f72843fde4d8df41440d5a0"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#abe08814c2f72843fde4d8df41440d5a0">r</a></div><div class="ttdeci">GLboolean r</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l01233">glcorearb.h:1233</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_ac7c896d55e93a6cf7ff8524005b4e7b4"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ac7c896d55e93a6cf7ff8524005b4e7b4">param</a></div><div class="ttdeci">GLenum GLfloat param</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00271">glcorearb.h:271</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_ae52362b10d585638f5b96140e90f1b7a"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ae52362b10d585638f5b96140e90f1b7a">id</a></div><div class="ttdeci">GLuint id</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00650">glcorearb.h:650</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_ae7f97ed6c9c8e502fcbc44c7cb8a8312"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#ae7f97ed6c9c8e502fcbc44c7cb8a8312">y0</a></div><div class="ttdeci">GLuint GLfloat GLfloat y0</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l05034">glcorearb.h:5034</a></div></div>
<div class="ttc" id="aglcorearb_8h_html_aee38b51639b577753f6a92029fb92000"><div class="ttname"><a href="../../dc/da3/glcorearb_8h.html#aee38b51639b577753f6a92029fb92000">z</a></div><div class="ttdeci">GLdouble GLdouble GLdouble z</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da3/glcorearb_8h_source.html#l00843">glcorearb.h:843</a></div></div>
<div class="ttc" id="anamespaceo2_1_1gpu_1_1gputpcgmmergertypes_html_a62d5634777307223b51231ff617dc51ba0fee1aa2917316f366a36e826f998cbc"><div class="ttname"><a href="../../dc/d1d/namespaceo2_1_1gpu_1_1gputpcgmmergertypes.html#a62d5634777307223b51231ff617dc51ba0fee1aa2917316f366a36e826f998cbc">o2::gpu::gputpcgmmergertypes::attachAttached</a></div><div class="ttdeci">@ attachAttached</div><div class="ttdef"><b>Definition</b> <a href="../../de/d4c/GPUTPCGMMergerTypes_8h_source.html#l00025">GPUTPCGMMergerTypes.h:25</a></div></div>
<div class="ttc" id="anamespaceo2_1_1gpu_1_1gputpcgmmergertypes_html_a62d5634777307223b51231ff617dc51ba198cdf2f4efc076b99a1e64e02bcb960"><div class="ttname"><a href="../../dc/d1d/namespaceo2_1_1gpu_1_1gputpcgmmergertypes.html#a62d5634777307223b51231ff617dc51ba198cdf2f4efc076b99a1e64e02bcb960">o2::gpu::gputpcgmmergertypes::attachTube</a></div><div class="ttdeci">@ attachTube</div><div class="ttdef"><b>Definition</b> <a href="../../de/d4c/GPUTPCGMMergerTypes_8h_source.html#l00028">GPUTPCGMMergerTypes.h:28</a></div></div>
<div class="ttc" id="anamespaceo2_1_1gpu_1_1gputpcgmmergertypes_html_a62d5634777307223b51231ff617dc51ba27f24f5ebdda1c9242359f70b74a818b"><div class="ttname"><a href="../../dc/d1d/namespaceo2_1_1gpu_1_1gputpcgmmergertypes.html#a62d5634777307223b51231ff617dc51ba27f24f5ebdda1c9242359f70b74a818b">o2::gpu::gputpcgmmergertypes::attachGoodLeg</a></div><div class="ttdeci">@ attachGoodLeg</div><div class="ttdef"><b>Definition</b> <a href="../../de/d4c/GPUTPCGMMergerTypes_8h_source.html#l00027">GPUTPCGMMergerTypes.h:27</a></div></div>
<div class="ttc" id="anamespaceo2_1_1gpu_1_1gputpcgmmergertypes_html_a62d5634777307223b51231ff617dc51bafcb8fe1f51be1c12759b32c352b64170"><div class="ttname"><a href="../../dc/d1d/namespaceo2_1_1gpu_1_1gputpcgmmergertypes.html#a62d5634777307223b51231ff617dc51bafcb8fe1f51be1c12759b32c352b64170">o2::gpu::gputpcgmmergertypes::attachProtect</a></div><div class="ttdeci">@ attachProtect</div><div class="ttdef"><b>Definition</b> <a href="../../de/d4c/GPUTPCGMMergerTypes_8h_source.html#l00024">GPUTPCGMMergerTypes.h:24</a></div></div>
<div class="ttc" id="anamespaceo2_1_1gpu_html"><div class="ttname"><a href="../../d0/db4/namespaceo2_1_1gpu.html">o2::gpu</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/d2e/TrackTRD_8h_source.html#l00034">TrackTRD.h:35</a></div></div>
<div class="ttc" id="anamespaceo2_1_1gpu_html_afce867617e1a6b4db514bab5e441e992"><div class="ttname"><a href="../../d0/db4/namespaceo2_1_1gpu.html#afce867617e1a6b4db514bab5e441e992">o2::gpu::calink</a></div><div class="ttdeci">uint32_t calink</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GPUTPCDef_8h_source.html#l00030">GPUTPCDef.h:30</a></div></div>
<div class="ttc" id="anamespaceo2_1_1tpc_html"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html">o2::tpc</a></div><div class="ttdoc">Global TPC definitions and constants.</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbc/SimTraits_8h_source.html#l00167">SimTraits.h:168</a></div></div>
<div class="ttc" id="anamespaceo2_1_1tpc_html_a6973a334404d13ff01effd935e45d8d8"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a6973a334404d13ff01effd935e45d8d8">o2::tpc::GPUd</a></div><div class="ttdeci">GPUd() void PIDResponse</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d98/PIDResponse_8h_source.html#l00071">PIDResponse.h:71</a></div></div>
<div class="ttc" id="anamespaceo2_1_1tpc_html_a79d71058f2f11e75e5466381d2987c03"><div class="ttname"><a href="../../d0/d0a/namespaceo2_1_1tpc.html#a79d71058f2f11e75e5466381d2987c03">o2::tpc::GPUdi</a></div><div class="ttdeci">GPUdi() T BetheBlochAleph(T bg</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d57/GPUTPCCompressionKernels_8cxx_source.html#l00510">GPUTPCCompressionKernels.cxx:510</a></div></div>
<div class="ttc" id="anamespaceo2_1_1track_html_a69a68024dfc8f89815f7184ee1d2ac7c"><div class="ttname"><a href="../../d1/dec/namespaceo2_1_1track.html#a69a68024dfc8f89815f7184ee1d2ac7c">o2::track::step</a></div><div class="ttdeci">value_T step</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d97/TrackUtils_8h_source.html#l00042">TrackUtils.h:42</a></div></div>
<div class="ttc" id="anamespaceo2_1_1track_html_abc036accb16c70a84e9be9b039571e1c"><div class="ttname"><a href="../../d1/dec/namespaceo2_1_1track.html#abc036accb16c70a84e9be9b039571e1c">o2::track::maxT</a></div><div class="ttdeci">value_T maxT</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d97/TrackUtils_8h_source.html#l00132">TrackUtils.h:132</a></div></div>
<div class="ttc" id="anamespaceo2_1_1utils_html_ab00bdc0f94fa861734930fc91cf67e14aef681b849c96debe373d047a9b4ed455"><div class="ttname"><a href="../../d0/d28/namespaceo2_1_1utils.html#ab00bdc0f94fa861734930fc91cf67e14aef681b849c96debe373d047a9b4ed455">o2::utils::streamUpdateTrack</a></div><div class="ttdeci">@ streamUpdateTrack</div><div class="ttdoc">stream update track informations</div><div class="ttdef"><b>Definition</b> <a href="../../de/d17/DebugStreamer_8h_source.html#l00040">DebugStreamer.h:40</a></div></div>
<div class="ttc" id="anamespacestd_html"><div class="ttname"><a href="../../d8/dcc/namespacestd.html">std</a></div><div class="ttdoc">Defining DataPointCompositeObject explicitly as copiable.</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dab/CcdbObjectInfo_8h_source.html#l00120">CcdbObjectInfo.h:121</a></div></div>
<div class="ttc" id="ascan-hvlv-ccdb_8cxx_html_a0cab151bc8ea974b059e7604901a7285"><div class="ttname"><a href="../../d8/d5a/scan-hvlv-ccdb_8cxx.html#a0cab151bc8ea974b059e7604901a7285">getTime</a></div><div class="ttdeci">std::string getTime(uint64_t ts)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d5a/scan-hvlv-ccdb_8cxx_source.html#l00145">scan-hvlv-ccdb.cxx:145</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUParam_html"><div class="ttname"><a href="../../d3/d65/structo2_1_1gpu_1_1GPUParam.html">o2::gpu::GPUParam</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d13/GPUParam_8h_source.html#l00080">GPUParam.h:80</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMLoopData_html"><div class="ttname"><a href="../../d0/d80/structo2_1_1gpu_1_1GPUTPCGMLoopData.html">o2::gpu::GPUTPCGMLoopData</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/d33/GPUTPCGMTrackParam_8h_source.html#l00225">GPUTPCGMTrackParam.h:225</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMLoopData_html_ad8e84000f469e01ea957301534a6f6ee"><div class="ttname"><a href="../../d0/d80/structo2_1_1gpu_1_1GPUTPCGMLoopData.html#ad8e84000f469e01ea957301534a6f6ee">o2::gpu::GPUTPCGMLoopData::param</a></div><div class="ttdeci">GPUTPCGMTrackParam param</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d33/GPUTPCGMTrackParam_8h_source.html#l00226">GPUTPCGMTrackParam.h:226</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMMergedTrackHit_html"><div class="ttname"><a href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html">o2::gpu::GPUTPCGMMergedTrackHit</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/dcc/GPUTPCGMMergedTrackHit_8h_source.html#l00022">GPUTPCGMMergedTrackHit.h:22</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMMergedTrackHit_html_a9bc1cbd64e04968101718859b8a09bf6"><div class="ttname"><a href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#a9bc1cbd64e04968101718859b8a09bf6">o2::gpu::GPUTPCGMMergedTrackHit::sector</a></div><div class="ttdeci">uint8_t sector</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dcc/GPUTPCGMMergedTrackHit_8h_source.html#l00024">GPUTPCGMMergedTrackHit.h:24</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMMergedTrackHit_html_ae381b3724c6fe10f07ad1dd2b0406067a0ece7324ecc58c2cc671cd09a65e80c7"><div class="ttname"><a href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067a0ece7324ecc58c2cc671cd09a65e80c7">o2::gpu::GPUTPCGMMergedTrackHit::clustererAndSharedFlags</a></div><div class="ttdeci">@ clustererAndSharedFlags</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dcc/GPUTPCGMMergedTrackHit_8h_source.html#l00034">GPUTPCGMMergedTrackHit.h:34</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMMergedTrackHit_html_ae381b3724c6fe10f07ad1dd2b0406067a4e5f9a4a3a3f042ff45acaa3b2d1a9ab"><div class="ttname"><a href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067a4e5f9a4a3a3f042ff45acaa3b2d1a9ab">o2::gpu::GPUTPCGMMergedTrackHit::flagHighIncl</a></div><div class="ttdeci">@ flagHighIncl</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dcc/GPUTPCGMMergedTrackHit_8h_source.html#l00038">GPUTPCGMMergedTrackHit.h:38</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMMergedTrackHit_html_ae381b3724c6fe10f07ad1dd2b0406067a6f78dd6ee2fa5a97155fc5e0e7cadf8d"><div class="ttname"><a href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067a6f78dd6ee2fa5a97155fc5e0e7cadf8d">o2::gpu::GPUTPCGMMergedTrackHit::flagRejectDistance</a></div><div class="ttdeci">@ flagRejectDistance</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dcc/GPUTPCGMMergedTrackHit_8h_source.html#l00035">GPUTPCGMMergedTrackHit.h:35</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMMergedTrackHit_html_ae381b3724c6fe10f07ad1dd2b0406067aac525df6bf55a382f6227ac3ddb0a51e"><div class="ttname"><a href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067aac525df6bf55a382f6227ac3ddb0a51e">o2::gpu::GPUTPCGMMergedTrackHit::flagRejectErr</a></div><div class="ttdeci">@ flagRejectErr</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dcc/GPUTPCGMMergedTrackHit_8h_source.html#l00036">GPUTPCGMMergedTrackHit.h:36</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1GPUTPCGMMergedTrackHit_html_ae381b3724c6fe10f07ad1dd2b0406067ac615c3e236bd7318730a5311e1b6c7ad"><div class="ttname"><a href="../../dd/d30/structo2_1_1gpu_1_1GPUTPCGMMergedTrackHit.html#ae381b3724c6fe10f07ad1dd2b0406067ac615c3e236bd7318730a5311e1b6c7ad">o2::gpu::GPUTPCGMMergedTrackHit::flagReject</a></div><div class="ttdeci">@ flagReject</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dcc/GPUTPCGMMergedTrackHit_8h_source.html#l00037">GPUTPCGMMergedTrackHit.h:37</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1cahit2_html"><div class="ttname"><a href="../../de/da6/structo2_1_1gpu_1_1cahit2.html">o2::gpu::cahit2</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GPUTPCDef_8h_source.html#l00033">GPUTPCDef.h:33</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1cahit2_html_a7662c97be0c010b54e71ca264671dee3"><div class="ttname"><a href="../../de/da6/structo2_1_1gpu_1_1cahit2.html#a7662c97be0c010b54e71ca264671dee3">o2::gpu::cahit2::x</a></div><div class="ttdeci">cahit x</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GPUTPCDef_8h_source.html#l00033">GPUTPCDef.h:33</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1cahit2_html_ae4e60a765589202e3bd342b7e94b7005"><div class="ttname"><a href="../../de/da6/structo2_1_1gpu_1_1cahit2.html#ae4e60a765589202e3bd342b7e94b7005">o2::gpu::cahit2::y</a></div><div class="ttdeci">cahit y</div><div class="ttdef"><b>Definition</b> <a href="../../da/dab/GPUTPCDef_8h_source.html#l00033">GPUTPCDef.h:33</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrorHit_html_aa8b5d1e383d25788a5822b660b820a68"><div class="ttname"><a href="../../dc/d37/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrorHit.html#aa8b5d1e383d25788a5822b660b820a68">o2::gpu::gputpcgmmergertypes::InterpolationErrorHit::errorY</a></div><div class="ttdeci">GPUCA_PAR_MERGER_INTERPOLATION_ERROR_TYPE_A errorY</div><div class="ttdef"><b>Definition</b> <a href="../../de/d4c/GPUTPCGMMergerTypes_8h_source.html#l00036">GPUTPCGMMergerTypes.h:36</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors_html"><div class="ttname"><a href="../../df/dcd/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors.html">o2::gpu::gputpcgmmergertypes::InterpolationErrors</a></div><div class="ttdef"><b>Definition</b> <a href="../../de/d4c/GPUTPCGMMergerTypes_8h_source.html#l00039">GPUTPCGMMergerTypes.h:39</a></div></div>
<div class="ttc" id="astructo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors_html_aaf4fca9df601e06dbb0d69c92e85a3da"><div class="ttname"><a href="../../df/dcd/structo2_1_1gpu_1_1gputpcgmmergertypes_1_1InterpolationErrors.html#aaf4fca9df601e06dbb0d69c92e85a3da">o2::gpu::gputpcgmmergertypes::InterpolationErrors::hit</a></div><div class="ttdeci">InterpolationErrorHit hit[GPUCA_MERGER_MAX_TRACK_CLUSTERS]</div><div class="ttdef"><b>Definition</b> <a href="../../de/d4c/GPUTPCGMMergerTypes_8h_source.html#l00040">GPUTPCGMMergerTypes.h:40</a></div></div>
<div class="ttc" id="astructo2_1_1tpc_1_1ClusterNative_html"><div class="ttname"><a href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html">o2::tpc::ClusterNative</a></div><div class="ttdef"><b>Definition</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00054">ClusterNative.h:54</a></div></div>
<div class="ttc" id="astructo2_1_1tpc_1_1ClusterNative_html_a3bf15f414113a6e8754942e8f58d20fa"><div class="ttname"><a href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html#a3bf15f414113a6e8754942e8f58d20fa">o2::tpc::ClusterNative::qMax</a></div><div class="ttdeci">uint16_t qMax</div><div class="ttdef"><b>Definition</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00071">ClusterNative.h:71</a></div></div>
<div class="ttc" id="astructo2_1_1tpc_1_1ClusterNative_html_a869b47009cff6108aa57d25c6916e623"><div class="ttname"><a href="../../dc/dbc/structo2_1_1tpc_1_1ClusterNative.html#a869b47009cff6108aa57d25c6916e623">o2::tpc::ClusterNative::qTot</a></div><div class="ttdeci">uint16_t qTot</div><div class="ttdef"><b>Definition</b> <a href="../../de/dcd/ClusterNative_8h_source.html#l00072">ClusterNative.h:72</a></div></div>
<div class="ttc" id="atest__ctf__io__cpv_8cxx_html_aab8d634df002865a4d05b2968b2e302b"><div class="ttname"><a href="../../dc/da7/test__ctf__io__cpv_8cxx.html#aab8d634df002865a4d05b2968b2e302b">clusters</a></div><div class="ttdeci">std::vector&lt; Cluster &gt; clusters</div><div class="ttdef"><b>Definition</b> <a href="../../dc/da7/test__ctf__io__cpv_8cxx_source.html#l00042">test_ctf_io_cpv.cxx:42</a></div></div>
<div class="ttc" id="atest__ctf__io__itsmft_8cxx_html_a0d486908f7dec1a3d6441d6f3da6a6cd"><div class="ttname"><a href="../../db/db0/test__ctf__io__itsmft_8cxx.html#a0d486908f7dec1a3d6441d6f3da6a6cd">row</a></div><div class="ttdeci">std::vector&lt; int &gt; row</div><div class="ttdef"><b>Definition</b> <a href="../../db/db0/test__ctf__io__itsmft_8cxx_source.html#l00048">test_ctf_io_itsmft.cxx:48</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_f511f1e9c03c071966ae594f00bbc5e0.html">GPU</a></li><li class="navelem"><a class="el" href="../../dir_77030b149987c946eb2e85728f65acc0.html">GPUTracking</a></li><li class="navelem"><a class="el" href="../../dir_808d5540d0c117816a4e0e1b180c8334.html">Merger</a></li><li class="navelem"><a class="el" href="../../df/dad/GPUTPCGMTrackParam_8cxx.html">GPUTPCGMTrackParam.cxx</a></li>
    <li class="footer">Generated on Sat Feb 21 2026 17:59:06 for Project by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
