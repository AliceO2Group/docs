<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: /home/runner/work/AliceO2/AliceO2/Detectors/TRD/workflow/src/TRDTrapSimulatorSpec.cxx Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function() { init_codefold(1); });
/* @license-end */
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/de7/TRDTrapSimulatorSpec_8cxx_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="headertitle"><div class="title">TRDTrapSimulatorSpec.cxx</div></div>
</div><!--header-->
<div class="contents">
<a href="../../dd/de7/TRDTrapSimulatorSpec_8cxx.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a id="l00001" name="l00001"></a><span class="lineno">    1</span><span class="comment">// Copyright 2019-2020 CERN and copyright holders of ALICE O2.</span></div>
<div class="line"><a id="l00002" name="l00002"></a><span class="lineno">    2</span><span class="comment">// See https://alice-o2.web.cern.ch/copyright for details of the copyright holders.</span></div>
<div class="line"><a id="l00003" name="l00003"></a><span class="lineno">    3</span><span class="comment">// All rights not expressly granted are reserved.</span></div>
<div class="line"><a id="l00004" name="l00004"></a><span class="lineno">    4</span><span class="comment">//</span></div>
<div class="line"><a id="l00005" name="l00005"></a><span class="lineno">    5</span><span class="comment">// This software is distributed under the terms of the GNU General Public</span></div>
<div class="line"><a id="l00006" name="l00006"></a><span class="lineno">    6</span><span class="comment">// License v3 (GPL Version 3), copied verbatim in the file &quot;COPYING&quot;.</span></div>
<div class="line"><a id="l00007" name="l00007"></a><span class="lineno">    7</span><span class="comment">//</span></div>
<div class="line"><a id="l00008" name="l00008"></a><span class="lineno">    8</span><span class="comment">// In applying this license CERN does not waive the privileges and immunities</span></div>
<div class="line"><a id="l00009" name="l00009"></a><span class="lineno">    9</span><span class="comment">// granted to it by virtue of its status as an Intergovernmental Organization</span></div>
<div class="line"><a id="l00010" name="l00010"></a><span class="lineno">   10</span><span class="comment">// or submit itself to any jurisdiction.</span></div>
<div class="line"><a id="l00011" name="l00011"></a><span class="lineno">   11</span> </div>
<div class="line"><a id="l00012" name="l00012"></a><span class="lineno">   12</span><span class="preprocessor">#include &quot;<a class="code" href="../../dc/d96/TRDTrapSimulatorSpec_8h.html">TRDWorkflow/TRDTrapSimulatorSpec.h</a>&quot;</span></div>
<div class="line"><a id="l00013" name="l00013"></a><span class="lineno">   13</span> </div>
<div class="line"><a id="l00014" name="l00014"></a><span class="lineno">   14</span><span class="preprocessor">#include &lt;chrono&gt;</span></div>
<div class="line"><a id="l00015" name="l00015"></a><span class="lineno">   15</span><span class="preprocessor">#include &lt;optional&gt;</span></div>
<div class="line"><a id="l00016" name="l00016"></a><span class="lineno">   16</span><span class="preprocessor">#include &lt;gsl/span&gt;</span></div>
<div class="line"><a id="l00017" name="l00017"></a><span class="lineno">   17</span> </div>
<div class="line"><a id="l00018" name="l00018"></a><span class="lineno">   18</span><span class="preprocessor">#ifdef WITH_OPENMP</span></div>
<div class="line"><a id="l00019" name="l00019"></a><span class="lineno">   19</span><span class="preprocessor">#include &lt;omp.h&gt;</span></div>
<div class="line"><a id="l00020" name="l00020"></a><span class="lineno">   20</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00021" name="l00021"></a><span class="lineno">   21</span> </div>
<div class="line"><a id="l00022" name="l00022"></a><span class="lineno">   22</span><span class="preprocessor">#include &quot;TFile.h&quot;</span></div>
<div class="line"><a id="l00023" name="l00023"></a><span class="lineno">   23</span> </div>
<div class="line"><a id="l00024" name="l00024"></a><span class="lineno">   24</span><span class="preprocessor">#include &quot;<a class="code" href="../../de/dc6/ConfigParamRegistry_8h.html">Framework/ConfigParamRegistry.h</a>&quot;</span></div>
<div class="line"><a id="l00025" name="l00025"></a><span class="lineno">   25</span><span class="preprocessor">#include &quot;<a class="code" href="../../d2/d43/ControlService_8h.html">Framework/ControlService.h</a>&quot;</span></div>
<div class="line"><a id="l00026" name="l00026"></a><span class="lineno">   26</span><span class="preprocessor">#include &quot;<a class="code" href="../../d0/df4/DataProcessorSpec_8h.html">Framework/DataProcessorSpec.h</a>&quot;</span></div>
<div class="line"><a id="l00027" name="l00027"></a><span class="lineno">   27</span><span class="preprocessor">#include &quot;<a class="code" href="../../d5/db8/DataRefUtils_8h.html">Framework/DataRefUtils.h</a>&quot;</span></div>
<div class="line"><a id="l00028" name="l00028"></a><span class="lineno">   28</span><span class="preprocessor">#include &quot;<a class="code" href="../../dc/dca/Lifetime_8h.html">Framework/Lifetime.h</a>&quot;</span></div>
<div class="line"><a id="l00029" name="l00029"></a><span class="lineno">   29</span><span class="preprocessor">#include &quot;fairlogger/Logger.h&quot;</span></div>
<div class="line"><a id="l00030" name="l00030"></a><span class="lineno">   30</span><span class="preprocessor">#include &quot;<a class="code" href="../../d5/df3/BasicCCDBManager_8h.html">CCDB/BasicCCDBManager.h</a>&quot;</span></div>
<div class="line"><a id="l00031" name="l00031"></a><span class="lineno">   31</span> </div>
<div class="line"><a id="l00032" name="l00032"></a><span class="lineno">   32</span><span class="preprocessor">#include &quot;<a class="code" href="../../d7/dcd/MCCompLabel_8h.html">SimulationDataFormat/MCCompLabel.h</a>&quot;</span></div>
<div class="line"><a id="l00033" name="l00033"></a><span class="lineno">   33</span><span class="preprocessor">#include &quot;<a class="code" href="../../d1/da6/ConstMCTruthContainer_8h.html">SimulationDataFormat/ConstMCTruthContainer.h</a>&quot;</span></div>
<div class="line"><a id="l00034" name="l00034"></a><span class="lineno">   34</span><span class="preprocessor">#include &quot;<a class="code" href="../../d5/dad/TRDSimParams_8h.html">TRDSimulation/TRDSimParams.h</a>&quot;</span></div>
<div class="line"><a id="l00035" name="l00035"></a><span class="lineno">   35</span><span class="preprocessor">#include &quot;<a class="code" href="../../d8/dbb/TrapConfig_8h.html">TRDSimulation/TrapConfig.h</a>&quot;</span></div>
<div class="line"><a id="l00036" name="l00036"></a><span class="lineno">   36</span><span class="preprocessor">#include &quot;<a class="code" href="../../df/d6a/DataFormats_2Detectors_2TRD_2include_2DataFormatsTRD_2Digit_8h.html">DataFormatsTRD/Digit.h</a>&quot;</span></div>
<div class="line"><a id="l00037" name="l00037"></a><span class="lineno">   37</span><span class="preprocessor">#include &quot;<a class="code" href="../../d9/dbe/TRD_2include_2DataFormatsTRD_2TriggerRecord_8h.html">DataFormatsTRD/TriggerRecord.h</a>&quot;</span></div>
<div class="line"><a id="l00038" name="l00038"></a><span class="lineno">   38</span> </div>
<div class="line"><a id="l00039" name="l00039"></a><span class="lineno">   39</span><span class="keyword">using namespace </span><a class="code hl_namespace" href="../../dd/d8d/namespaceo2_1_1framework.html">o2::framework</a>;</div>
<div class="line"><a id="l00040" name="l00040"></a><span class="lineno">   40</span> </div>
<div class="line"><a id="l00041" name="l00041"></a><span class="lineno">   41</span><span class="keyword">namespace </span><a class="code hl_namespace" href="../../d4/d7c/namespaceo2.html">o2</a></div>
<div class="line"><a id="l00042" name="l00042"></a><span class="lineno">   42</span>{</div>
<div class="line"><a id="l00043" name="l00043"></a><span class="lineno">   43</span><span class="keyword">namespace </span>trd</div>
<div class="line"><a id="l00044" name="l00044"></a><span class="lineno">   44</span>{</div>
<div class="line"><a id="l00045" name="l00045"></a><span class="lineno">   45</span> </div>
<div class="line"><a id="l00046" name="l00046"></a><span class="lineno">   46</span><span class="keyword">using namespace </span>constants;</div>
<div class="line"><a id="l00047" name="l00047"></a><span class="lineno">   47</span> </div>
<div class="line"><a id="l00048" name="l00048"></a><span class="lineno">   48</span><span class="keywordtype">void</span> TRDDPLTrapSimulatorTask::initTrapConfig(<span class="keywordtype">long</span> timeStamp)</div>
<div class="line"><a id="l00049" name="l00049"></a><span class="lineno">   49</span>{</div>
<div class="line"><a id="l00050" name="l00050"></a><span class="lineno">   50</span>  <span class="keyword">auto</span>&amp; ccdbmgr = <a class="code hl_function" href="../../da/d73/classo2_1_1ccdb_1_1BasicCCDBManager.html#a052eb744e07383cae56135d57909cb69">o2::ccdb::BasicCCDBManager::instance</a>();</div>
<div class="line"><a id="l00051" name="l00051"></a><span class="lineno">   51</span>  mTrapConfig = ccdbmgr.getForTimeStamp&lt;<a class="code hl_class" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html">o2::trd::TrapConfig</a>&gt;(<span class="stringliteral">&quot;TRD/TrapConfig/&quot;</span> + mTrapConfigName, timeStamp);</div>
<div class="line"><a id="l00052" name="l00052"></a><span class="lineno">   52</span> </div>
<div class="line"><a id="l00053" name="l00053"></a><span class="lineno">   53</span>  <span class="keywordflow">if</span> (mEnableTrapConfigDump) {</div>
<div class="line"><a id="l00054" name="l00054"></a><span class="lineno">   54</span>    mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#af315cbe9e556dc74386fde7f45e94d95">DumpTrapConfig2File</a>(<span class="stringliteral">&quot;run3trapconfig_dump&quot;</span>);</div>
<div class="line"><a id="l00055" name="l00055"></a><span class="lineno">   55</span>  }</div>
<div class="line"><a id="l00056" name="l00056"></a><span class="lineno">   56</span> </div>
<div class="line"><a id="l00057" name="l00057"></a><span class="lineno">   57</span>  <span class="keywordflow">if</span> (mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ad4b9685a158c8eacb7fc31da15881be0">getConfigName</a>() == <span class="stringliteral">&quot;&quot;</span> &amp;&amp; mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ab7277ae2ae664f93726348f1cac106b0">getConfigVersion</a>() == <span class="stringliteral">&quot;&quot;</span>) {</div>
<div class="line"><a id="l00058" name="l00058"></a><span class="lineno">   58</span>    <span class="comment">//some trap configs dont have config name and version set, in those cases, just show the file name used.</span></div>
<div class="line"><a id="l00059" name="l00059"></a><span class="lineno">   59</span>    <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;using TRAPconfig: &quot;</span> &lt;&lt; mTrapConfigName;</div>
<div class="line"><a id="l00060" name="l00060"></a><span class="lineno">   60</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00061" name="l00061"></a><span class="lineno">   61</span>    <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;using TRAPconfig :\&quot;&quot;</span> &lt;&lt; mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ad4b9685a158c8eacb7fc31da15881be0">getConfigName</a>().c_str() &lt;&lt; <span class="stringliteral">&quot;\&quot;.\&quot;&quot;</span> &lt;&lt; mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ab7277ae2ae664f93726348f1cac106b0">getConfigVersion</a>().c_str() &lt;&lt; <span class="stringliteral">&quot;\&quot;&quot;</span>;</div>
<div class="line"><a id="l00062" name="l00062"></a><span class="lineno">   62</span>  }</div>
<div class="line"><a id="l00063" name="l00063"></a><span class="lineno">   63</span>}</div>
<div class="line"><a id="l00064" name="l00064"></a><span class="lineno">   64</span> </div>
<div class="line"><a id="l00065" name="l00065"></a><span class="lineno">   65</span><span class="keywordtype">void</span> TRDDPLTrapSimulatorTask::setOnlineGainTables()</div>
<div class="line"><a id="l00066" name="l00066"></a><span class="lineno">   66</span>{</div>
<div class="line"><a id="l00067" name="l00067"></a><span class="lineno">   67</span>  <span class="comment">//check FGBY from trapconfig.</span></div>
<div class="line"><a id="l00068" name="l00068"></a><span class="lineno">   68</span>  <span class="comment">//check the input parameter of trd-onlinegaincorrection.</span></div>
<div class="line"><a id="l00069" name="l00069"></a><span class="lineno">   69</span>  <span class="comment">//warn if you have chosen a trapconfig with gaincorrections but chosen not to use them.</span></div>
<div class="line"><a id="l00070" name="l00070"></a><span class="lineno">   70</span>  <span class="keywordflow">if</span> (mEnableOnlineGainCorrection) {</div>
<div class="line"><a id="l00071" name="l00071"></a><span class="lineno">   71</span>    <span class="keywordflow">if</span> (mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a963c75e9fe77ae60f801b4a41ed7f34a">getTrapReg</a>(<a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701ca4fb238065019006598da2057da7146a7">TrapConfig::kFGBY</a>) == 0) {</div>
<div class="line"><a id="l00072" name="l00072"></a><span class="lineno">   72</span>      <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(warn) &lt;&lt; <span class="stringliteral">&quot;you have asked to do online gain calibrations but the selected trap config does not have FGBY enabled, so modifying trapconfig to conform to your command line request. OnlineGains will be 1, i.e. no effect.&quot;</span>;</div>
<div class="line"><a id="l00073" name="l00073"></a><span class="lineno">   73</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iDet = 0; iDet &lt; <a class="code hl_variable" href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#aa4b36b565f213708276bdd3b66f0144e">MAXCHAMBER</a>; ++iDet) {</div>
<div class="line"><a id="l00074" name="l00074"></a><span class="lineno">   74</span>        mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a7ceca1ab60cf4bf5f04f9a8bd1e62933">setTrapReg</a>(<a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701ca4fb238065019006598da2057da7146a7">TrapConfig::kFGBY</a>, 1, iDet);</div>
<div class="line"><a id="l00075" name="l00075"></a><span class="lineno">   75</span>      }</div>
<div class="line"><a id="l00076" name="l00076"></a><span class="lineno">   76</span>    }</div>
<div class="line"><a id="l00077" name="l00077"></a><span class="lineno">   77</span>    mCalib-&gt;setOnlineGainTables(mOnlineGainTableName);</div>
<div class="line"><a id="l00078" name="l00078"></a><span class="lineno">   78</span>    <span class="comment">//TODO add some error checking inhere.</span></div>
<div class="line"><a id="l00079" name="l00079"></a><span class="lineno">   79</span>    <span class="comment">// gain factors are per MCM</span></div>
<div class="line"><a id="l00080" name="l00080"></a><span class="lineno">   80</span>    <span class="comment">// allocate the registers accordingly</span></div>
<div class="line"><a id="l00081" name="l00081"></a><span class="lineno">   81</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch = 0; ch &lt; <a class="code hl_variable" href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#a9d646704bed62aeec9cca0476104c642">NADCMCM</a>; ++ch) {</div>
<div class="line"><a id="l00082" name="l00082"></a><span class="lineno">   82</span>      <a class="code hl_enumeration" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">TrapConfig::TrapReg_t</a> regFGAN = (<a class="code hl_enumeration" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">TrapConfig::TrapReg_t</a>)(<a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701ca3d5ce4e5e5690c78fe97cbdcae17418d">TrapConfig::kFGA0</a> + ch);</div>
<div class="line"><a id="l00083" name="l00083"></a><span class="lineno">   83</span>      <a class="code hl_enumeration" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">TrapConfig::TrapReg_t</a> regFGFN = (<a class="code hl_enumeration" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">TrapConfig::TrapReg_t</a>)(<a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701cae0519f54d493015c6b2174c514e98cea">TrapConfig::kFGF0</a> + ch);</div>
<div class="line"><a id="l00084" name="l00084"></a><span class="lineno">   84</span>      mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ac7252f0a461737170ce5a25e440bfbf8">setTrapRegAlloc</a>(regFGAN, <a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ad8de9fb04bd9f7cb4469c0dd7a4b64d4a2c99f81e30f08f2ef2f409e4a73e2712">TrapConfig::kAllocByMCM</a>);</div>
<div class="line"><a id="l00085" name="l00085"></a><span class="lineno">   85</span>      mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ac7252f0a461737170ce5a25e440bfbf8">setTrapRegAlloc</a>(regFGFN, <a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ad8de9fb04bd9f7cb4469c0dd7a4b64d4a2c99f81e30f08f2ef2f409e4a73e2712">TrapConfig::kAllocByMCM</a>);</div>
<div class="line"><a id="l00086" name="l00086"></a><span class="lineno">   86</span>    }</div>
<div class="line"><a id="l00087" name="l00087"></a><span class="lineno">   87</span> </div>
<div class="line"><a id="l00088" name="l00088"></a><span class="lineno">   88</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iDet = 0; iDet &lt; <a class="code hl_variable" href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#aa4b36b565f213708276bdd3b66f0144e">MAXCHAMBER</a>; ++iDet) {</div>
<div class="line"><a id="l00089" name="l00089"></a><span class="lineno">   89</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> nRobs = Geometry::getStack(iDet) == 2 ? Geometry::ROBmaxC0() : Geometry::ROBmaxC1();</div>
<div class="line"><a id="l00090" name="l00090"></a><span class="lineno">   90</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a> = 0; <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a> &lt; nRobs; ++<a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a>) {</div>
<div class="line"><a id="l00091" name="l00091"></a><span class="lineno">   91</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a> = 0; <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a> &lt; <a class="code hl_variable" href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#a67faa598736e3ce6533769d141bb6ac3">NMCMROB</a>; ++<a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a>) {</div>
<div class="line"><a id="l00092" name="l00092"></a><span class="lineno">   92</span>          <span class="comment">// set ADC reference voltage</span></div>
<div class="line"><a id="l00093" name="l00093"></a><span class="lineno">   93</span>          mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a7ceca1ab60cf4bf5f04f9a8bd1e62933">setTrapReg</a>(<a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701cae57a0cb62a5d85f630b0ac970fa970cd">TrapConfig::kADCDAC</a>, mCalib-&gt;getOnlineGainAdcdac(iDet, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a>, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a>), iDet, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a>, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a>);</div>
<div class="line"><a id="l00094" name="l00094"></a><span class="lineno">   94</span>          <span class="comment">// set constants channel-wise</span></div>
<div class="line"><a id="l00095" name="l00095"></a><span class="lineno">   95</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ch = 0; ch &lt; <a class="code hl_variable" href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#a9d646704bed62aeec9cca0476104c642">NADCMCM</a>; ++ch) {</div>
<div class="line"><a id="l00096" name="l00096"></a><span class="lineno">   96</span>            <a class="code hl_enumeration" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">TrapConfig::TrapReg_t</a> regFGAN = (<a class="code hl_enumeration" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">TrapConfig::TrapReg_t</a>)(<a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701ca3d5ce4e5e5690c78fe97cbdcae17418d">TrapConfig::kFGA0</a> + ch);</div>
<div class="line"><a id="l00097" name="l00097"></a><span class="lineno">   97</span>            <a class="code hl_enumeration" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">TrapConfig::TrapReg_t</a> regFGFN = (<a class="code hl_enumeration" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">TrapConfig::TrapReg_t</a>)(<a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701cae0519f54d493015c6b2174c514e98cea">TrapConfig::kFGF0</a> + ch);</div>
<div class="line"><a id="l00098" name="l00098"></a><span class="lineno">   98</span>            mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a7ceca1ab60cf4bf5f04f9a8bd1e62933">setTrapReg</a>(regFGAN, mCalib-&gt;getOnlineGainFGAN(iDet, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a>, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a>, ch), iDet, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a>, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a>);</div>
<div class="line"><a id="l00099" name="l00099"></a><span class="lineno">   99</span>            mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a7ceca1ab60cf4bf5f04f9a8bd1e62933">setTrapReg</a>(regFGFN, mCalib-&gt;getOnlineGainFGFN(iDet, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a>, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a>, ch), iDet, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a>, <a class="code hl_variable" href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a>);</div>
<div class="line"><a id="l00100" name="l00100"></a><span class="lineno">  100</span>          }</div>
<div class="line"><a id="l00101" name="l00101"></a><span class="lineno">  101</span>        }</div>
<div class="line"><a id="l00102" name="l00102"></a><span class="lineno">  102</span>      }</div>
<div class="line"><a id="l00103" name="l00103"></a><span class="lineno">  103</span>    }</div>
<div class="line"><a id="l00104" name="l00104"></a><span class="lineno">  104</span>  } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mTrapConfig-&gt;<a class="code hl_function" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a963c75e9fe77ae60f801b4a41ed7f34a">getTrapReg</a>(<a class="code hl_enumvalue" href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701ca4fb238065019006598da2057da7146a7">TrapConfig::kFGBY</a>) == 1) {</div>
<div class="line"><a id="l00105" name="l00105"></a><span class="lineno">  105</span>    <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(warn) &lt;&lt; <span class="stringliteral">&quot;you have asked to not use online gain calibrations but the selected trap config does have FGBY enabled. Gain calibrations will be 1, i.e. no effect&quot;</span>;</div>
<div class="line"><a id="l00106" name="l00106"></a><span class="lineno">  106</span>  }</div>
<div class="line"><a id="l00107" name="l00107"></a><span class="lineno">  107</span>}</div>
<div class="line"><a id="l00108" name="l00108"></a><span class="lineno">  108</span> </div>
<div class="line"><a id="l00109" name="l00109"></a><span class="lineno">  109</span><span class="keywordtype">void</span> TRDDPLTrapSimulatorTask::processTRAPchips(<span class="keywordtype">int</span>&amp; nTracklets, std::vector&lt;Tracklet64&gt;&amp; trackletsAccum, std::array&lt;TrapSimulator, NMCMHCMAX&gt;&amp; trapSimulators, std::vector&lt;short&gt;&amp; digitCounts, std::vector&lt;int&gt;&amp; digitIndices)</div>
<div class="line"><a id="l00110" name="l00110"></a><span class="lineno">  110</span>{</div>
<div class="line"><a id="l00111" name="l00111"></a><span class="lineno">  111</span>  <span class="comment">// TRAP processing for current half chamber</span></div>
<div class="line"><a id="l00112" name="l00112"></a><span class="lineno">  112</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iTrap = 0; iTrap &lt; <a class="code hl_variable" href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#ae843f9edddf4429afd71769559825a13">NMCMHCMAX</a>; ++iTrap) {</div>
<div class="line"><a id="l00113" name="l00113"></a><span class="lineno">  113</span>    <span class="keywordflow">if</span> (!trapSimulators[iTrap].isDataSet()) {</div>
<div class="line"><a id="l00114" name="l00114"></a><span class="lineno">  114</span>      <span class="keywordflow">continue</span>;</div>
<div class="line"><a id="l00115" name="l00115"></a><span class="lineno">  115</span>    }</div>
<div class="line"><a id="l00116" name="l00116"></a><span class="lineno">  116</span>    trapSimulators[iTrap].setBaselines();</div>
<div class="line"><a id="l00117" name="l00117"></a><span class="lineno">  117</span>    trapSimulators[iTrap].filter();</div>
<div class="line"><a id="l00118" name="l00118"></a><span class="lineno">  118</span>    trapSimulators[iTrap].tracklet();</div>
<div class="line"><a id="l00119" name="l00119"></a><span class="lineno">  119</span>    <span class="keyword">auto</span> trackletsOut = trapSimulators[iTrap].getTrackletArray64();</div>
<div class="line"><a id="l00120" name="l00120"></a><span class="lineno">  120</span>    nTracklets += trackletsOut.size();</div>
<div class="line"><a id="l00121" name="l00121"></a><span class="lineno">  121</span>    trackletsAccum.insert(trackletsAccum.end(), trackletsOut.begin(), trackletsOut.end());</div>
<div class="line"><a id="l00122" name="l00122"></a><span class="lineno">  122</span>    <span class="keywordflow">if</span> (mUseMC) {</div>
<div class="line"><a id="l00123" name="l00123"></a><span class="lineno">  123</span>      <span class="keyword">auto</span> digitCountOut = trapSimulators[iTrap].getTrackletDigitCount();</div>
<div class="line"><a id="l00124" name="l00124"></a><span class="lineno">  124</span>      digitCounts.insert(digitCounts.end(), digitCountOut.begin(), digitCountOut.end());</div>
<div class="line"><a id="l00125" name="l00125"></a><span class="lineno">  125</span>      <span class="keyword">auto</span> digitIndicesOut = trapSimulators[iTrap].getTrackletDigitIndices();</div>
<div class="line"><a id="l00126" name="l00126"></a><span class="lineno">  126</span>      digitIndices.insert(digitIndices.end(), digitIndicesOut.begin(), digitIndicesOut.end());</div>
<div class="line"><a id="l00127" name="l00127"></a><span class="lineno">  127</span>    }</div>
<div class="line"><a id="l00128" name="l00128"></a><span class="lineno">  128</span>    trapSimulators[iTrap].reset();</div>
<div class="line"><a id="l00129" name="l00129"></a><span class="lineno">  129</span>  }</div>
<div class="line"><a id="l00130" name="l00130"></a><span class="lineno">  130</span>}</div>
<div class="line"><a id="l00131" name="l00131"></a><span class="lineno">  131</span> </div>
<div class="foldopen" id="foldopen00132" data-start="{" data-end="}">
<div class="line"><a id="l00132" name="l00132"></a><span class="lineno"><a class="line" href="../../d3/dfd/classo2_1_1trd_1_1TRDDPLTrapSimulatorTask.html#a8d6c53494345b316da9f39c6fc18c170">  132</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d3/dfd/classo2_1_1trd_1_1TRDDPLTrapSimulatorTask.html#a8d6c53494345b316da9f39c6fc18c170">TRDDPLTrapSimulatorTask::init</a>(<a class="code hl_class" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html">o2::framework::InitContext</a>&amp; ic)</div>
<div class="line"><a id="l00133" name="l00133"></a><span class="lineno">  133</span>{</div>
<div class="line"><a id="l00134" name="l00134"></a><span class="lineno">  134</span>  mTrapConfigName = ic.<a class="code hl_function" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#ada83dc23c159df009861ac98633eefe6">options</a>().<a class="code hl_function" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;std::string&gt;(<span class="stringliteral">&quot;trd-trapconfig&quot;</span>);</div>
<div class="line"><a id="l00135" name="l00135"></a><span class="lineno">  135</span>  mEnableOnlineGainCorrection = ic.<a class="code hl_function" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#ada83dc23c159df009861ac98633eefe6">options</a>().<a class="code hl_function" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;trd-onlinegaincorrection&quot;</span>);</div>
<div class="line"><a id="l00136" name="l00136"></a><span class="lineno">  136</span>  mOnlineGainTableName = ic.<a class="code hl_function" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#ada83dc23c159df009861ac98633eefe6">options</a>().<a class="code hl_function" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;std::string&gt;(<span class="stringliteral">&quot;trd-onlinegaintable&quot;</span>);</div>
<div class="line"><a id="l00137" name="l00137"></a><span class="lineno">  137</span>  mRunNumber = ic.<a class="code hl_function" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#ada83dc23c159df009861ac98633eefe6">options</a>().<a class="code hl_function" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;trd-runnum&quot;</span>);</div>
<div class="line"><a id="l00138" name="l00138"></a><span class="lineno">  138</span>  mEnableTrapConfigDump = ic.<a class="code hl_function" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#ada83dc23c159df009861ac98633eefe6">options</a>().<a class="code hl_function" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;trd-dumptrapconfig&quot;</span>);</div>
<div class="line"><a id="l00139" name="l00139"></a><span class="lineno">  139</span>  mUseFloatingPointForQ = ic.<a class="code hl_function" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#ada83dc23c159df009861ac98633eefe6">options</a>().<a class="code hl_function" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;<span class="keywordtype">bool</span>&gt;(<span class="stringliteral">&quot;float-arithmetic&quot;</span>);</div>
<div class="line"><a id="l00140" name="l00140"></a><span class="lineno">  140</span>  mChargeScalingFactor = ic.<a class="code hl_function" href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#ada83dc23c159df009861ac98633eefe6">options</a>().<a class="code hl_function" href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">get</a>&lt;<span class="keywordtype">int</span>&gt;(<span class="stringliteral">&quot;scale-q&quot;</span>);</div>
<div class="line"><a id="l00141" name="l00141"></a><span class="lineno">  141</span>  <span class="keywordflow">if</span> (mChargeScalingFactor != -1) {</div>
<div class="line"><a id="l00142" name="l00142"></a><span class="lineno">  142</span>    <span class="keywordflow">if</span> (mChargeScalingFactor &lt; 1) {</div>
<div class="line"><a id="l00143" name="l00143"></a><span class="lineno">  143</span>      <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(error) &lt;&lt; <span class="stringliteral">&quot;Charge scaling factor &lt; 1 defined. Setting it to 1&quot;</span>;</div>
<div class="line"><a id="l00144" name="l00144"></a><span class="lineno">  144</span>      <span class="comment">// careful, scaling factor is an int! actuallty values smaller than 3 don&#39;t yield a valid factor since scaling factor = 2^32 / 3</span></div>
<div class="line"><a id="l00145" name="l00145"></a><span class="lineno">  145</span>      mChargeScalingFactor = 1;</div>
<div class="line"><a id="l00146" name="l00146"></a><span class="lineno">  146</span>    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mChargeScalingFactor &gt; 1024) {</div>
<div class="line"><a id="l00147" name="l00147"></a><span class="lineno">  147</span>      <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(error) &lt;&lt; <span class="stringliteral">&quot;Charge scaling factor &gt; 1024 defined. Setting it to 1024&quot;</span>;</div>
<div class="line"><a id="l00148" name="l00148"></a><span class="lineno">  148</span>      <span class="comment">// no technical reason, but with 10 bit ADC values 1024 is already way to high for scaling...</span></div>
<div class="line"><a id="l00149" name="l00149"></a><span class="lineno">  149</span>      mChargeScalingFactor = 1024;</div>
<div class="line"><a id="l00150" name="l00150"></a><span class="lineno">  150</span>    }</div>
<div class="line"><a id="l00151" name="l00151"></a><span class="lineno">  151</span>  }</div>
<div class="line"><a id="l00152" name="l00152"></a><span class="lineno">  152</span>  <span class="keywordflow">if</span> (mUseFloatingPointForQ) {</div>
<div class="line"><a id="l00153" name="l00153"></a><span class="lineno">  153</span>    <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Tracklet charges will be calculated using floating point arithmetic&quot;</span>;</div>
<div class="line"><a id="l00154" name="l00154"></a><span class="lineno">  154</span>    <span class="keywordflow">if</span> (mChargeScalingFactor != -1) {</div>
<div class="line"><a id="l00155" name="l00155"></a><span class="lineno">  155</span>      <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(error) &lt;&lt; <span class="stringliteral">&quot;Charge scaling factor defined, but floating point arithmetic configured. Charge scaling has no effect&quot;</span>;</div>
<div class="line"><a id="l00156" name="l00156"></a><span class="lineno">  156</span>    }</div>
<div class="line"><a id="l00157" name="l00157"></a><span class="lineno">  157</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00158" name="l00158"></a><span class="lineno">  158</span>    <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Tracklet charges will be calculated using a fixed multiplier&quot;</span>;</div>
<div class="line"><a id="l00159" name="l00159"></a><span class="lineno">  159</span>  }</div>
<div class="line"><a id="l00160" name="l00160"></a><span class="lineno">  160</span> </div>
<div class="line"><a id="l00161" name="l00161"></a><span class="lineno">  161</span><span class="preprocessor">#ifdef WITH_OPENMP</span></div>
<div class="line"><a id="l00162" name="l00162"></a><span class="lineno">  162</span>  <span class="keywordtype">int</span> askedThreads = <a class="code hl_function" href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#a8c7d4cc9dc1f34d578b77cc5d6cf1df0">TRDSimParams::Instance</a>().digithreads;</div>
<div class="line"><a id="l00163" name="l00163"></a><span class="lineno">  163</span>  <span class="keywordtype">int</span> maxThreads = omp_get_max_threads();</div>
<div class="line"><a id="l00164" name="l00164"></a><span class="lineno">  164</span>  <span class="keywordflow">if</span> (askedThreads &lt; 0) {</div>
<div class="line"><a id="l00165" name="l00165"></a><span class="lineno">  165</span>    mNumThreads = maxThreads;</div>
<div class="line"><a id="l00166" name="l00166"></a><span class="lineno">  166</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00167" name="l00167"></a><span class="lineno">  167</span>    mNumThreads = std::min(maxThreads, askedThreads);</div>
<div class="line"><a id="l00168" name="l00168"></a><span class="lineno">  168</span>  }</div>
<div class="line"><a id="l00169" name="l00169"></a><span class="lineno">  169</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Trap simulation running with &quot;</span> &lt;&lt; mNumThreads &lt;&lt; <span class="stringliteral">&quot; threads &quot;</span>;</div>
<div class="line"><a id="l00170" name="l00170"></a><span class="lineno">  170</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00171" name="l00171"></a><span class="lineno">  171</span>}</div>
</div>
<div class="line"><a id="l00172" name="l00172"></a><span class="lineno">  172</span> </div>
<div class="foldopen" id="foldopen00173" data-start="{" data-end="}">
<div class="line"><a id="l00173" name="l00173"></a><span class="lineno"><a class="line" href="../../d3/dfd/classo2_1_1trd_1_1TRDDPLTrapSimulatorTask.html#a6ad5763aa5229d5a2f0bdb76c0427b0d">  173</a></span><span class="keywordtype">void</span> <a class="code hl_function" href="../../d3/dfd/classo2_1_1trd_1_1TRDDPLTrapSimulatorTask.html#a6ad5763aa5229d5a2f0bdb76c0427b0d">TRDDPLTrapSimulatorTask::run</a>(<a class="code hl_class" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html">o2::framework::ProcessingContext</a>&amp; pc)</div>
<div class="line"><a id="l00174" name="l00174"></a><span class="lineno">  174</span>{</div>
<div class="line"><a id="l00175" name="l00175"></a><span class="lineno">  175</span>  <span class="comment">// this method steeres the processing of the TRAP simulation</span></div>
<div class="line"><a id="l00176" name="l00176"></a><span class="lineno">  176</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;TRD Trap Simulator Device running over incoming message&quot;</span>;</div>
<div class="line"><a id="l00177" name="l00177"></a><span class="lineno">  177</span> </div>
<div class="line"><a id="l00178" name="l00178"></a><span class="lineno">  178</span>  <span class="keywordflow">if</span> (!mInitCcdbObjectsDone) {</div>
<div class="line"><a id="l00179" name="l00179"></a><span class="lineno">  179</span>    <span class="keyword">auto</span> creationTime = pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#aa236d4d55c7ef46fe86a822195ea00b0">services</a>().<a class="code hl_function" href="../../d7/da4/classo2_1_1framework_1_1ServiceRegistryRef.html#ab34ff207fce452a23aa9170d6a5c35aa">get</a>&lt;<a class="code hl_struct" href="../../d4/d11/structo2_1_1framework_1_1TimingInfo.html">o2::framework::TimingInfo</a>&gt;().creation;</div>
<div class="line"><a id="l00180" name="l00180"></a><span class="lineno">  180</span>    <span class="keyword">auto</span> timeStamp = (mRunNumber &lt; 0) ? creationTime : mRunNumber;</div>
<div class="line"><a id="l00181" name="l00181"></a><span class="lineno">  181</span>    mCalib = std::make_unique&lt;Calibrations&gt;();</div>
<div class="line"><a id="l00182" name="l00182"></a><span class="lineno">  182</span>    mCalib-&gt;getCCDBObjects(timeStamp);</div>
<div class="line"><a id="l00183" name="l00183"></a><span class="lineno">  183</span>    initTrapConfig(timeStamp);</div>
<div class="line"><a id="l00184" name="l00184"></a><span class="lineno">  184</span>    setOnlineGainTables();</div>
<div class="line"><a id="l00185" name="l00185"></a><span class="lineno">  185</span>    mInitCcdbObjectsDone = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00186" name="l00186"></a><span class="lineno">  186</span>  }</div>
<div class="line"><a id="l00187" name="l00187"></a><span class="lineno">  187</span> </div>
<div class="line"><a id="l00188" name="l00188"></a><span class="lineno">  188</span>  <span class="comment">// input</span></div>
<div class="line"><a id="l00189" name="l00189"></a><span class="lineno">  189</span>  <span class="keyword">auto</span> <a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a> = pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a7862af0201c6d6a574a054d811f0eab3">inputs</a>().<a class="code hl_function" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;gsl::span&lt;o2::trd::Digit&gt;&gt;(<span class="stringliteral">&quot;digitinput&quot;</span>);                       <span class="comment">// block of TRD digits</span></div>
<div class="line"><a id="l00190" name="l00190"></a><span class="lineno">  190</span>  <span class="keyword">auto</span> triggerRecords = pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a7862af0201c6d6a574a054d811f0eab3">inputs</a>().<a class="code hl_function" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;std::vector&lt;o2::trd::TriggerRecord&gt;&gt;(<span class="stringliteral">&quot;triggerrecords&quot;</span>); <span class="comment">// time and number of digits for each collision</span></div>
<div class="line"><a id="l00191" name="l00191"></a><span class="lineno">  191</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(<a class="code hl_variable" href="../../d4/d67/VariantJSONHelpers_8cxx.html#a92b9653745b1ddd58664de621c944ba2">debug</a>) &lt;&lt; <span class="stringliteral">&quot;Received &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>.size() &lt;&lt; <span class="stringliteral">&quot; digits from &quot;</span> &lt;&lt; triggerRecords.size() &lt;&lt; <span class="stringliteral">&quot; collisions&quot;</span>;</div>
<div class="line"><a id="l00192" name="l00192"></a><span class="lineno">  192</span> </div>
<div class="line"><a id="l00193" name="l00193"></a><span class="lineno">  193</span>  <span class="comment">// load MC information if label processing is enabeld</span></div>
<div class="line"><a id="l00194" name="l00194"></a><span class="lineno">  194</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html">o2::dataformats::ConstMCTruthContainer&lt;o2::MCCompLabel&gt;</a>* lblDigitsPtr = <span class="keyword">nullptr</span>;</div>
<div class="line"><a id="l00195" name="l00195"></a><span class="lineno">  195</span>  <span class="keyword">using </span>lblType = std::decay_t&lt;<span class="keyword">decltype</span>(pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a7862af0201c6d6a574a054d811f0eab3">inputs</a>().<a class="code hl_function" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;<a class="code hl_class" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html">o2::dataformats::ConstMCTruthContainer&lt;o2::MCCompLabel&gt;</a>&gt;(<span class="stringliteral">&quot;&quot;</span>))&gt;;</div>
<div class="line"><a id="l00196" name="l00196"></a><span class="lineno">  196</span>  std::optional&lt;lblType&gt; lblDigits;</div>
<div class="line"><a id="l00197" name="l00197"></a><span class="lineno">  197</span>  <span class="keywordflow">if</span> (mUseMC) {</div>
<div class="line"><a id="l00198" name="l00198"></a><span class="lineno">  198</span>    lblDigits.emplace(pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a7862af0201c6d6a574a054d811f0eab3">inputs</a>().<a class="code hl_function" href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">get</a>&lt;<a class="code hl_class" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html">o2::dataformats::ConstMCTruthContainer&lt;o2::MCCompLabel&gt;</a>&gt;(<span class="stringliteral">&quot;labelinput&quot;</span>)); <span class="comment">// MC labels associated to the input digits</span></div>
<div class="line"><a id="l00199" name="l00199"></a><span class="lineno">  199</span>    lblDigitsPtr = &amp;lblDigits.value();</div>
<div class="line"><a id="l00200" name="l00200"></a><span class="lineno">  200</span>    <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(<a class="code hl_variable" href="../../d4/d67/VariantJSONHelpers_8cxx.html#a92b9653745b1ddd58664de621c944ba2">debug</a>) &lt;&lt; <span class="stringliteral">&quot;Labels contain &quot;</span> &lt;&lt; lblDigitsPtr-&gt;<a class="code hl_function" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#a0d3692ce6fe618d98104faae490a819a">getNElements</a>() &lt;&lt; <span class="stringliteral">&quot; elements with and indexed size of &quot;</span> &lt;&lt; lblDigitsPtr-&gt;<a class="code hl_function" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#afe41ba5bbdb1062a85b597648bf1b939">getIndexedSize</a>();</div>
<div class="line"><a id="l00201" name="l00201"></a><span class="lineno">  201</span>    <span class="keywordflow">if</span> (lblDigitsPtr-&gt;<a class="code hl_function" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#afe41ba5bbdb1062a85b597648bf1b939">getIndexedSize</a>() != <a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>.size()) {</div>
<div class="line"><a id="l00202" name="l00202"></a><span class="lineno">  202</span>      <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(warn) &lt;&lt; <span class="stringliteral">&quot;Digits and Labels coming into TrapSimulator are of differing sizes, labels will be jibberish. &quot;</span> &lt;&lt; lblDigitsPtr-&gt;<a class="code hl_function" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#afe41ba5bbdb1062a85b597648bf1b939">getIndexedSize</a>() &lt;&lt; <span class="stringliteral">&quot;!=&quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>.size();</div>
<div class="line"><a id="l00203" name="l00203"></a><span class="lineno">  203</span>    }</div>
<div class="line"><a id="l00204" name="l00204"></a><span class="lineno">  204</span>  }</div>
<div class="line"><a id="l00205" name="l00205"></a><span class="lineno">  205</span> </div>
<div class="line"><a id="l00206" name="l00206"></a><span class="lineno">  206</span>  <span class="comment">// output</span></div>
<div class="line"><a id="l00207" name="l00207"></a><span class="lineno">  207</span>  std::vector&lt;Digit&gt; digitsOut;                                    <span class="comment">// in case downscaling is applied this vector keeps the digits which should not be removed</span></div>
<div class="line"><a id="l00208" name="l00208"></a><span class="lineno">  208</span>  std::vector&lt;Tracklet64&gt; <a class="code hl_variable" href="../../da/d7d/test__ctf__io__trd_8cxx.html#a9aeeaf1bfaf6b795ce504b3e0f071c8c">tracklets</a>;                               <span class="comment">// calculated tracklets</span></div>
<div class="line"><a id="l00209" name="l00209"></a><span class="lineno">  209</span>  <a class="code hl_class" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer&lt;o2::MCCompLabel&gt;</a> lblTracklets; <span class="comment">// MC labels for the tracklets, taken from the digits which make up the tracklet (duplicates are removed)</span></div>
<div class="line"><a id="l00210" name="l00210"></a><span class="lineno">  210</span> </div>
<div class="line"><a id="l00211" name="l00211"></a><span class="lineno">  211</span>  <span class="keyword">auto</span> timeProcessingStart = std::chrono::high_resolution_clock::now(); <span class="comment">// measure total processing time</span></div>
<div class="line"><a id="l00212" name="l00212"></a><span class="lineno">  212</span> </div>
<div class="line"><a id="l00213" name="l00213"></a><span class="lineno">  213</span>  <span class="comment">// sort digits by half chamber ID for each collision and keep track in index vector</span></div>
<div class="line"><a id="l00214" name="l00214"></a><span class="lineno">  214</span>  <span class="keyword">auto</span> sortStart = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a id="l00215" name="l00215"></a><span class="lineno">  215</span>  std::vector&lt;unsigned int&gt; digitIdxArray(<a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>.size()); <span class="comment">// digit indices sorted by half chamber ID for each time frame</span></div>
<div class="line"><a id="l00216" name="l00216"></a><span class="lineno">  216</span>  std::iota(digitIdxArray.begin(), digitIdxArray.end(), 0);</div>
<div class="line"><a id="l00217" name="l00217"></a><span class="lineno">  217</span>  <span class="keywordflow">for</span> (<span class="keyword">auto</span>&amp; trig : triggerRecords) {</div>
<div class="line"><a id="l00218" name="l00218"></a><span class="lineno">  218</span>    std::stable_sort(std::begin(digitIdxArray) + trig.getFirstDigit(), std::begin(digitIdxArray) + trig.getNumberOfDigits() + trig.getFirstDigit(),</div>
<div class="line"><a id="l00219" name="l00219"></a><span class="lineno">  219</span>                     [&amp;<a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>](<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a>, <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a>) { return digits[i].getHCId() &lt; digits[j].getHCId(); });</div>
<div class="line"><a id="l00220" name="l00220"></a><span class="lineno">  220</span>  }</div>
<div class="line"><a id="l00221" name="l00221"></a><span class="lineno">  221</span>  <span class="keyword">auto</span> sortTime = std::chrono::high_resolution_clock::now() - sortStart;</div>
<div class="line"><a id="l00222" name="l00222"></a><span class="lineno">  222</span> </div>
<div class="line"><a id="l00223" name="l00223"></a><span class="lineno">  223</span>  <span class="comment">// prepare data structures for accumulating results per collision</span></div>
<div class="line"><a id="l00224" name="l00224"></a><span class="lineno">  224</span>  std::vector&lt;int&gt; nTracklets(triggerRecords.size());</div>
<div class="line"><a id="l00225" name="l00225"></a><span class="lineno">  225</span>  std::vector&lt;std::vector&lt;Tracklet64&gt;&gt; trackletsAccum;</div>
<div class="line"><a id="l00226" name="l00226"></a><span class="lineno">  226</span>  trackletsAccum.resize(triggerRecords.size());</div>
<div class="line"><a id="l00227" name="l00227"></a><span class="lineno">  227</span>  std::vector&lt;std::vector&lt;short&gt;&gt; digitCountsAccum; <span class="comment">// holds the number of digits included in each tracklet (therefore has the same number of elements as trackletsAccum)</span></div>
<div class="line"><a id="l00228" name="l00228"></a><span class="lineno">  228</span>  <span class="comment">// digitIndicesAccum holds the global indices of the digits which comprise the tracklets</span></div>
<div class="line"><a id="l00229" name="l00229"></a><span class="lineno">  229</span>  <span class="comment">// with the help of digitCountsAccum one can loop through this vector and find the corresponding digit indices for each tracklet</span></div>
<div class="line"><a id="l00230" name="l00230"></a><span class="lineno">  230</span>  std::vector&lt;std::vector&lt;int&gt;&gt; digitIndicesAccum;</div>
<div class="line"><a id="l00231" name="l00231"></a><span class="lineno">  231</span>  digitCountsAccum.resize(triggerRecords.size());</div>
<div class="line"><a id="l00232" name="l00232"></a><span class="lineno">  232</span>  digitIndicesAccum.resize(triggerRecords.size());</div>
<div class="line"><a id="l00233" name="l00233"></a><span class="lineno">  233</span> </div>
<div class="line"><a id="l00234" name="l00234"></a><span class="lineno">  234</span>  <span class="keyword">auto</span> timeParallelStart = std::chrono::high_resolution_clock::now();</div>
<div class="line"><a id="l00235" name="l00235"></a><span class="lineno">  235</span> </div>
<div class="line"><a id="l00236" name="l00236"></a><span class="lineno">  236</span><span class="preprocessor">#ifdef WITH_OPENMP</span></div>
<div class="line"><a id="l00237" name="l00237"></a><span class="lineno">  237</span><span class="preprocessor">#pragma omp parallel for schedule(dynamic) num_threads(mNumThreads)</span></div>
<div class="line"><a id="l00238" name="l00238"></a><span class="lineno">  238</span><span class="preprocessor">#endif</span></div>
<div class="line"><a id="l00239" name="l00239"></a><span class="lineno">  239</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iTrig = 0; iTrig &lt; triggerRecords.size(); ++iTrig) {</div>
<div class="line"><a id="l00240" name="l00240"></a><span class="lineno">  240</span>    <span class="keywordtype">int</span> currHCId = -1;</div>
<div class="line"><a id="l00241" name="l00241"></a><span class="lineno">  241</span>    std::array&lt;TrapSimulator, NMCMHCMAX&gt; trapSimulators{}; <span class="comment">//the up to 64 trap simulators for a single half chamber</span></div>
<div class="line"><a id="l00242" name="l00242"></a><span class="lineno">  242</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iDigit = triggerRecords[iTrig].getFirstDigit(); iDigit &lt; (triggerRecords[iTrig].getFirstDigit() + triggerRecords[iTrig].getNumberOfDigits()); ++iDigit) {</div>
<div class="line"><a id="l00243" name="l00243"></a><span class="lineno">  243</span>      <span class="keyword">const</span> <span class="keyword">auto</span>&amp; digit = &amp;<a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>[digitIdxArray[iDigit]];</div>
<div class="line"><a id="l00244" name="l00244"></a><span class="lineno">  244</span>      <span class="keywordflow">if</span> (currHCId &lt; 0) {</div>
<div class="line"><a id="l00245" name="l00245"></a><span class="lineno">  245</span>        currHCId = digit-&gt;getHCId();</div>
<div class="line"><a id="l00246" name="l00246"></a><span class="lineno">  246</span>      }</div>
<div class="line"><a id="l00247" name="l00247"></a><span class="lineno">  247</span>      <span class="keywordflow">if</span> (currHCId != digit-&gt;getHCId()) {</div>
<div class="line"><a id="l00248" name="l00248"></a><span class="lineno">  248</span>        <span class="comment">// we switch to a new half chamber, process all TRAPs of the previous half chamber which contain data</span></div>
<div class="line"><a id="l00249" name="l00249"></a><span class="lineno">  249</span>        processTRAPchips(nTracklets[iTrig], trackletsAccum[iTrig], trapSimulators, digitCountsAccum[iTrig], digitIndicesAccum[iTrig]);</div>
<div class="line"><a id="l00250" name="l00250"></a><span class="lineno">  250</span>        currHCId = digit-&gt;getHCId();</div>
<div class="line"><a id="l00251" name="l00251"></a><span class="lineno">  251</span>      }</div>
<div class="line"><a id="l00252" name="l00252"></a><span class="lineno">  252</span>      <span class="comment">// fill the digit data into the corresponding TRAP chip</span></div>
<div class="line"><a id="l00253" name="l00253"></a><span class="lineno">  253</span>      <span class="keywordtype">int</span> trapIdx = (digit-&gt;getROB() / 2) * <a class="code hl_variable" href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#a67faa598736e3ce6533769d141bb6ac3">NMCMROB</a> + digit-&gt;getMCM();</div>
<div class="line"><a id="l00254" name="l00254"></a><span class="lineno">  254</span>      <span class="keywordflow">if</span> (!trapSimulators[trapIdx].isDataSet()) {</div>
<div class="line"><a id="l00255" name="l00255"></a><span class="lineno">  255</span>        trapSimulators[trapIdx].init(mTrapConfig, digit-&gt;getDetector(), digit-&gt;getROB(), digit-&gt;getMCM());</div>
<div class="line"><a id="l00256" name="l00256"></a><span class="lineno">  256</span>        <span class="keywordflow">if</span> (mUseFloatingPointForQ) {</div>
<div class="line"><a id="l00257" name="l00257"></a><span class="lineno">  257</span>          trapSimulators[trapIdx].setUseFloatingPointForQ();</div>
<div class="line"><a id="l00258" name="l00258"></a><span class="lineno">  258</span>        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mChargeScalingFactor != -1) {</div>
<div class="line"><a id="l00259" name="l00259"></a><span class="lineno">  259</span>          trapSimulators[trapIdx].setChargeScalingFactor(mChargeScalingFactor);</div>
<div class="line"><a id="l00260" name="l00260"></a><span class="lineno">  260</span>        }</div>
<div class="line"><a id="l00261" name="l00261"></a><span class="lineno">  261</span>      }</div>
<div class="line"><a id="l00262" name="l00262"></a><span class="lineno">  262</span>      <span class="keywordflow">if</span> (digit-&gt;getChannel() != 22) {</div>
<div class="line"><a id="l00263" name="l00263"></a><span class="lineno">  263</span>        <span class="comment">// 22 signals invalid digit read by raw reader</span></div>
<div class="line"><a id="l00264" name="l00264"></a><span class="lineno">  264</span>        trapSimulators[trapIdx].setData(digit-&gt;getChannel(), digit-&gt;getADC(), digitIdxArray[iDigit]);</div>
<div class="line"><a id="l00265" name="l00265"></a><span class="lineno">  265</span>      }</div>
<div class="line"><a id="l00266" name="l00266"></a><span class="lineno">  266</span>    }</div>
<div class="line"><a id="l00267" name="l00267"></a><span class="lineno">  267</span>    <span class="comment">// take care of the TRAPs for the last half chamber</span></div>
<div class="line"><a id="l00268" name="l00268"></a><span class="lineno">  268</span>    processTRAPchips(nTracklets[iTrig], trackletsAccum[iTrig], trapSimulators, digitCountsAccum[iTrig], digitIndicesAccum[iTrig]);</div>
<div class="line"><a id="l00269" name="l00269"></a><span class="lineno">  269</span>  } <span class="comment">// done with parallel processing</span></div>
<div class="line"><a id="l00270" name="l00270"></a><span class="lineno">  270</span>  <span class="keyword">auto</span> parallelTime = std::chrono::high_resolution_clock::now() - timeParallelStart;</div>
<div class="line"><a id="l00271" name="l00271"></a><span class="lineno">  271</span> </div>
<div class="line"><a id="l00272" name="l00272"></a><span class="lineno">  272</span>  <span class="comment">// accumulate results and add MC labels</span></div>
<div class="line"><a id="l00273" name="l00273"></a><span class="lineno">  273</span>  <span class="keywordtype">int</span> nDigitsRejected = 0;</div>
<div class="line"><a id="l00274" name="l00274"></a><span class="lineno">  274</span>  <span class="keywordflow">for</span> (<span class="keywordtype">size_t</span> iTrig = 0; iTrig &lt; triggerRecords.size(); ++iTrig) {</div>
<div class="line"><a id="l00275" name="l00275"></a><span class="lineno">  275</span>    <span class="keywordflow">if</span> (mUseMC) {</div>
<div class="line"><a id="l00276" name="l00276"></a><span class="lineno">  276</span>      <span class="keywordtype">int</span> currDigitIndex = 0; <span class="comment">// counter for all digits which are associated to tracklets</span></div>
<div class="line"><a id="l00277" name="l00277"></a><span class="lineno">  277</span>      <span class="keywordtype">int</span> trkltIdxStart = <a class="code hl_variable" href="../../da/d7d/test__ctf__io__trd_8cxx.html#a9aeeaf1bfaf6b795ce504b3e0f071c8c">tracklets</a>.size();</div>
<div class="line"><a id="l00278" name="l00278"></a><span class="lineno">  278</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iTrklt = 0; iTrklt &lt; nTracklets[iTrig]; ++iTrklt) {</div>
<div class="line"><a id="l00279" name="l00279"></a><span class="lineno">  279</span>        <span class="keywordtype">int</span> tmp = currDigitIndex;</div>
<div class="line"><a id="l00280" name="l00280"></a><span class="lineno">  280</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iDigitIndex = tmp; iDigitIndex &lt; tmp + digitCountsAccum[iTrig][iTrklt]; ++iDigitIndex) {</div>
<div class="line"><a id="l00281" name="l00281"></a><span class="lineno">  281</span>          <span class="keywordflow">if</span> (iDigitIndex == tmp) {</div>
<div class="line"><a id="l00282" name="l00282"></a><span class="lineno">  282</span>            <span class="comment">// for the first digit composing the tracklet we don&#39;t need to check for duplicate labels</span></div>
<div class="line"><a id="l00283" name="l00283"></a><span class="lineno">  283</span>            lblTracklets.<a class="code hl_function" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a528292fd3fb667273f0fa29973bd56de">addElements</a>(trkltIdxStart + iTrklt, lblDigitsPtr-&gt;<a class="code hl_function" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#aecc0c7f7c16a425b1165e2f72c00a625">getLabels</a>(digitIndicesAccum[iTrig][iDigitIndex]));</div>
<div class="line"><a id="l00284" name="l00284"></a><span class="lineno">  284</span>          } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00285" name="l00285"></a><span class="lineno">  285</span>            <span class="comment">// in case more than one digit composes the tracklet we add only the labels</span></div>
<div class="line"><a id="l00286" name="l00286"></a><span class="lineno">  286</span>            <span class="comment">// from the additional digit(s) which are not already contained in the previous</span></div>
<div class="line"><a id="l00287" name="l00287"></a><span class="lineno">  287</span>            <span class="comment">// digit(s)</span></div>
<div class="line"><a id="l00288" name="l00288"></a><span class="lineno">  288</span>            <span class="keyword">auto</span> currentLabels = lblTracklets.<a class="code hl_function" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a05115beedbb77c0be74f7d142e514259">getLabels</a>(trkltIdxStart + iTrklt);</div>
<div class="line"><a id="l00289" name="l00289"></a><span class="lineno">  289</span>            <span class="keyword">auto</span> newLabels = lblDigitsPtr-&gt;<a class="code hl_function" href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#aecc0c7f7c16a425b1165e2f72c00a625">getLabels</a>(digitIndicesAccum[iTrig][iDigitIndex]);</div>
<div class="line"><a id="l00290" name="l00290"></a><span class="lineno">  290</span>            <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; newLabel : newLabels) {</div>
<div class="line"><a id="l00291" name="l00291"></a><span class="lineno">  291</span>              <span class="keywordtype">bool</span> alreadyIn = <span class="keyword">false</span>;</div>
<div class="line"><a id="l00292" name="l00292"></a><span class="lineno">  292</span>              <span class="keywordflow">for</span> (<span class="keyword">const</span> <span class="keyword">auto</span>&amp; currLabel : currentLabels) {</div>
<div class="line"><a id="l00293" name="l00293"></a><span class="lineno">  293</span>                <span class="keywordflow">if</span> (currLabel == newLabel) {</div>
<div class="line"><a id="l00294" name="l00294"></a><span class="lineno">  294</span>                  alreadyIn = <span class="keyword">true</span>;</div>
<div class="line"><a id="l00295" name="l00295"></a><span class="lineno">  295</span>                  <span class="keywordflow">break</span>;</div>
<div class="line"><a id="l00296" name="l00296"></a><span class="lineno">  296</span>                }</div>
<div class="line"><a id="l00297" name="l00297"></a><span class="lineno">  297</span>              }</div>
<div class="line"><a id="l00298" name="l00298"></a><span class="lineno">  298</span>              <span class="keywordflow">if</span> (!alreadyIn) {</div>
<div class="line"><a id="l00299" name="l00299"></a><span class="lineno">  299</span>                lblTracklets.<a class="code hl_function" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a583de4d505501ba4a836edbc135b948e">addElement</a>(trkltIdxStart + iTrklt, newLabel);</div>
<div class="line"><a id="l00300" name="l00300"></a><span class="lineno">  300</span>              }</div>
<div class="line"><a id="l00301" name="l00301"></a><span class="lineno">  301</span>            }</div>
<div class="line"><a id="l00302" name="l00302"></a><span class="lineno">  302</span>          }</div>
<div class="line"><a id="l00303" name="l00303"></a><span class="lineno">  303</span>          ++currDigitIndex;</div>
<div class="line"><a id="l00304" name="l00304"></a><span class="lineno">  304</span>        }</div>
<div class="line"><a id="l00305" name="l00305"></a><span class="lineno">  305</span>      }</div>
<div class="line"><a id="l00306" name="l00306"></a><span class="lineno">  306</span>    }</div>
<div class="line"><a id="l00307" name="l00307"></a><span class="lineno">  307</span>    <a class="code hl_variable" href="../../da/d7d/test__ctf__io__trd_8cxx.html#a9aeeaf1bfaf6b795ce504b3e0f071c8c">tracklets</a>.insert(<a class="code hl_variable" href="../../da/d7d/test__ctf__io__trd_8cxx.html#a9aeeaf1bfaf6b795ce504b3e0f071c8c">tracklets</a>.end(), trackletsAccum[iTrig].begin(), trackletsAccum[iTrig].end());</div>
<div class="line"><a id="l00308" name="l00308"></a><span class="lineno">  308</span>    triggerRecords[iTrig].setTrackletRange(<a class="code hl_variable" href="../../da/d7d/test__ctf__io__trd_8cxx.html#a9aeeaf1bfaf6b795ce504b3e0f071c8c">tracklets</a>.size() - nTracklets[iTrig], nTracklets[iTrig]);</div>
<div class="line"><a id="l00309" name="l00309"></a><span class="lineno">  309</span>    <span class="keywordflow">if</span> ((iTrig % mDigitDownscaling) == 0) {</div>
<div class="line"><a id="l00310" name="l00310"></a><span class="lineno">  310</span>      <span class="comment">// we keep digits for this trigger</span></div>
<div class="line"><a id="l00311" name="l00311"></a><span class="lineno">  311</span>      digitsOut.insert(digitsOut.end(), <a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>.begin() + triggerRecords[iTrig].getFirstDigit(), <a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>.begin() + triggerRecords[iTrig].getFirstDigit() + triggerRecords[iTrig].getNumberOfDigits());</div>
<div class="line"><a id="l00312" name="l00312"></a><span class="lineno">  312</span>      triggerRecords[iTrig].setDigitRange(digitsOut.size() - triggerRecords[iTrig].getNumberOfDigits(), triggerRecords[iTrig].getNumberOfDigits());</div>
<div class="line"><a id="l00313" name="l00313"></a><span class="lineno">  313</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><a id="l00314" name="l00314"></a><span class="lineno">  314</span>      <span class="comment">// digits are not kept, we just need to update the trigger record</span></div>
<div class="line"><a id="l00315" name="l00315"></a><span class="lineno">  315</span>      nDigitsRejected += triggerRecords[iTrig].getNumberOfDigits();</div>
<div class="line"><a id="l00316" name="l00316"></a><span class="lineno">  316</span>      triggerRecords[iTrig].setDigitRange(digitsOut.size(), 0);</div>
<div class="line"><a id="l00317" name="l00317"></a><span class="lineno">  317</span>    }</div>
<div class="line"><a id="l00318" name="l00318"></a><span class="lineno">  318</span>  }</div>
<div class="line"><a id="l00319" name="l00319"></a><span class="lineno">  319</span> </div>
<div class="line"><a id="l00320" name="l00320"></a><span class="lineno">  320</span>  <span class="keyword">auto</span> processingTime = std::chrono::high_resolution_clock::now() - timeProcessingStart;</div>
<div class="line"><a id="l00321" name="l00321"></a><span class="lineno">  321</span> </div>
<div class="line"><a id="l00322" name="l00322"></a><span class="lineno">  322</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Trap simulator found &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../da/d7d/test__ctf__io__trd_8cxx.html#a9aeeaf1bfaf6b795ce504b3e0f071c8c">tracklets</a>.size() &lt;&lt; <span class="stringliteral">&quot; tracklets from &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a>.size() &lt;&lt; <span class="stringliteral">&quot; Digits.&quot;</span>;</div>
<div class="line"><a id="l00323" name="l00323"></a><span class="lineno">  323</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;In total &quot;</span> &lt;&lt; nDigitsRejected &lt;&lt; <span class="stringliteral">&quot; digits were rejected due to digit downscaling factor of &quot;</span> &lt;&lt; mDigitDownscaling;</div>
<div class="line"><a id="l00324" name="l00324"></a><span class="lineno">  324</span>  <span class="keywordflow">if</span> (mUseMC) {</div>
<div class="line"><a id="l00325" name="l00325"></a><span class="lineno">  325</span>    <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;In total &quot;</span> &lt;&lt; lblTracklets.<a class="code hl_function" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a277aa132a845e6e466139f1d5041c933">getNElements</a>() &lt;&lt; <span class="stringliteral">&quot; MC labels are associated to the &quot;</span> &lt;&lt; lblTracklets.<a class="code hl_function" href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a9c5fbbeee8e2c01c916ef0bc2a7d0087">getIndexedSize</a>() &lt;&lt; <span class="stringliteral">&quot; tracklets&quot;</span>;</div>
<div class="line"><a id="l00326" name="l00326"></a><span class="lineno">  326</span>  }</div>
<div class="line"><a id="l00327" name="l00327"></a><span class="lineno">  327</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Total processing time : &quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(processingTime).count() &lt;&lt; <span class="stringliteral">&quot;ms&quot;</span>;</div>
<div class="line"><a id="l00328" name="l00328"></a><span class="lineno">  328</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Digit Sorting took: &quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(sortTime).count() &lt;&lt; <span class="stringliteral">&quot;ms&quot;</span>;</div>
<div class="line"><a id="l00329" name="l00329"></a><span class="lineno">  329</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(info) &lt;&lt; <span class="stringliteral">&quot;Processing time for parallel region: &quot;</span> &lt;&lt; std::chrono::duration_cast&lt;std::chrono::milliseconds&gt;(parallelTime).count() &lt;&lt; <span class="stringliteral">&quot;ms&quot;</span>;</div>
<div class="line"><a id="l00330" name="l00330"></a><span class="lineno">  330</span> </div>
<div class="line"><a id="l00331" name="l00331"></a><span class="lineno">  331</span>  pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a23b32b0b8cac7abcbf46c1d6580be859">outputs</a>().<a class="code hl_function" href="../../df/d82/classo2_1_1framework_1_1DataAllocator.html#a29d71d8c7c50ed05000fb041d879a3d9">snapshot</a>(<a class="code hl_struct" href="../../d1/dc1/structo2_1_1framework_1_1Output.html">Output</a>{<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRACKLETS&quot;</span>, 0}, <a class="code hl_variable" href="../../da/d7d/test__ctf__io__trd_8cxx.html#a9aeeaf1bfaf6b795ce504b3e0f071c8c">tracklets</a>);</div>
<div class="line"><a id="l00332" name="l00332"></a><span class="lineno">  332</span>  pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a23b32b0b8cac7abcbf46c1d6580be859">outputs</a>().<a class="code hl_function" href="../../df/d82/classo2_1_1framework_1_1DataAllocator.html#a29d71d8c7c50ed05000fb041d879a3d9">snapshot</a>(<a class="code hl_struct" href="../../d1/dc1/structo2_1_1framework_1_1Output.html">Output</a>{<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRKTRGRD&quot;</span>, 0}, triggerRecords);</div>
<div class="line"><a id="l00333" name="l00333"></a><span class="lineno">  333</span>  pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a23b32b0b8cac7abcbf46c1d6580be859">outputs</a>().<a class="code hl_function" href="../../df/d82/classo2_1_1framework_1_1DataAllocator.html#a29d71d8c7c50ed05000fb041d879a3d9">snapshot</a>(<a class="code hl_struct" href="../../d1/dc1/structo2_1_1framework_1_1Output.html">Output</a>{<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;DIGITS&quot;</span>, 0}, digitsOut);</div>
<div class="line"><a id="l00334" name="l00334"></a><span class="lineno">  334</span>  <span class="keywordflow">if</span> (mUseMC) {</div>
<div class="line"><a id="l00335" name="l00335"></a><span class="lineno">  335</span>    pc.<a class="code hl_function" href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a23b32b0b8cac7abcbf46c1d6580be859">outputs</a>().<a class="code hl_function" href="../../df/d82/classo2_1_1framework_1_1DataAllocator.html#a29d71d8c7c50ed05000fb041d879a3d9">snapshot</a>(<a class="code hl_struct" href="../../d1/dc1/structo2_1_1framework_1_1Output.html">Output</a>{<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRKLABELS&quot;</span>, 0}, lblTracklets);</div>
<div class="line"><a id="l00336" name="l00336"></a><span class="lineno">  336</span>  }</div>
<div class="line"><a id="l00337" name="l00337"></a><span class="lineno">  337</span> </div>
<div class="line"><a id="l00338" name="l00338"></a><span class="lineno">  338</span>  <a class="code hl_function" href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a>(<a class="code hl_variable" href="../../d4/d67/VariantJSONHelpers_8cxx.html#a92b9653745b1ddd58664de621c944ba2">debug</a>) &lt;&lt; <span class="stringliteral">&quot;TRD Trap Simulator Device exiting&quot;</span>;</div>
<div class="line"><a id="l00339" name="l00339"></a><span class="lineno">  339</span>}</div>
</div>
<div class="line"><a id="l00340" name="l00340"></a><span class="lineno">  340</span> </div>
<div class="foldopen" id="foldopen00341" data-start="{" data-end="}">
<div class="line"><a id="l00341" name="l00341"></a><span class="lineno"><a class="line" href="../../d2/d76/namespaceo2_1_1trd.html#a8c446261cd4737836171f20a21824368">  341</a></span><a class="code hl_struct" href="../../d0/d16/structo2_1_1framework_1_1DataProcessorSpec.html">o2::framework::DataProcessorSpec</a> <a class="code hl_function" href="../../d2/d76/namespaceo2_1_1trd.html#a8c446261cd4737836171f20a21824368">getTRDTrapSimulatorSpec</a>(<span class="keywordtype">bool</span> useMC, <span class="keywordtype">int</span> digitDownscaling)</div>
<div class="line"><a id="l00342" name="l00342"></a><span class="lineno">  342</span>{</div>
<div class="line"><a id="l00343" name="l00343"></a><span class="lineno">  343</span>  std::vector&lt;InputSpec&gt; inputs;</div>
<div class="line"><a id="l00344" name="l00344"></a><span class="lineno">  344</span>  std::vector&lt;OutputSpec&gt; outputs;</div>
<div class="line"><a id="l00345" name="l00345"></a><span class="lineno">  345</span> </div>
<div class="line"><a id="l00346" name="l00346"></a><span class="lineno">  346</span>  inputs.emplace_back(<span class="stringliteral">&quot;digitinput&quot;</span>, <span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;DIGITS&quot;</span>, 1);</div>
<div class="line"><a id="l00347" name="l00347"></a><span class="lineno">  347</span>  inputs.emplace_back(<span class="stringliteral">&quot;triggerrecords&quot;</span>, <span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRKTRGRD&quot;</span>, 1);</div>
<div class="line"><a id="l00348" name="l00348"></a><span class="lineno">  348</span> </div>
<div class="line"><a id="l00349" name="l00349"></a><span class="lineno">  349</span>  outputs.emplace_back(<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;DIGITS&quot;</span>, 0, Lifetime::Timeframe);</div>
<div class="line"><a id="l00350" name="l00350"></a><span class="lineno">  350</span>  outputs.emplace_back(<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRACKLETS&quot;</span>, 0, Lifetime::Timeframe);</div>
<div class="line"><a id="l00351" name="l00351"></a><span class="lineno">  351</span>  outputs.emplace_back(<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRKTRGRD&quot;</span>, 0, Lifetime::Timeframe);</div>
<div class="line"><a id="l00352" name="l00352"></a><span class="lineno">  352</span> </div>
<div class="line"><a id="l00353" name="l00353"></a><span class="lineno">  353</span>  <span class="keywordflow">if</span> (useMC) {</div>
<div class="line"><a id="l00354" name="l00354"></a><span class="lineno">  354</span>    inputs.emplace_back(<span class="stringliteral">&quot;labelinput&quot;</span>, <span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;LABELS&quot;</span>, 0);</div>
<div class="line"><a id="l00355" name="l00355"></a><span class="lineno">  355</span>    outputs.emplace_back(<span class="stringliteral">&quot;TRD&quot;</span>, <span class="stringliteral">&quot;TRKLABELS&quot;</span>, 0, Lifetime::Timeframe);</div>
<div class="line"><a id="l00356" name="l00356"></a><span class="lineno">  356</span>  }</div>
<div class="line"><a id="l00357" name="l00357"></a><span class="lineno">  357</span> </div>
<div class="line"><a id="l00358" name="l00358"></a><span class="lineno">  358</span>  <span class="keywordflow">return</span> <a class="code hl_struct" href="../../d0/d16/structo2_1_1framework_1_1DataProcessorSpec.html">DataProcessorSpec</a>{<span class="stringliteral">&quot;TRAP&quot;</span>,</div>
<div class="line"><a id="l00359" name="l00359"></a><span class="lineno">  359</span>                           inputs,</div>
<div class="line"><a id="l00360" name="l00360"></a><span class="lineno">  360</span>                           outputs,</div>
<div class="line"><a id="l00361" name="l00361"></a><span class="lineno">  361</span>                           <a class="code hl_struct" href="../../d4/d5e/structo2_1_1framework_1_1AlgorithmSpec.html">AlgorithmSpec</a>{adaptFromTask&lt;TRDDPLTrapSimulatorTask&gt;(useMC, digitDownscaling)},</div>
<div class="line"><a id="l00362" name="l00362"></a><span class="lineno">  362</span>                           <a class="code hl_typedef" href="../../dd/d8d/namespaceo2_1_1framework.html#acda743ee0581ee4ad2f506fffe2cfc08">Options</a>{</div>
<div class="line"><a id="l00363" name="l00363"></a><span class="lineno">  363</span>                             {<span class="stringliteral">&quot;scale-q&quot;</span>, VariantType::Int, -1, {<span class="stringliteral">&quot;Divide tracklet charges by this number. For -1 the value from the TRAP config will be taken instead&quot;</span>}},</div>
<div class="line"><a id="l00364" name="l00364"></a><span class="lineno">  364</span>                             {<span class="stringliteral">&quot;float-arithmetic&quot;</span>, VariantType::Bool, <span class="keyword">false</span>, {<span class="stringliteral">&quot;Enable floating point calculation of the tracklet charges instead of using fixed multiplier&quot;</span>}},</div>
<div class="line"><a id="l00365" name="l00365"></a><span class="lineno">  365</span>                             {<span class="stringliteral">&quot;trd-trapconfig&quot;</span>, VariantType::String, <span class="stringliteral">&quot;cf_pg-fpnp32_zs-s16-deh_tb30_trkl-b5n-fs1e24-ht200-qs0e24s24e23-pidlinear-pt100_ptrg.r5549&quot;</span>, {<span class="stringliteral">&quot;TRAP config name&quot;</span>}},</div>
<div class="line"><a id="l00366" name="l00366"></a><span class="lineno">  366</span>                             {<span class="stringliteral">&quot;trd-onlinegaincorrection&quot;</span>, VariantType::Bool, <span class="keyword">false</span>, {<span class="stringliteral">&quot;Apply online gain calibrations, mostly for back checking to run2 by setting FGBY to 0&quot;</span>}},</div>
<div class="line"><a id="l00367" name="l00367"></a><span class="lineno">  367</span>                             {<span class="stringliteral">&quot;trd-onlinegaintable&quot;</span>, VariantType::String, <span class="stringliteral">&quot;Krypton_2015-02&quot;</span>, {<span class="stringliteral">&quot;Online gain table to be use, names found in CCDB, obviously trd-onlinegaincorrection must be set as well.&quot;</span>}},</div>
<div class="line"><a id="l00368" name="l00368"></a><span class="lineno">  368</span>                             {<span class="stringliteral">&quot;trd-dumptrapconfig&quot;</span>, VariantType::Bool, <span class="keyword">false</span>, {<span class="stringliteral">&quot;Dump the selected trap configuration at loading time, to text file&quot;</span>}},</div>
<div class="line"><a id="l00369" name="l00369"></a><span class="lineno">  369</span>                             {<span class="stringliteral">&quot;trd-runnum&quot;</span>, VariantType::Int, -1, {<span class="stringliteral">&quot;Run number to use to anchor simulation to (from Run 2 297595 was used)&quot;</span>}}}};</div>
<div class="line"><a id="l00370" name="l00370"></a><span class="lineno">  370</span>};</div>
</div>
<div class="line"><a id="l00371" name="l00371"></a><span class="lineno">  371</span> </div>
<div class="line"><a id="l00372" name="l00372"></a><span class="lineno">  372</span>} <span class="comment">//end namespace trd</span></div>
<div class="line"><a id="l00373" name="l00373"></a><span class="lineno">  373</span>} <span class="comment">//end namespace o2</span></div>
<div class="ttc" id="aBasicCCDBManager_8h_html"><div class="ttname"><a href="../../d5/df3/BasicCCDBManager_8h.html">BasicCCDBManager.h</a></div></div>
<div class="ttc" id="aCompressedHeader_8h_html_a535b60c8bc5725e8c6d827b339c5a213"><div class="ttname"><a href="../../db/de1/CompressedHeader_8h.html#a535b60c8bc5725e8c6d827b339c5a213">mcm</a></div><div class="ttdeci">uint16_t mcm</div><div class="ttdef"><b>Definition</b> <a href="../../db/de1/CompressedHeader_8h_source.html#l00001">CompressedHeader.h:1</a></div></div>
<div class="ttc" id="aCompressedHeader_8h_html_a893df70322200a4732fc54fd51287f0e"><div class="ttname"><a href="../../db/de1/CompressedHeader_8h.html#a893df70322200a4732fc54fd51287f0e">rob</a></div><div class="ttdeci">uint16_t rob</div><div class="ttdef"><b>Definition</b> <a href="../../db/de1/CompressedHeader_8h_source.html#l00002">CompressedHeader.h:2</a></div></div>
<div class="ttc" id="aConfigParamRegistry_8h_html"><div class="ttname"><a href="../../de/dc6/ConfigParamRegistry_8h.html">ConfigParamRegistry.h</a></div></div>
<div class="ttc" id="aConstMCTruthContainer_8h_html"><div class="ttname"><a href="../../d1/da6/ConstMCTruthContainer_8h.html">ConstMCTruthContainer.h</a></div><div class="ttdoc">A const (ready only) version of MCTruthContainer.</div></div>
<div class="ttc" id="aControlService_8h_html"><div class="ttname"><a href="../../d2/d43/ControlService_8h.html">ControlService.h</a></div></div>
<div class="ttc" id="aDataFormats_2Detectors_2TRD_2include_2DataFormatsTRD_2Digit_8h_html"><div class="ttname"><a href="../../df/d6a/DataFormats_2Detectors_2TRD_2include_2DataFormatsTRD_2Digit_8h.html">Digit.h</a></div></div>
<div class="ttc" id="aDataProcessorSpec_8h_html"><div class="ttname"><a href="../../d0/df4/DataProcessorSpec_8h.html">DataProcessorSpec.h</a></div></div>
<div class="ttc" id="aDataRefUtils_8h_html"><div class="ttname"><a href="../../d5/db8/DataRefUtils_8h.html">DataRefUtils.h</a></div></div>
<div class="ttc" id="aGPUCommonAlgorithm_8h_html_ad9484f5522d0e5f033037c369365ec61"><div class="ttname"><a href="../../dd/d0b/GPUCommonAlgorithm_8h.html#ad9484f5522d0e5f033037c369365ec61">i</a></div><div class="ttdeci">int32_t i</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d0b/GPUCommonAlgorithm_8h_source.html#l00435">GPUCommonAlgorithm.h:436</a></div></div>
<div class="ttc" id="aLifetime_8h_html"><div class="ttname"><a href="../../dc/dca/Lifetime_8h.html">Lifetime.h</a></div></div>
<div class="ttc" id="aMCCompLabel_8h_html"><div class="ttname"><a href="../../d7/dcd/MCCompLabel_8h.html">MCCompLabel.h</a></div></div>
<div class="ttc" id="aRawData_8h_html_a5ee9234d389c6be7f0a75b450da09722"><div class="ttname"><a href="../../dc/d62/RawData_8h.html#a5ee9234d389c6be7f0a75b450da09722">j</a></div><div class="ttdeci">uint32_t j</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d62/RawData_8h_source.html#l00000">RawData.h:0</a></div></div>
<div class="ttc" id="aTRDSimParams_8h_html"><div class="ttname"><a href="../../d5/dad/TRDSimParams_8h.html">TRDSimParams.h</a></div></div>
<div class="ttc" id="aTRDTrapSimulatorSpec_8h_html"><div class="ttname"><a href="../../dc/d96/TRDTrapSimulatorSpec_8h.html">TRDTrapSimulatorSpec.h</a></div></div>
<div class="ttc" id="aTRD_2include_2DataFormatsTRD_2TriggerRecord_8h_html"><div class="ttname"><a href="../../d9/dbe/TRD_2include_2DataFormatsTRD_2TriggerRecord_8h.html">TriggerRecord.h</a></div></div>
<div class="ttc" id="aTrapConfig_8h_html"><div class="ttname"><a href="../../d8/dbb/TrapConfig_8h.html">TrapConfig.h</a></div></div>
<div class="ttc" id="aVariantJSONHelpers_8cxx_html_a92b9653745b1ddd58664de621c944ba2"><div class="ttname"><a href="../../d4/d67/VariantJSONHelpers_8cxx.html#a92b9653745b1ddd58664de621c944ba2">debug</a></div><div class="ttdeci">std::ostringstream debug</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d67/VariantJSONHelpers_8cxx_source.html#l00305">VariantJSONHelpers.cxx:305</a></div></div>
<div class="ttc" id="aclasso2_1_1ccdb_1_1BasicCCDBManager_html_a052eb744e07383cae56135d57909cb69"><div class="ttname"><a href="../../da/d73/classo2_1_1ccdb_1_1BasicCCDBManager.html#a052eb744e07383cae56135d57909cb69">o2::ccdb::BasicCCDBManager::instance</a></div><div class="ttdeci">static BasicCCDBManager &amp; instance()</div><div class="ttdef"><b>Definition</b> <a href="../../d5/df3/BasicCCDBManager_8h_source.html#l00370">BasicCCDBManager.h:370</a></div></div>
<div class="ttc" id="aclasso2_1_1conf_1_1ConfigurableParamHelper_html_a8c7d4cc9dc1f34d578b77cc5d6cf1df0"><div class="ttname"><a href="../../d7/d50/classo2_1_1conf_1_1ConfigurableParamHelper.html#a8c7d4cc9dc1f34d578b77cc5d6cf1df0">o2::conf::ConfigurableParamHelper&lt; TRDSimParams &gt;::Instance</a></div><div class="ttdeci">static const TRDSimParams &amp; Instance()</div><div class="ttdef"><b>Definition</b> <a href="../../da/d6b/ConfigurableParamHelper_8h_source.html#l00081">ConfigurableParamHelper.h:81</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1ConstMCTruthContainer_html"><div class="ttname"><a href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html">o2::dataformats::ConstMCTruthContainer</a></div><div class="ttdoc">A read-only version of MCTruthContainer allowing for storage optimisation.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/da6/ConstMCTruthContainer_8h_source.html#l00039">ConstMCTruthContainer.h:40</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1ConstMCTruthContainer_html_a0d3692ce6fe618d98104faae490a819a"><div class="ttname"><a href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#a0d3692ce6fe618d98104faae490a819a">o2::dataformats::ConstMCTruthContainer::getNElements</a></div><div class="ttdeci">size_t getNElements() const</div><div class="ttdef"><b>Definition</b> <a href="../../d1/da6/ConstMCTruthContainer_8h_source.html#l00068">ConstMCTruthContainer.h:68</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1ConstMCTruthContainer_html_aecc0c7f7c16a425b1165e2f72c00a625"><div class="ttname"><a href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#aecc0c7f7c16a425b1165e2f72c00a625">o2::dataformats::ConstMCTruthContainer::getLabels</a></div><div class="ttdeci">gsl::span&lt; const TruthElement &gt; getLabels(uint32_t dataindex) const</div><div class="ttdef"><b>Definition</b> <a href="../../d1/da6/ConstMCTruthContainer_8h_source.html#l00054">ConstMCTruthContainer.h:54</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1ConstMCTruthContainer_html_afe41ba5bbdb1062a85b597648bf1b939"><div class="ttname"><a href="../../d5/db7/classo2_1_1dataformats_1_1ConstMCTruthContainer.html#afe41ba5bbdb1062a85b597648bf1b939">o2::dataformats::ConstMCTruthContainer::getIndexedSize</a></div><div class="ttdeci">size_t getIndexedSize() const</div><div class="ttdef"><b>Definition</b> <a href="../../d1/da6/ConstMCTruthContainer_8h_source.html#l00065">ConstMCTruthContainer.h:65</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1MCTruthContainer_html"><div class="ttname"><a href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html">o2::dataformats::MCTruthContainer</a></div><div class="ttdoc">A container to hold and manage MC truth information/labels.</div><div class="ttdef"><b>Definition</b> <a href="../../db/d14/MCTruthContainer_8h_source.html#l00082">MCTruthContainer.h:83</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1MCTruthContainer_html_a05115beedbb77c0be74f7d142e514259"><div class="ttname"><a href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a05115beedbb77c0be74f7d142e514259">o2::dataformats::MCTruthContainer::getLabels</a></div><div class="ttdeci">gsl::span&lt; TruthElement &gt; getLabels(uint32_t dataindex)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d14/MCTruthContainer_8h_source.html#l00153">MCTruthContainer.h:153</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1MCTruthContainer_html_a277aa132a845e6e466139f1d5041c933"><div class="ttname"><a href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a277aa132a845e6e466139f1d5041c933">o2::dataformats::MCTruthContainer::getNElements</a></div><div class="ttdeci">size_t getNElements() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d14/MCTruthContainer_8h_source.html#l00144">MCTruthContainer.h:144</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1MCTruthContainer_html_a528292fd3fb667273f0fa29973bd56de"><div class="ttname"><a href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a528292fd3fb667273f0fa29973bd56de">o2::dataformats::MCTruthContainer::addElements</a></div><div class="ttdeci">void addElements(uint32_t dataindex, gsl::span&lt; CompatibleLabel &gt; elements)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d14/MCTruthContainer_8h_source.html#l00224">MCTruthContainer.h:224</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1MCTruthContainer_html_a583de4d505501ba4a836edbc135b948e"><div class="ttname"><a href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a583de4d505501ba4a836edbc135b948e">o2::dataformats::MCTruthContainer::addElement</a></div><div class="ttdeci">void addElement(uint32_t dataindex, TruthElement const &amp;element, bool noElement=false)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d14/MCTruthContainer_8h_source.html#l00190">MCTruthContainer.h:190</a></div></div>
<div class="ttc" id="aclasso2_1_1dataformats_1_1MCTruthContainer_html_a9c5fbbeee8e2c01c916ef0bc2a7d0087"><div class="ttname"><a href="../../dc/daa/classo2_1_1dataformats_1_1MCTruthContainer.html#a9c5fbbeee8e2c01c916ef0bc2a7d0087">o2::dataformats::MCTruthContainer::getIndexedSize</a></div><div class="ttdeci">size_t getIndexedSize() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d14/MCTruthContainer_8h_source.html#l00142">MCTruthContainer.h:142</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1ConfigParamRegistry_html_ae86d66faf0b5cdc42a725d722be54d5e"><div class="ttname"><a href="../../df/d6f/classo2_1_1framework_1_1ConfigParamRegistry.html#ae86d66faf0b5cdc42a725d722be54d5e">o2::framework::ConfigParamRegistry::get</a></div><div class="ttdeci">T get(const char *key) const</div><div class="ttdef"><b>Definition</b> <a href="../../de/dc6/ConfigParamRegistry_8h_source.html#l00098">ConfigParamRegistry.h:98</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1DataAllocator_html_a29d71d8c7c50ed05000fb041d879a3d9"><div class="ttname"><a href="../../df/d82/classo2_1_1framework_1_1DataAllocator.html#a29d71d8c7c50ed05000fb041d879a3d9">o2::framework::DataAllocator::snapshot</a></div><div class="ttdeci">void snapshot(const Output &amp;spec, T const &amp;object)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d28/DataAllocator_8h_source.html#l00311">DataAllocator.h:311</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1InitContext_html"><div class="ttname"><a href="../../d4/d07/classo2_1_1framework_1_1InitContext.html">o2::framework::InitContext</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d2b/InitContext_8h_source.html#l00024">InitContext.h:25</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1InitContext_html_ada83dc23c159df009861ac98633eefe6"><div class="ttname"><a href="../../d4/d07/classo2_1_1framework_1_1InitContext.html#ada83dc23c159df009861ac98633eefe6">o2::framework::InitContext::options</a></div><div class="ttdeci">ConfigParamRegistry const &amp; options()</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d2b/InitContext_8h_source.html#l00033">InitContext.h:33</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1InputRecord_html_a1c777bf7e242f8ba17b89275446a1225"><div class="ttname"><a href="../../df/d24/classo2_1_1framework_1_1InputRecord.html#a1c777bf7e242f8ba17b89275446a1225">o2::framework::InputRecord::get</a></div><div class="ttdeci">decltype(auto) get(R binding, int part=0) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d5c/InputRecord_8h_source.html#l00248">InputRecord.h:248</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1ProcessingContext_html"><div class="ttname"><a href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html">o2::framework::ProcessingContext</a></div><div class="ttdef"><b>Definition</b> <a href="../../de/d6a/ProcessingContext_8h_source.html#l00026">ProcessingContext.h:27</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1ProcessingContext_html_a23b32b0b8cac7abcbf46c1d6580be859"><div class="ttname"><a href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a23b32b0b8cac7abcbf46c1d6580be859">o2::framework::ProcessingContext::outputs</a></div><div class="ttdeci">DataAllocator &amp; outputs()</div><div class="ttdoc">The data allocator is used to allocate memory for the output data.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d6a/ProcessingContext_8h_source.html#l00041">ProcessingContext.h:41</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1ProcessingContext_html_a7862af0201c6d6a574a054d811f0eab3"><div class="ttname"><a href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#a7862af0201c6d6a574a054d811f0eab3">o2::framework::ProcessingContext::inputs</a></div><div class="ttdeci">InputRecord &amp; inputs()</div><div class="ttdoc">The inputs associated with this processing context.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d6a/ProcessingContext_8h_source.html#l00037">ProcessingContext.h:37</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1ProcessingContext_html_aa236d4d55c7ef46fe86a822195ea00b0"><div class="ttname"><a href="../../d3/db7/classo2_1_1framework_1_1ProcessingContext.html#aa236d4d55c7ef46fe86a822195ea00b0">o2::framework::ProcessingContext::services</a></div><div class="ttdeci">ServiceRegistryRef services()</div><div class="ttdoc">The services registry associated with this processing context.</div><div class="ttdef"><b>Definition</b> <a href="../../de/d6a/ProcessingContext_8h_source.html#l00039">ProcessingContext.h:39</a></div></div>
<div class="ttc" id="aclasso2_1_1framework_1_1ServiceRegistryRef_html_ab34ff207fce452a23aa9170d6a5c35aa"><div class="ttname"><a href="../../d7/da4/classo2_1_1framework_1_1ServiceRegistryRef.html#ab34ff207fce452a23aa9170d6a5c35aa">o2::framework::ServiceRegistryRef::get</a></div><div class="ttdeci">T &amp; get() const</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d58/ServiceRegistryRef_8h_source.html#l00085">ServiceRegistryRef.h:85</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TRDDPLTrapSimulatorTask_html_a6ad5763aa5229d5a2f0bdb76c0427b0d"><div class="ttname"><a href="../../d3/dfd/classo2_1_1trd_1_1TRDDPLTrapSimulatorTask.html#a6ad5763aa5229d5a2f0bdb76c0427b0d">o2::trd::TRDDPLTrapSimulatorTask::run</a></div><div class="ttdeci">void run(o2::framework::ProcessingContext &amp;pc) override</div><div class="ttdef"><b>Definition</b> <a href="../../dd/de7/TRDTrapSimulatorSpec_8cxx_source.html#l00173">TRDTrapSimulatorSpec.cxx:173</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TRDDPLTrapSimulatorTask_html_a8d6c53494345b316da9f39c6fc18c170"><div class="ttname"><a href="../../d3/dfd/classo2_1_1trd_1_1TRDDPLTrapSimulatorTask.html#a8d6c53494345b316da9f39c6fc18c170">o2::trd::TRDDPLTrapSimulatorTask::init</a></div><div class="ttdeci">void init(o2::framework::InitContext &amp;ic) override</div><div class="ttdef"><b>Definition</b> <a href="../../dd/de7/TRDTrapSimulatorSpec_8cxx_source.html#l00132">TRDTrapSimulatorSpec.cxx:132</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html">o2::trd::TrapConfig</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00036">TrapConfig.h:37</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_a04f19fde89b38c9eb174d488f1e5701c"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701c">o2::trd::TrapConfig::TrapReg_t</a></div><div class="ttdeci">TrapReg_t</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00057">TrapConfig.h:57</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_a04f19fde89b38c9eb174d488f1e5701ca3d5ce4e5e5690c78fe97cbdcae17418d"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701ca3d5ce4e5e5690c78fe97cbdcae17418d">o2::trd::TrapConfig::kFGA0</a></div><div class="ttdeci">@ kFGA0</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00256">TrapConfig.h:256</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_a04f19fde89b38c9eb174d488f1e5701ca4fb238065019006598da2057da7146a7"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701ca4fb238065019006598da2057da7146a7">o2::trd::TrapConfig::kFGBY</a></div><div class="ttdeci">@ kFGBY</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00200">TrapConfig.h:200</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_a04f19fde89b38c9eb174d488f1e5701cae0519f54d493015c6b2174c514e98cea"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701cae0519f54d493015c6b2174c514e98cea">o2::trd::TrapConfig::kFGF0</a></div><div class="ttdeci">@ kFGF0</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00235">TrapConfig.h:235</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_a04f19fde89b38c9eb174d488f1e5701cae57a0cb62a5d85f630b0ac970fa970cd"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a04f19fde89b38c9eb174d488f1e5701cae57a0cb62a5d85f630b0ac970fa970cd">o2::trd::TrapConfig::kADCDAC</a></div><div class="ttdeci">@ kADCDAC</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00231">TrapConfig.h:231</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_a7ceca1ab60cf4bf5f04f9a8bd1e62933"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a7ceca1ab60cf4bf5f04f9a8bd1e62933">o2::trd::TrapConfig::setTrapReg</a></div><div class="ttdeci">bool setTrapReg(TrapReg_t reg, int value, int det)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d55/TrapConfig_8cxx_source.html#l00550">TrapConfig.cxx:550</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_a963c75e9fe77ae60f801b4a41ed7f34a"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#a963c75e9fe77ae60f801b4a41ed7f34a">o2::trd::TrapConfig::getTrapReg</a></div><div class="ttdeci">int getTrapReg(TrapReg_t reg, int det=-1, int rob=-1, int mcm=-1)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d55/TrapConfig_8cxx_source.html#l00537">TrapConfig.cxx:537</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_ab7277ae2ae664f93726348f1cac106b0"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ab7277ae2ae664f93726348f1cac106b0">o2::trd::TrapConfig::getConfigVersion</a></div><div class="ttdeci">std::string getConfigVersion()</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00501">TrapConfig.h:501</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_ac7252f0a461737170ce5a25e440bfbf8"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ac7252f0a461737170ce5a25e440bfbf8">o2::trd::TrapConfig::setTrapRegAlloc</a></div><div class="ttdeci">bool setTrapRegAlloc(TrapReg_t reg, Alloc_t mode)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00494">TrapConfig.h:494</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_ad4b9685a158c8eacb7fc31da15881be0"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ad4b9685a158c8eacb7fc31da15881be0">o2::trd::TrapConfig::getConfigName</a></div><div class="ttdeci">std::string getConfigName()</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00502">TrapConfig.h:502</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_ad8de9fb04bd9f7cb4469c0dd7a4b64d4a2c99f81e30f08f2ef2f409e4a73e2712"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#ad8de9fb04bd9f7cb4469c0dd7a4b64d4a2c99f81e30f08f2ef2f409e4a73e2712">o2::trd::TrapConfig::kAllocByMCM</a></div><div class="ttdeci">@ kAllocByMCM</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dbb/TrapConfig_8h_source.html#l00048">TrapConfig.h:48</a></div></div>
<div class="ttc" id="aclasso2_1_1trd_1_1TrapConfig_html_af315cbe9e556dc74386fde7f45e94d95"><div class="ttname"><a href="../../d7/dae/classo2_1_1trd_1_1TrapConfig.html#af315cbe9e556dc74386fde7f45e94d95">o2::trd::TrapConfig::DumpTrapConfig2File</a></div><div class="ttdeci">void DumpTrapConfig2File(std::string filename)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d55/TrapConfig_8cxx_source.html#l01026">TrapConfig.cxx:1026</a></div></div>
<div class="ttc" id="anamespaceo2_1_1framework_html"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html">o2::framework</a></div><div class="ttdoc">Defining PrimaryVertex explicitly as messageable.</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d23/TFIDInfo_8h_source.html#l00019">TFIDInfo.h:20</a></div></div>
<div class="ttc" id="anamespaceo2_1_1framework_html_acda743ee0581ee4ad2f506fffe2cfc08"><div class="ttname"><a href="../../dd/d8d/namespaceo2_1_1framework.html#acda743ee0581ee4ad2f506fffe2cfc08">o2::framework::Options</a></div><div class="ttdeci">std::vector&lt; ConfigParamSpec &gt; Options</div><div class="ttdef"><b>Definition</b> <a href="../../d0/df4/DataProcessorSpec_8h_source.html#l00031">DataProcessorSpec.h:31</a></div></div>
<div class="ttc" id="anamespaceo2_1_1trd_1_1constants_html_a67faa598736e3ce6533769d141bb6ac3"><div class="ttname"><a href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#a67faa598736e3ce6533769d141bb6ac3">o2::trd::constants::NMCMROB</a></div><div class="ttdeci">constexpr int NMCMROB</div><div class="ttdoc">the number of MCMs per ROB</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/DataFormats_2Detectors_2TRD_2include_2DataFormatsTRD_2Constants_8h_source.html#l00046">Constants.h:46</a></div></div>
<div class="ttc" id="anamespaceo2_1_1trd_1_1constants_html_a9d646704bed62aeec9cca0476104c642"><div class="ttname"><a href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#a9d646704bed62aeec9cca0476104c642">o2::trd::constants::NADCMCM</a></div><div class="ttdeci">constexpr int NADCMCM</div><div class="ttdoc">the number of ADC channels per MCM</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/DataFormats_2Detectors_2TRD_2include_2DataFormatsTRD_2Constants_8h_source.html#l00052">Constants.h:52</a></div></div>
<div class="ttc" id="anamespaceo2_1_1trd_1_1constants_html_aa4b36b565f213708276bdd3b66f0144e"><div class="ttname"><a href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#aa4b36b565f213708276bdd3b66f0144e">o2::trd::constants::MAXCHAMBER</a></div><div class="ttdeci">constexpr int MAXCHAMBER</div><div class="ttdoc">the maximum number of installed chambers</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/DataFormats_2Detectors_2TRD_2include_2DataFormatsTRD_2Constants_8h_source.html#l00030">Constants.h:30</a></div></div>
<div class="ttc" id="anamespaceo2_1_1trd_1_1constants_html_ae843f9edddf4429afd71769559825a13"><div class="ttname"><a href="../../df/d06/namespaceo2_1_1trd_1_1constants.html#ae843f9edddf4429afd71769559825a13">o2::trd::constants::NMCMHCMAX</a></div><div class="ttdeci">constexpr int NMCMHCMAX</div><div class="ttdoc">the maximum number of MCMs for one half chamber (C1 type)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dc2/DataFormats_2Detectors_2TRD_2include_2DataFormatsTRD_2Constants_8h_source.html#l00047">Constants.h:47</a></div></div>
<div class="ttc" id="anamespaceo2_1_1trd_html_a8c446261cd4737836171f20a21824368"><div class="ttname"><a href="../../d2/d76/namespaceo2_1_1trd.html#a8c446261cd4737836171f20a21824368">o2::trd::getTRDTrapSimulatorSpec</a></div><div class="ttdeci">o2::framework::DataProcessorSpec getTRDTrapSimulatorSpec(bool useMC, int digitDownscaling)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/de7/TRDTrapSimulatorSpec_8cxx_source.html#l00341">TRDTrapSimulatorSpec.cxx:341</a></div></div>
<div class="ttc" id="anamespaceo2_html"><div class="ttname"><a href="../../d4/d7c/namespaceo2.html">o2</a></div><div class="ttdoc">a couple of static helper functions to create timestamp values for CCDB queries or override obsolete ...</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d24/BitstreamReader_8h_source.html#l00023">BitstreamReader.h:24</a></div></div>
<div class="ttc" id="astructo2_1_1framework_1_1AlgorithmSpec_html"><div class="ttname"><a href="../../d4/d5e/structo2_1_1framework_1_1AlgorithmSpec.html">o2::framework::AlgorithmSpec</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/d14/AlgorithmSpec_8h_source.html#l00043">AlgorithmSpec.h:43</a></div></div>
<div class="ttc" id="astructo2_1_1framework_1_1DataProcessorSpec_html"><div class="ttname"><a href="../../d0/d16/structo2_1_1framework_1_1DataProcessorSpec.html">o2::framework::DataProcessorSpec</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/df4/DataProcessorSpec_8h_source.html#l00041">DataProcessorSpec.h:41</a></div></div>
<div class="ttc" id="astructo2_1_1framework_1_1Output_html"><div class="ttname"><a href="../../d1/dc1/structo2_1_1framework_1_1Output.html">o2::framework::Output</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddf/Output_8h_source.html#l00027">Output.h:27</a></div></div>
<div class="ttc" id="astructo2_1_1framework_1_1TimingInfo_html"><div class="ttname"><a href="../../d4/d11/structo2_1_1framework_1_1TimingInfo.html">o2::framework::TimingInfo</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/d2b/TimingInfo_8h_source.html#l00024">TimingInfo.h:24</a></div></div>
<div class="ttc" id="atest__ctf__io__cpv_8cxx_html_a1ef7964b771b9b29688dfa8810b27d00"><div class="ttname"><a href="../../dc/da7/test__ctf__io__cpv_8cxx.html#a1ef7964b771b9b29688dfa8810b27d00">LOG</a></div><div class="ttdeci">LOG(info)&lt;&lt; &quot;Compressed in &quot;&lt;&lt; sw.CpuTime()&lt;&lt; &quot; s&quot;</div></div>
<div class="ttc" id="atest__ctf__io__hmpid_8cxx_html_a41a6d224f3eccd6ee0a0db7355e20877"><div class="ttname"><a href="../../dc/d45/test__ctf__io__hmpid_8cxx.html#a41a6d224f3eccd6ee0a0db7355e20877">digits</a></div><div class="ttdeci">std::vector&lt; Digit &gt; digits</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d45/test__ctf__io__hmpid_8cxx_source.html#l00040">test_ctf_io_hmpid.cxx:40</a></div></div>
<div class="ttc" id="atest__ctf__io__trd_8cxx_html_a9aeeaf1bfaf6b795ce504b3e0f071c8c"><div class="ttname"><a href="../../da/d7d/test__ctf__io__trd_8cxx.html#a9aeeaf1bfaf6b795ce504b3e0f071c8c">tracklets</a></div><div class="ttdeci">std::vector&lt; Tracklet64 &gt; tracklets</div><div class="ttdef"><b>Definition</b> <a href="../../da/d7d/test__ctf__io__trd_8cxx_source.html#l00040">test_ctf_io_trd.cxx:40</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_051dca18e802f8e9474f2e30d29c04e0.html">Detectors</a></li><li class="navelem"><a class="el" href="../../dir_69dd0583e11051991bf4c0cf23c50933.html">TRD</a></li><li class="navelem"><a class="el" href="../../dir_184e1d06e85fb151746c3bdf717cc8ad.html">workflow</a></li><li class="navelem"><a class="el" href="../../dir_19cbc61730528058d9acd8ae2ca70332.html">src</a></li><li class="navelem"><a class="el" href="../../dd/de7/TRDTrapSimulatorSpec_8cxx.html">TRDTrapSimulatorSpec.cxx</a></li>
    <li class="footer">Generated on Fri Oct 31 2025 12:28:02 for Project by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
