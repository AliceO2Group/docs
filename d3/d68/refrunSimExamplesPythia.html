<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.8"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Project: Example of generating Pythia events</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="../../o2_logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">Project
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.8 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d3/d68/refrunSimExamplesPythia.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Example of generating Pythia events</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Pythia8 is the only event generator guarantied to be included into O2. This is because it is used for decays in the simulations.</p>
<p>The event generator is selected by </p><pre class="fragment">o2-sim -g pythia8 ...
</pre><p> Pythia8 is heavily <a href="https://pythia8.org">documented</a> at its web-site. Please refer to that documentation for more.</p>
<h2>Configuration keys</h2>
<p>Configuration keys are specified by </p><pre class="fragment">o2-sim --configKeyValues "comma-separated-list-of-pairs"
</pre><p> for example </p><pre class="fragment">o2-sim -g pythia8 \
  --configKeyValues "GeneratorPythia8.config=myconfig.cfg"
</pre><p> Available configuration keys for Pythia8 are</p>
<ul>
<li><code>GeneratorPythia8.config=filename</code> Specifies the configuration file for Pythia8 to read. The <a href="https://pythia.org/latest-manual/SettingsScheme.html">format</a> and <a href="https://pythia.org/latest-manual">settings</a> are heavily documented at the Pythia web-site. Note, if a predefined configuration is selected (e.g, <code>pythia8pp</code>) - see below - then the file specified here will be read <em>after</em> the default configuration.</li>
<li><code>GeneratorPythia8.hooksFileName=script-file-name</code> Specifies a <a class="el" href="../../d0/d10/namespaceROOT.html">ROOT</a> script to be executed to define a <code>Pythia8::UserHooks</code> (see <a href="https://pythia.org/latest-manual/UserHooks.html">documentation</a>) object. See for example <code>${O2_ROOT}/share/Generators/egconfig/pythia8_userhooks_charm.C</code>.</li>
<li><code>GeneratorPythia8.hooksFuncname=function-name</code> Specifies the function in <code>GeneratorPythia8::hooksFileName</code> to call. This function <em>must</em> return a pointer to a <code>Pythia8::UserHooks</code> object. See for example <code>${O2_ROOT}/share/Generators/egconfig/pythia8_userhooks_charm.C</code>. The default value is <code>pythia8_userhooks</code>.</li>
<li><code>GeneratorPythia8.includePartonEvent=boolean</code> If <code>false</code> (default), prune the events for particles that are <em>not</em><ul>
<li>beam particles (HepMC status = 4),</li>
<li>decayed (HepMC status = 2), nor</li>
<li>final state (HepMC status = 1) This reduces the size of the events by roughly 30%. Note that setting this option to <code>false</code> <em>may</em> corrupt the events, and it should be used with caution. If <code>true</code>, then the whole event is stored.</li>
</ul>
</li>
</ul>
<h2>Predefined configurations</h2>
<p>The class <code><a class="el" href="../../d1/dfb/structo2_1_1eventgen_1_1GeneratorFactory.html">o2::eventgen::GeneratorFactory</a></code> (which parses the <code>o2-sim -g</code> option) has a number of predefined configurations of Pythia. These are listed below together with their configuration file (read from &lsquo;${O2_ROOT}/share/Generators/egconfig/&rsquo;).</p>
<ul>
<li><code>alldet</code> (<code>pythia8_inel.cfg</code>) pp at 14 TeV, min. bias inelastic collisions, with an additional muon box generator in the MUON arm acceptance.</li>
<li><code>pythia8inel</code> (<code>pythia8_inel.cfg</code>) pp at 14 TeV, min. bias inelastic collisions.</li>
<li><code>pythia8hf</code> (<code>pythia8_hf.cfg</code>) pp at 14 TeV, with hard c-cbar and b-bar processes turned on.</li>
<li><code>pythia8powheg</code> (<code>pythia8_powheg.cfg</code>) pp at 13 TeV using POWHEG parton distribution functions (via LHEF files).</li>
<li><code>pythia8hi</code> (<code>pythia8_hi.cfg</code>) Pb-Pb at 5.52 TeV using the Angantyr model.</li>
</ul>
<h2>Alternative</h2>
<p>Rather than using the built-in Pythia8 event generator, we can also use an external application that writes HepMC output. For example </p><pre class="fragment">/*
   g++ -std=c++17 -I${PYTHIA8_ROOT}/include \
   -I${HEPMC3_ROOT}/include \
   pythia.cc -o pythia \
   -L${PYTHIA8_ROOT} -L${HEPMC3_ROOT}/lib \
   -Wl,-rpath,${PYTHIA8_ROOT}/lib \
   -Wl,-rpath,${HEPMC3_ROOT}/lib \
   -lHepMC3 \
   -lpythia8
*/
#include &lt;HepMC3/WriterAscii.h&gt;
#include &lt;Pythia8/Pythia.h&gt;
#include &lt;Pythia8Plugins/HepMC3.h&gt;
#include &lt;string&gt;
#include &lt;fstream&gt;

struct BasePythia {
  Pythia8::Pythia _pythia{"",false};
  int             _seed = -1;
  std::string     _config;
  void silence() {
    _pythia.readString("Print:quiet                      = on");
    _pythia.readString("Init:showAllSettings             = off");
    _pythia.readString("Stat:showProcessLevel            = off");
    _pythia.readString("Init:showAllParticleData         = off");
    _pythia.readString("Init:showChangedParticleData     = off");
    _pythia.readString("Init:showChangedSettings         = off");
    _pythia.readString("Init:showMultipartonInteractions = off");
  }
  void seed() {
    _pythia.readString("Random:setSeed = "
               +std::string(_seed &gt;= 0 ? "yes" : "no"));
    _pythia.readString("Random:seed = "+std::to_string(_seed));
  }
  virtual void configure() = 0;
  void init()  {
    silence();
    seed();
    configure();
    if (not _config.empty()) _pythia.readFile(_config);
    _pythia.init();
  }
  bool loop(size_t nev, const std::string&amp; filename) {
    std::ofstream*         file = (filename == "-" or filename.empty()
                                   ? nullptr
                                   : new std::ofstream(filename.c_str()));
    std::ostream&amp;           out  = file ? *file : std::cout;
    HepMC3::GenEvent        event;
    HepMC3::WriterAscii     writer(out);
    HepMC3::Pythia8ToHepMC3 converter;

    for (size_t iev = 0; iev &lt; nev; ++iev) {
      if (not _pythia.next()) return false;
      event    .clear();
      converter.fill_next_event(_pythia,event);
      writer   .write_event(event);
    }
    if (file) {
      file-&gt;close();
      delete file;
    }
    return true;
  }
};

struct Pythia : BasePythia {
  void configure() {
    _pythia.readString("Beams:idA                = 2212");
    _pythia.readString("Beams:idB                = 2212");
    _pythia.readString("Beams:eCM                = 5020.");
    _pythia.readString("SoftQCD:inelastic        = on");
    _pythia.readString("ParticleDecays:limitTau0 = on");
    _pythia.readString("ParticleDecays:tau0Max   = 10");
    _pythia.readString("Tune:ee                  = 7");
    _pythia.readString("Tune:pp                  = 14");
  }
};

struct Angantyr : BasePythia {
  enum Model {
    fixed = 0,
    random = 1,
    opacity = 2
  } _model = fixed;
  float _bMax = 15;
  virtual void configure() {
    _pythia.readString("Angantyr::CollisionModel = "+std::to_string(_model));
    _pythia.readString("HeavyIon:showInit        = off");
    _pythia.readString("HeavyIon:SigFitPrint     = off");
    _pythia.readString("HeavyIon:SigFitDefPar    = 0,0,0,0,0,0,0,0,0");
    _pythia.readString("HeavyIon:SigFitNGen      = 20");
    _pythia.readString("HeavyIon:bWidth          = "+std::to_string(_bMax));
  }
};

struct PbPb : Angantyr {
  void configure() {
    Angantyr::configure();
    _pythia.readString("Beams:idA                = 1000822080");
    _pythia.readString("Beams:idB                = 1000822080");
    _pythia.readString("Beams:eCM                = 5020.");
    _pythia.readString("Beams:frameType          = 1");
    _pythia.readString("ParticleDecays:limitTau0 = on");
    _pythia.readString("ParticleDecays:tau0Max   = 10");
  }
};

struct pPb : Angantyr {
  void configure() {
    Angantyr::configure();
    _pythia.readString("Beams:idA                = 2212");
    _pythia.readString("Beams:idB                = 1000822080");
    _pythia.readString("Beams:eA                 = 7000.");
    _pythia.readString("Beams:eB                 = 2760.");
    _pythia.readString("Beams:frameType          = 1");
    _pythia.readString("ParticleDecays:limitTau0 = on");
    _pythia.readString("ParticleDecays:tau0Max   = 10");
  }
};

int main(int argc, char** argv) {
  int seed           = -1;
  int nev            = 10;
  std::string output = "-";
  std::string system = "pp";
  std::string config = "";
  for (int i = 1; i &lt; argc; i++) {
    if (argv[i][0] == '-') {
      switch (argv[i][1]) {
      case 's': seed   = std::stoi(argv[++i]); break;
      case 'n': nev    = std::stoi(argv[++i]); break;
      case 'o': output = argv[++i]; break;
      case 'c': config = argv[++i]; break;
      case 'h':
    std::cout &lt;&lt; "Usage: " &lt;&lt; argv[0] &lt;&lt; " [OPTIONS] [SYSTEM]\n\n"
          &lt;&lt; "Options:\n"
          &lt;&lt; "  -h           This help\n"
          &lt;&lt; "  -n NUMBER    Number of events\n"
          &lt;&lt; "  -o FILE      Output file\n"
          &lt;&lt; "  -s SEED      Random number seed\n"
          &lt;&lt; "  -c FILE      Configuratio file\n\n"
          &lt;&lt; "Systems (all at sqrt(s)=5.02TeV):\n"
          &lt;&lt; "  pp, p-Pb, or Pb-Pb\n"
          &lt;&lt; std::endl;
    return 0;
      default:
    std::cerr &lt;&lt; "Unknown option: " &lt;&lt; argv[i] &lt;&lt; std::endl;
    return 1;
      }
    } else
      system = argv[i];
  }

  BasePythia* eg = nullptr;
  if (system == "pp")    eg = new Pythia;
  if (system == "p-Pb")  eg = new pPb;
  if (system == "Pb-Pb") eg = new PbPb;
  if (not eg) {
    std::cerr &lt;&lt; "Unknown system: " &lt;&lt; system &lt;&lt; std::endl;
    return 1;
  }
  eg-&gt;_seed   = seed;
  eg-&gt;_config = config;
  eg-&gt;init();
  bool ret = eg-&gt;loop(nev, output);

  delete eg;

  return ret ? 0 : 1;
}
</pre><p> The above program sets up a relative generic event generator that uses Pythia and writes the results to either file or standard output in the HepMC format. This can be used with the generator <code>hepmc</code> as f.ex. </p><pre class="fragment">o2-sim -g hepmc \
  --configKeyValues="GeneratorFileOrCmd.cmd=./pythia pPb"
</pre> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d0/d0b/refrun.html">Module &#39;run&#39;</a></li><li class="navelem"><a class="el" href="../../d4/dc9/refrunSimExamples.html">Simulation Examples</a></li>
    <li class="footer">Generated on Fri Oct 31 2025 12:28:23 for Project by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.8 </li>
  </ul>
</div>
</body>
</html>
